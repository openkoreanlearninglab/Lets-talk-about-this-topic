<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ïò§Îäò ÏùºÏùÑ Îã§ Î™ªÌñàÏñ¥Ïöî</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://www.youtube.com/iframe_api"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic:wght@400;700;800&family=IBM+Plex+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        /* Í∏∞Î≥∏ Ìè∞Ìä∏ ÏÑ§Ï†ï */
        body { font-family: 'Nanum Gothic', sans-serif; }
        /* Ïñ¥Ìúò Î™©Î°ù ÏÇ¨Ïù¥ÎìúÎ∞î Ìè∞Ìä∏ */
        .vocab-sidebar { font-family: 'IBM Plex Sans KR', sans-serif; }
        /* Ïñ¥Ìúò ÌåùÏóÖ Ïä§ÌÉÄÏùº */
        .vocab-popup { font-family: 'Nanum Gothic', sans-serif; z-index: 50; max-width: 320px; white-space: normal; }
        /* Ìò∏Î≤Ñ Ìà¥ÌåÅ Ïä§ÌÉÄÏùº */
        .hover-tooltip { position: fixed; z-index: 9999; background: white; border: 2px solid #22c55e; border-radius: 8px; padding: 12px; box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); max-width: 320px; font-family: 'Nanum Gothic', sans-serif; animation: fadeIn 0.15s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }
        /* ÏùºÎ∞ò Ïñ¥Ìúò Í∞ïÏ°∞ Ïä§ÌÉÄÏùº */
        .highlight-general { font-weight: 600; color: #374151; cursor: pointer; position: relative; transition: background-color 0.2s; }
        /* ÎßàÏö∞Ïä§ Ìò∏Î≤Ñ ÎòêÎäî ÌôúÏÑ±Ìôî Ïãú Ïä§ÌÉÄÏùº */
        .highlight-general:hover, .active-highlight { background-color: #dcfce7; border-radius: 3px; }
        .script-highlight { background-color: #e0f2fe; border-radius: 8px; }
        .vocab-highlight { background-color: #dcfce7; border: 2px solid #22c55e; border-radius: 8px; }

        /* --- ÎßêÌíçÏÑ† Ïä§ÌÉÄÏùº --- */
        /* Updated tail styles to match new class names */
        .bubble-tail-left.bubble-kkn20::after { /* Yuna Style 1 */
            content: "";
            position: absolute;
            bottom: 6px;
            left: -8px;
            width: 0px;
            height: 0px;
            border-top: 8px solid transparent;
            border-bottom: 8px solid transparent;
            border-right: 8px solid #dcfce7; /* green-100 */
            transition: border-color 0.3s;
        }
        /* Add style for Yuna Style 2 if needed */
        /* .bubble-tail-left.bubble-kkn30::after { ... } */

        .bubble-tail-right.bubble-other::after { /* Woody Style */
            content: "";
            position: absolute;
            bottom: 6px;
            right: -8px;
            width: 0px;
            height: 0px;
            border-top: 8px solid transparent;
            border-bottom: 8px solid transparent;
            border-left: 8px solid white;
            transition: border-color 0.3s;
        }

        /* Active styles targeting new classes */
        .bubble-active.bubble-tail-left.bubble-kkn20::after,
        /* Add active style for Yuna Style 2 if needed */
        /* .bubble-active.bubble-tail-left.bubble-kkn30::after, */
        .bubble-active.bubble-tail-right.bubble-other::after {
            border-right-color: #fef9c3; /* yellow-100 */
            border-left-color: #fef9c3; /* yellow-100 */
        }


        /* --- ÎîîÎ∞îÏù¥Ïä§Î≥Ñ Î†àÏù¥ÏïÑÏõÉ Ïä§ÌÉÄÏùº --- */
        [data-layout-mode="split"] .video-materials-content { display: flex; flex-direction: row; gap: 1.5rem; }
        [data-layout-mode="split"] .video-wrapper { width: 60%; position: sticky; top: 1rem; align-self: flex-start; }
        [data-layout-mode="split"] .script-wrapper { width: 40%; max-height: calc(100vh - 4rem); overflow-y: auto; }
        [data-layout-mode="split"] .vocab-sidebar, [data-layout-mode="mobile"] .vocab-sidebar { display: none; }
        [data-layout-mode="mobile"] .video-materials-content, [data-layout-mode="mobile"] .video-materials-content > div { display: flex; flex-direction: column; }
        
        /* Ïù∏ÏáÑ Ï†ÑÏö© Ïä§ÌÉÄÏùº */
        .print-only { display: none; }
        @media print {
            @page { size: A4; margin: 0.75cm 1cm; }
            .no-print { display: none !important; }
            .print-only { display: inline-block !important; }
            body, html { background: white !important; font-size: 9pt; }
            .mx-auto { max-width: none !important; padding: 0 !important; margin: 0 !important; border: none !important; box-shadow: none !important; }
            body > #root > div { padding: 0 !important; }
            * { box-shadow: none !important; border-color: transparent !important; -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
            p, h1, h2, h3, h4, span, li { color: black !important; }
            p, li { line-height: 1.5; }
            header.text-center { margin-bottom: 1rem !important; }
            .pt-10 { padding-top: 1rem !important; }
            .mb-8 { margin-bottom: 0.4pt !important; }
            h1, h2 { font-size: 12pt !important; margin-bottom: 15px; }
            h3 { font-size: 12pt !important; margin-bottom: 10px; }
        }
    </style>
</head>
<body class="bg-gray-50">
    <div id="root"></div>
    <script type="text/babel">
        /**
         * @typedef {Object} ScriptLine
         * @property {string} id - Unique identifier (e.g., 's1')
         * @property {string} speaker - Speaker name ('Ïú†ÎÇò' | 'Ïö∞Îîî')
         * @property {string} kor - Korean text
         * @property {string} eng - English translation
         * @property {[number, number]} [time] - Optional [start, end] timestamps
         */

        // --- ÏïÑÏù¥ÏΩò Ïª¥Ìè¨ÎÑåÌä∏ ---
        const Icon = React.memo(({ children, className = 'w-6 h-6' }) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>{children}</svg>);
        const Video = ({ className }) => <Icon className={className}><path d="m22 8-6 4 6 4V8Z"></path><rect width="14" height="12" x="2" y="6" rx="2" ry="2"></rect></Icon>;
        const BookOpen = ({ className }) => <Icon className={className}><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path></Icon>;
        const MessageSquare = ({ className }) => <Icon className={className}><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></Icon>;
        const ThumbsUp = ({ className }) => <Icon className={className}><path d="M7 10v12"></path><path d="M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a2 2 0 0 1 3 1.88V5Z"></path></Icon>;
        const List = ({ className }) => <Icon className={className}><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></Icon>;
        const Spinner = ({ className = 'w-5 h-5' }) => (<svg className={`animate-spin ${className}`} xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle><path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>);

        // --- Í≥µÏö© Ïª¥Ìè¨ÎÑåÌä∏: Î≤àÏó≠ Î≤ÑÌäº ---
        const TranslateButton = React.memo(({ textToTranslate }) => {
            const { useState, useEffect, useRef, useCallback } = React;
            const [translation, setTranslation] = useState(null);
            const [isLoading, setIsLoading] = useState(false);
            const [error, setError] = useState(null);
            const [show, setShow] = useState(false);
            const [buttonLang, setButtonLang] = useState('Translation');
            const isMounted = useRef(true);

            useEffect(() => {
                isMounted.current = true;
                setButtonLang('English');
                return () => { isMounted.current = false; };
            }, []);

            const handleTranslate = useCallback(async () => {
                if (show) { setShow(false); return; }
                if (translation) { setShow(true); return; }
                if (!textToTranslate.trim()) return;

                setIsLoading(true);
                setError(null);
                try {
                    const targetLanguage = 'English';
                    const prompt = `Translate the following Korean text to ${targetLanguage}. Provide only the most natural-sounding translation, without any additional explanations or quotation marks.`;
                    const payload = { contents: [{ role: "user", parts: [{ text: prompt }, { text: textToTranslate }] }] };
                    // NOTE: The API key is intentionally left blank.
                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=`, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });
                    if (!response.ok) throw new Error(`API Error: ${response.status}`);
                    const result = await response.json();
                    if (isMounted.current && result.candidates?.[0]?.content.parts[0].text) {
                        setTranslation(result.candidates[0].content.parts[0].text.trim());
                        setShow(true);
                    } else { throw new Error("Invalid API response format."); }
                } catch (err) { if (isMounted.current) setError("Î≤àÏó≠Ïóê Ïã§Ìå®ÌñàÏñ¥Ïöî."); }
                finally { if (isMounted.current) setIsLoading(false); }
            }, [show, translation, textToTranslate]);

            return (<div className="mt-1 no-print"><button onClick={handleTranslate} disabled={isLoading} className="text-xs text-gray-500 hover:text-gray-800 font-semibold py-1 px-2 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors disabled:text-gray-300">{isLoading ? 'Î≤àÏó≠ Ï§ë...' : (show ? 'Î≤àÏó≠ Ïà®Í∏∞Í∏∞' : `Î≤àÏó≠ (${buttonLang})`)}</button>{show && translation && <p className="text-gray-600 text-base mt-2 mb-2 whitespace-pre-wrap">{translation}</p>}{error && <p className="text-red-500 text-sm mt-1">{error}</p>}</div>);
        });

        // --- [ÎèôÏòÅÏÉÅ ÏûêÎ£å] ÌÉ≠ Í¥ÄÎ†® Ïª¥Ìè¨ÎÑåÌä∏ ---
        const HighlightedText = React.memo(({ text, highlightData, onWordHover, onWordLeave, onWordClick, lineId, activeWordId }) => {
            if (!text || !highlightData) return text;
            const { regex, wordMap, sortedWords } = highlightData;
            const parts = text.split(regex);
            return (<>{parts.map((part, index) => {
                if (!part) return null;
                if (index % 2 === 0) return part;
                const trimmedPart = part.trim();
                const baseForm = sortedWords.find(word => {
                    const vocabItem = wordMap.get(word);
                    if (vocabItem.variants && vocabItem.variants.includes(trimmedPart)) return true;
                    const cleanPart = trimmedPart.replace(/\s/g, '');
                    const cleanWord = word.replace(/\s/g, '');
                    if (word.endsWith('Îã§')) return cleanPart.startsWith(cleanWord.slice(0, -1));
                    return cleanPart.startsWith(cleanWord);
                });
                if (!baseForm) return part;
                const info = wordMap.get(baseForm);
                if (!info) return part;
                const uniqueWordId = `${lineId}-${index}-${baseForm}`;
                const classes = ['highlight-general', 'font-bold', activeWordId === uniqueWordId ? 'active-highlight' : ''].join(' ');
                return <span
                    key={index}
                    className={classes}
                    onMouseEnter={(e) => onWordHover(e, baseForm, lineId, index)}
                    onMouseLeave={onWordLeave}
                    onClick={(e) => onWordClick && onWordClick(e, baseForm)}
                >{part}</span>;
            })}</>);
        });

        const HoverTooltip = React.memo(({ data, position }) => {
            if (!data || !position) return null;
            return (
                <div
                    className="hover-tooltip"
                    style={{ left: `${position.x}px`, top: `${position.y}px` }}
                    onClick={(e) => e.stopPropagation()} 
                >
                    <p className="font-bold text-lg text-green-700 mb-2">{data.term}</p>
                    <p className="text-gray-700 text-base">{data.mainDef}</p>
                    {data.subDefs && data.subDefs.length > 0 && (
                        <div className="mt-3 pt-3 border-t border-gray-200">
                            <ul className="space-y-1">
                                {data.subDefs.map((sub, i) => (
                                    <li key={i} className="text-sm">
                                        <span className="font-semibold text-gray-600">{sub.subTerm}:</span>{' '}
                                        <span className="text-gray-600">{sub.subDef}</span>
                                    </li>
                                ))}
                            </ul>
                        </div>
                    )}
                </div>
            );
        });

        const VocabItem = React.memo(React.forwardRef(({ item, isHighlighted }, ref) => {
            const { useState } = React;
            const [showExamples, setShowExamples] = useState(false);

            return (
                <div ref={ref} className={`p-4 rounded-lg border-b ${isHighlighted ? 'vocab-highlight' : 'bg-white'}`}>
                    <p className="font-bold text-lg text-green-700">{item.term}</p>
                    <div className="pl-4 mt-2 border-l-2">
                        <p className="text-gray-700">{item.mainDef}</p>
                        {item.subDefs && item.subDefs.length > 0 && (
                            <div className="mt-3 pt-3 border-t">{item.subDefs.map((sub, index) => (
                                <div key={index} className="text-sm mt-2">
                                    <p className="font-semibold">{sub.subTerm}</p>
                                    <p className="text-gray-600 pl-2">{sub.subDef}</p>
                                </div>
                            ))}</div>
                        )}
                    </div>
                    {item.examples && item.examples.length > 0 && (
                        <div className="mt-3 no-print">
                            <button onClick={() => setShowExamples(!showExamples)} className="text-xs bg-green-200 hover:bg-green-300 text-gray-600 py-1 px-2 rounded-md">
                                {showExamples ? 'Close Examples' : 'Sentence Examples'}
                            </button>
                            {showExamples && (
                                <div className="mt-3 p-3 bg-green-50 rounded-lg space-y-3 text-sm">
                                    {item.examples.map((ex, index) => (
                                        <div key={index}>
                                            <p className="font-medium text-gray-800">{ex.kor}</p>
                                            <p className="text-gray-400 hover:text-gray-700 transition-colors">{ex.eng}</p>
                                        </div>
                                    ))}
                                </div>
                            )}
                        </div>
                    )}
                </div>
            );
        }));

        const VideoMaterialsTab = ({scriptContent, vocabAndGrammarList, highlightData, vocabMap}) => {
            const { useState, useRef, useEffect, useCallback, useMemo } = React;
            const [activeWordId, setActiveWordId] = useState(null);
            const [player, setPlayer] = useState(null);
            const [activeScriptLine, setActiveScriptLine] = useState(null);
            const [isSyncEnabled, setIsSyncEnabled] = useState(true);
            const [hoverPopupData, setHoverPopupData] = useState(null);
            const [pinnedPopupData, setPinnedPopupData] = useState(null);
            const [highlightedVocab, setHighlightedVocab] = useState(null);
            const [translationsVisible, setTranslationsVisible] = useState({});
            const [playerHeight, setPlayerHeight] = useState(0);
            const [isVocabSidebarVisible, setIsVocabSidebarVisible] = useState(true);
            const [isPortrait, setIsPortrait] = useState(window.matchMedia("(orientation: portrait)").matches);

            const scriptLineRefs = useRef({});
            const vocabRefs = useRef({});
            const intervalRef = useRef();
            const playerContainerRef = useRef(null);
            const hoverTimeoutRef = useRef(null);

            const activeScriptLineRef = useRef(activeScriptLine);
            activeScriptLineRef.current = activeScriptLine;

            const timeIndex = useMemo(() => {
                return scriptContent
                    .filter(line => line.time)
                    .map(line => ({ start: line.time[0], end: line.time[1], id: line.id }))
                    .sort((a, b) => a.start - b.start);
            }, [scriptContent]);

            const onPlayerReady = useCallback((event) => setPlayer(event.target), []);

            const setupPlayer = useCallback(() => {
                if (window.YT && window.YT.Player) {
                    const newPlayer = new window.YT.Player('youtube-player', {
                        height: '100%',
                        width: '100%',
                        videoId: 'jbfUEVOCSds',
                        events: { 'onReady': onPlayerReady }
                    });
                    setPlayer(newPlayer);
                }
            }, [onPlayerReady]);

            useEffect(() => {
                const mediaQuery = window.matchMedia("(orientation: portrait)");
                const handleOrientationChange = (e) => setIsPortrait(e.matches);
                mediaQuery.addEventListener('change', handleOrientationChange);
                return () => mediaQuery.removeEventListener('change', handleOrientationChange);
            }, []);

            useEffect(() => {
                if (window.YT && document.getElementById('youtube-player')) {
                    if (!player) setupPlayer();
                } else if (!window.YT) {
                    window.onYouTubeIframeAPIReady = setupPlayer;
                }
                return () => { 
                    if (intervalRef.current) clearInterval(intervalRef.current); 
                    if (window.playClipTimer) clearTimeout(window.playClipTimer);
                };
            }, [setupPlayer, player]);

            useEffect(() => {
                let ro;
                if (playerContainerRef.current) {
                    const updateHeight = () => { if (playerContainerRef.current) setPlayerHeight(playerContainerRef.current.offsetHeight); };
                    ro = new ResizeObserver(updateHeight);
                    ro.observe(playerContainerRef.current);
                    updateHeight();
                }
                return () => ro?.disconnect();
            }, []);

            useEffect(() => {
                if (player && isSyncEnabled) {
                    intervalRef.current = setInterval(() => {
                        if (player.getCurrentTime) {
                            const currentTime = player.getCurrentTime();
                            const currentLine = timeIndex.find(line => currentTime >= line.start && currentTime < line.end);
                            const currentLineId = currentLine ? currentLine.id : null;
                            if (activeScriptLineRef.current !== currentLineId) {
                                setActiveScriptLine(currentLineId);
                            }
                        }
                    }, 250);
                } else {
                    clearInterval(intervalRef.current);
                }
                return () => clearInterval(intervalRef.current);
            }, [player, isSyncEnabled, timeIndex]);

            useEffect(() => {
                if (activeScriptLine && isSyncEnabled) {
                    const lineElement = scriptLineRefs.current[activeScriptLine];
                    if (lineElement && playerContainerRef.current) {
                        const playerBottom = playerContainerRef.current.getBoundingClientRect().bottom;
                        const gap = 19;
                        const targetTop = playerBottom + gap;
                        const elementTop = lineElement.getBoundingClientRect().top;
                        const scrollByAmount = elementTop - targetTop;
                        if (Math.abs(scrollByAmount) > 5) {
                            window.scrollBy({ top: scrollByAmount, behavior: 'smooth' });
                        }
                    }
                }
            }, [activeScriptLine, isSyncEnabled]);

            useEffect(() => {
                const handleClickAway = () => {
                    if (pinnedPopupData) {
                        setPinnedPopupData(null);
                        setHighlightedVocab(null);
                    }
                };
                window.addEventListener('click', handleClickAway);
                return () => {
                    window.removeEventListener('click', handleClickAway);
                };
            }, [pinnedPopupData]);

            const handlePlayClip = useCallback((line) => {
                if (player && player.seekTo && line.time) {
                    const [start, end] = line.time;
                    const duration = (end - start) * 1000;
                    
                    player.seekTo(start);
                    if (player.playVideo) player.playVideo();
                    
                    if (window.playClipTimer) {
                        clearTimeout(window.playClipTimer);
                    }
                    
                    window.playClipTimer = setTimeout(() => {
                        if (player.pauseVideo) player.pauseVideo();
                    }, duration > 0 ? duration : 1000);
                }
            }, [player]);

            const handleWordHover = useCallback((e, baseForm) => {
                e.stopPropagation();
                if (pinnedPopupData) return;

                if (hoverTimeoutRef.current) clearTimeout(hoverTimeoutRef.current);

                const wordData = vocabMap.get(baseForm);
                if (wordData) {
                    const rect = e.target.getBoundingClientRect();
                    let x = rect.left;
                    let y = rect.bottom + 5;
                    const tooltipWidth = 320;
                    if (x + tooltipWidth > window.innerWidth) {
                        x = rect.right - tooltipWidth;
                        if (x < 0) x = 10;
                    }
                    const tooltipHeight = 200;
                    if (y + tooltipHeight > window.innerHeight + window.scrollY) {
                        y = rect.top - tooltipHeight - 5;
                    }
                    setHoverPopupData({ data: wordData, position: { x, y } });
                }
            }, [vocabMap, pinnedPopupData]);

            const handleWordLeave = useCallback(() => {
                hoverTimeoutRef.current = setTimeout(() => {
                    setHoverPopupData(null);
                }, 200);
            }, []);

            const handleWordClick = useCallback((e, baseForm) => {
                e.stopPropagation();
                if (hoverTimeoutRef.current) clearTimeout(hoverTimeoutRef.current);
                setHoverPopupData(null);

                const wordData = vocabMap.get(baseForm);
                if (wordData) {
                    const rect = e.target.getBoundingClientRect();
                    let x = rect.left;
                    let y = rect.bottom + 5;
                    const tooltipWidth = 320;
                    if (x + tooltipWidth > window.innerWidth) {
                        x = rect.right - tooltipWidth;
                        if (x < 0) x = 10;
                    }
                    const tooltipHeight = 200;
                    if (y + tooltipHeight > window.innerHeight + window.scrollY) {
                        y = rect.top - tooltipHeight - 5;
                    }

                    if (pinnedPopupData && pinnedPopupData.data.term === wordData.term) {
                        setPinnedPopupData(null);
                        setHighlightedVocab(null);
                    } else {
                        setPinnedPopupData({ data: wordData, position: { x, y } });
                        setHighlightedVocab(wordData.term);

                        const vocabElement = vocabRefs.current[wordData.term];
                        if (vocabElement) {
                            vocabElement.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                        }
                    }
                }
            }, [vocabMap, pinnedPopupData]);

            const toggleTranslation = (lineId) => {
                setTranslationsVisible(prev => ({ ...prev, [lineId]: !prev[lineId] }));
            };

            const activePopupData = pinnedPopupData || hoverPopupData;

            return (
                <div className="video-materials-content">
                    {activePopupData && <HoverTooltip data={activePopupData.data} position={activePopupData.position} />}
                    <div ref={playerContainerRef} className="video-wrapper sticky top-0 z-40 bg-gray-50 py-4 no-print">
                        <div className={`w-full rounded-xl shadow-lg border-4 border-white overflow-hidden transition-all duration-300 ease-in-out aspect-video`}>
                            <div id="youtube-player" className="w-full h-full"></div>
                        </div>
                    </div>
                    <div className="script-wrapper flex flex-col md:flex-row gap-6">
                        <main className="flex-grow">
                            <div className="space-y-6">
                                {scriptContent.map(line => {
                                    const hasTranslation = !!line.eng;
                                    const isActive = activeScriptLine === line.id;

                                    if (line.kor.startsWith('‚Ä¢')) {
                                        return (
                                            <div key={line.id} ref={el => scriptLineRefs.current[line.id] = el}
                                                className={`p-3 my-2 rounded-lg transition-colors duration-300 ${isActive ? 'bg-yellow-100' : ''}`}>
                                                <p className="whitespace-pre-wrap text-lg text-gray-800">
                                                    <HighlightedText text={line.kor} highlightData={highlightData} onWordHover={handleWordHover} onWordLeave={handleWordLeave} onWordClick={handleWordClick} lineId={line.id} activeWordId={activeWordId} />
                                                </p>
                                                {translationsVisible[line.id] && hasTranslation && (
                                                    <p className="text-gray-600 text-base mt-2">{line.eng}</p>
                                                )}
                                                <div className="flex items-center gap-2 mt-2 no-print">
                                                    {hasTranslation && (
                                                        <button onClick={() => toggleTranslation(line.id)} className="text-xs text-gray-600 bg-gray-100 hover:bg-gray-200 px-2 py-1 rounded-md transition">
                                                            {translationsVisible[line.id] ? 'Hide translation' : 'Translation'}
                                                        </button>
                                                    )}
                                                </div>
                                            </div>
                                        );
                                    }

                                    const isYuna = line.speaker === 'Ïú†ÎÇò';
                                    const bubbleWrapperClasses = `flex flex-col max-w-[100%] sm:max-w-[100%] ${isYuna ? 'items-start' : 'items-end self-end'}`;
                                    const bubbleBaseClasses = 'relative px-5 py-3 rounded-2xl shadow-md transition-colors duration-300';
                                    const yunaBubbleColor = 'bg-green-100';
                                    const woodyBubbleColor = 'bg-white';
                                    const activeBubbleColor = 'bg-yellow-100';
                                    const tailClass = isYuna ? 'bubble-tail-left bubble-kkn20' : 'bubble-tail-right bubble-other';
                                    const bubbleClasses = `${bubbleBaseClasses} ${isActive ? activeBubbleColor : (isYuna ? yunaBubbleColor : woodyBubbleColor)} ${tailClass} ${isActive ? 'bubble-active' : ''}`;
                                    const speakerNameClasses = `font-bold mb-1 ${isYuna ? 'text-green-800' : 'text-blue-800'}`;

                                    return (
                                        <div key={line.id} ref={el => scriptLineRefs.current[line.id] = el} className="flex flex-col w-full">
                                            <div className={bubbleWrapperClasses}>
                                                <p className={`${speakerNameClasses} ${isYuna ? 'self-start' : 'self-end'}`}>{line.speaker}</p>
                                                <div className={bubbleClasses}>
                                                    <p className="whitespace-pre-wrap text-lg text-gray-800">
                                                        <HighlightedText text={line.kor} highlightData={highlightData} onWordHover={handleWordHover} onWordLeave={handleWordLeave} onWordClick={handleWordClick} lineId={line.id} activeWordId={activeWordId} />
                                                    </p>
                                                </div>
                                                <div className={`w-full flex flex-col ${isYuna ? 'items-start' : 'items-end'}`}>
                                                    {translationsVisible[line.id] && hasTranslation && (
                                                        <p className="text-gray-500 text-base mt-2 px-2">{line.eng}</p>
                                                    )}
                                                    <div className="flex items-center gap-2 mt-2 px-2 no-print">
                                                        {line.time && (
                                                            <button onClick={() => handlePlayClip(line)} className="text-xs px-2 py-1 rounded-md transition text-gray-600 bg-gray-100 hover:bg-gray-200">
                                                                Play Clip
                                                            </button>
                                                        )}
                                                        {hasTranslation && (
                                                            <button onClick={() => toggleTranslation(line.id)} className="text-xs text-gray-600 bg-gray-100 hover:bg-gray-200 px-2 py-1 rounded-md transition">
                                                                {translationsVisible[line.id] ? 'Hide translation' : 'Translation'}
                                                            </button>
                                                        )}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    );
                                })}
                            </div>
                        </main>
                        <aside className="vocab-sidebar w-full md:w-auto flex-shrink-0 no-print">
                            <div className="sticky z-30" style={{ top: `${playerHeight + 32}px` }}>
                                <div className="flex flex-row items-stretch gap-2 mb-2" style={{ maxWidth: '7cm' }}>
                                    <label htmlFor="sync-toggle" className="flex-1 flex items-center justify-between cursor-pointer bg-white py-1.5 px-3 rounded-lg shadow-md border">
                                        <span className="text-xs font-medium text-gray-900 whitespace-nowrap">Auto-scroll</span>
                                        <div className="relative">
                                            <input type="checkbox" id="sync-toggle" className="sr-only" checked={isSyncEnabled} onChange={() => setIsSyncEnabled(!isSyncEnabled)} />
                                            <div className={`block w-10 rounded-full transition-colors ${isSyncEnabled ? 'bg-green-500' : 'bg-gray-200'}`} style={{ height: '0.35cm' }}></div>
                                            <div className={`dot absolute left-1 top-[2.6px] bg-white w-2 h-2 rounded-full transition-transform ${isSyncEnabled ? 'transform translate-x-6' : ''}`}></div>
                                        </div>
                                    </label>
                                    <label htmlFor="vocab-toggle" className="flex-1 flex items-center justify-between cursor-pointer bg-white py-1.5 px-3 rounded-lg shadow-md border">
                                        <span className="text-xs font-medium text-gray-900 whitespace-nowrap">Vocabulary</span>
                                        <div className="relative">
                                            <input type="checkbox" id="vocab-toggle" className="sr-only" checked={isVocabSidebarVisible} onChange={() => setIsVocabSidebarVisible(!isVocabSidebarVisible)} />
                                            <div className={`block w-10 rounded-full transition-colors ${isVocabSidebarVisible ? 'bg-green-500' : 'bg-gray-200'}`} style={{ height: '0.35cm' }}></div>
                                            <div className={`dot absolute left-1 top-[2.6px] bg-white w-2 h-2 rounded-full transition-transform ${isVocabSidebarVisible ? 'transform translate-x-6' : ''}`}></div>
                                        </div>
                                    </label>
                                </div>
                                {isVocabSidebarVisible && (
                                    <div className="w-full overflow-y-auto" style={{maxWidth: '7cm', maxHeight: `calc(100vh - ${playerHeight + 96}px)`}}>
                                        <div className="border rounded-lg bg-white p-2 shadow-lg">
                                            <div className="space-y-1">
                                            {vocabAndGrammarList.map(item => (
                                                <VocabItem
                                                    key={item.term}
                                                    item={item}
                                                    ref={el => vocabRefs.current[item.term] = el}
                                                    isHighlighted={highlightedVocab === item.term}
                                                />
                                            ))}
                                            </div>
                                        </div>
                                    </div>
                                )}
                            </div>
                        </aside>
                    </div>
                </div>
            )
        }

        // --- [ÌÄ¥Ï¶à&ÌÜ†Î°†] ÌÉ≠ Í¥ÄÎ†® Ïª¥Ìè¨ÎÑåÌä∏ ---
        const ComprehensionQuiz = ({ sentences }) => {
            const { useState, useMemo } = React;
            const [selectedWords, setSelectedWords] = useState({});
            const [results, setResults] = useState({});
            const [translationsVisible, setTranslationsVisible] = useState({});
            const [hintsVisible, setHintsVisible] = useState({});

            const shuffledSentences = useMemo(() => {
                const shuffleArray = (array) => {
                    const newArray = [...array];
                    for (let i = newArray.length - 1; i > 0; i--) {
                        const j = Math.floor(Math.random() * (i + 1));
                        [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
                    }
                    return newArray;
                };
                return sentences.map(sentence => ({ ...sentence, bank: shuffleArray(sentence.bank) }));
            }, [sentences]);

            const handleWordSelect = (id, word) => {
                setSelectedWords(prev => ({...prev, [id]: word}));
                const isCorrect = sentences.find(s => s.id === id).answer === word;
                setResults(prev => ({...prev, [id]: isCorrect}));
                setHintsVisible(prev => ({ ...prev, [id]: false }));
            };
            const handleToggleTranslation = (id) => { setTranslationsVisible(prev => ({...prev, [id]: !prev[id]})); };
            const handleToggleHint = (id) => { if (results[id] !== true) setHintsVisible(prev => ({...prev, [id]: !prev[id]})); };

            return (
                <div className="space-y-8">
                    {shuffledSentences.map((s, index) => (
                        <div key={s.id} className="p-6 border rounded-xl bg-white shadow-lg transition-all duration-300">
                            <p className="text-gray-700 font-bold text-lg mb-4">{index + 1}. Îã§Ïùå ÎπàÏπ∏Ïóê ÏïåÎßûÏùÄ ÎßêÏùÑ Í≥†Î•¥ÏÑ∏Ïöî. (Choose the correct word for the blank.)</p>
                            <div className="p-4 bg-gray-100 rounded-lg text-left mb-3 text-gray-900 text-xl font-bold">
                                {s.parts[0]}
                                <span className="inline-block bg-yellow-200 text-green-800 px-3 py-1 rounded-md font-extrabold mx-2">
                                    {hintsVisible[s.id] ? `[ ${s.eng_hint} ]` : (selectedWords[s.id] || '___')}
                                </span>
                                {s.parts[1]}
                                {results[s.id] === true && <span className="inline-block ml-2 text-green-500">‚úì</span>}
                                {results[s.id] === false && <span className="inline-block ml-2 text-red-500">‚úó</span>}
                            </div>
                            {translationsVisible[s.id] && (
                                <div className="text-gray-600 italic p-3 bg-gray-50 rounded-lg text-left mt-2 text-base">
                                    {results[s.id] ? (<span>{s.eng_parts[0]}<strong className="text-green-600">{s.eng_answer}</strong>{s.eng_parts[1]}</span>)
                                    : (<span>{s.eng_parts[0]}<span className="font-bold">___</span>{s.eng_parts[1]}</span>)}
                                </div>
                            )}
                            <div className="text-left mb-4 flex gap-2">
                                <button onClick={() => handleToggleHint(s.id)} className="text-xs bg-yellow-200 hover:bg-yellow-300 text-yellow-800 font-bold py-1 px-3 rounded-full transition duration-200 disabled:opacity-50 disabled:cursor-not-allowed" disabled={results[s.id] === true}>ÌûåÌä∏ (Hint)</button>
                                <button onClick={() => handleToggleTranslation(s.id)} className="text-xs bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-1 px-3 rounded-full transition duration-200">Î≤àÏó≠ (Translation)</button>
                            </div>
                            <div className="flex justify-start flex-wrap gap-3">
                                {s.bank.map(word => (
                                    <button
                                        key={word}
                                        onClick={() => handleWordSelect(s.id, word)}
                                        className={`px-4 py-2 rounded-lg text-lg font-bold transition-all transform hover:scale-105 shadow-md ${selectedWords[s.id] === word ? (results[s.id] ? 'bg-green-500 text-white ring-2 ring-opacity-50 ring-green-400' : 'bg-red-500 text-white ring-2 ring-red-300') : 'bg-white text-gray-800 hover:bg-gray-100 border'}`}
                                    >{word}</button>
                                ))}
                            </div>
                            {results[s.id] !== undefined && (
                                <div className={`mt-4 p-4 border-l-4 rounded-r-lg ${results[s.id] ? 'bg-green-50 border-green-400' : 'bg-red-50 border-red-400'}`}>
                                    <p className={`font-bold ${results[s.id] ? 'text-green-800' : 'text-red-800'} flex items-center gap-2 text-lg`}>{results[s.id] ? 'Correct!' : 'Try again.'}</p>
                                    <p className="mt-2 text-gray-700 text-base italic">{results[s.id] ? s.eng_explanation : s.eng_wrongAnswerExplanations[selectedWords[s.id]]}</p>
                                </div>
                            )}
                        </div>
                    ))}
                </div>
            );
        };

        const SentenceChecker = ({ value, onChange, placeholder, question }) => {
            const { useState } = React;
            const [feedback, setFeedback] = useState(null);
            const [isLoading, setIsLoading] = useState(false);
            const [error, setError] = useState(null);

            const checkSentence = async () => {
                if (!value || value.trim() === '') {
                    setError("Î¨∏Ïû•ÏùÑ ÏûÖÎ†•Ìï¥Ïïº ÌîºÎìúÎ∞±ÏùÑ Î∞õÏùÑ Ïàò ÏûàÏñ¥Ïöî.");
                    setFeedback(null); return;
                }
                setIsLoading(true); setError(null); setFeedback(null);
                const prompt = `You are an advanced Korean language tutor AI for B1-C2 level learners. Analyze the user's sentence in response to a specific question. The user's answer is in Korean. Your entire response MUST be a JSON object, with all string values in Korean (ending in -Ïöî) and English.\n\nQuestion: "${question}"\nUser's Answer: "${value}"\n\nYour response MUST be a JSON object with the specified schema.`;
                const payload = {
                    contents: [{ role: "user", parts: [{ text: prompt }] }],
                    generationConfig: {
                        responseMimeType: "application/json",
                        responseSchema: { type: "OBJECT", properties: { "is_relevant": { "type": "BOOLEAN" }, "relevance_feedback_kor": { "type": "STRING", "nullable": true }, "relevance_feedback_eng": { "type": "STRING", "nullable": true }, "is_correct": { "type": "BOOLEAN", "nullable": true }, "feedback_message_kor": { "type": "STRING", "nullable": true }, "feedback_message_eng": { "type": "STRING", "nullable": true }, "corrected_sentence": { "type": "STRING", "nullable": true }, "explanation_kor": { "type": "STRING", "nullable": true }, "explanation_eng": { "type": "STRING", "nullable": true }, "alternative_expressions": { "type": "ARRAY", "items": { "type": "OBJECT", "properties": { "expression_kor": { "type": "STRING" }, "expression_eng": { "type": "STRING" } }, "required": ["expression_kor", "expression_eng"] } } }, "required": ["is_relevant"] }
                    }
                };
                const apiKey = "";
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
                try {
                    const response = await fetch(apiUrl, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });
                    if (!response.ok) throw new Error(`API error: ${response.statusText}`);
                    const result = await response.json();

                    if (result.candidates && result.candidates.length > 0 &&
                        result.candidates[0].content && result.candidates[0].content.parts &&
                        result.candidates[0].content.parts.length > 0 && result.candidates[0].content.parts[0].text) {
                        try {
                            const parsedJson = JSON.parse(result.candidates[0].content.parts[0].text);
                            setFeedback(parsedJson);
                        } catch (parseError) {
                            console.error("Error parsing JSON response:", parseError, result.candidates[0].content.parts[0].text);
                            setError("AIÏùò ÏùëÎãµ ÌòïÏãùÏù¥ Ïò¨Î∞îÎ•¥ÏßÄ ÏïäÏïÑ Ï≤òÎ¶¨Ìï† Ïàò ÏóÜÏñ¥Ïöî.");
                        }
                    } else {
                        console.error("Invalid API response structure:", result);
                        setError("AIÏùò ÏùëÎãµÏùÑ Ï≤òÎ¶¨ÌïòÎäî Îç∞ Î¨∏Ï†úÍ∞Ä Î∞úÏÉùÌñàÏñ¥Ïöî.");
                    }
                } catch (err) {
                    console.error("Error checking sentence:", err);
                    setError("Î¨∏Ïû• Í≤ÄÏÇ¨Ïóê Ïã§Ìå®ÌñàÏñ¥Ïöî. ÎÑ§Ìä∏ÏõåÌÅ¨ Ïó∞Í≤∞ÏùÑ ÌôïÏù∏ÌïòÍ±∞ÎÇò Ïû†Ïãú ÌõÑ Îã§Ïãú ÏãúÎèÑÌï¥ Ï£ºÏÑ∏Ïöî.");
                }
                finally { setIsLoading(false); }
            };


            const renderFeedbackSection = (title, content) => (content && content.length > 0 && (
                <div>
                    <p className="text-gray-800 font-bold text-[17px]">{title}</p>
                    {Array.isArray(content) ? (
                        <ul className="list-disc list-inside space-y-2 mt-1">
                            {content.map((item, index) => (
                                <li key={index} className="text-gray-600 text-[16px]">
                                    <p className="font-medium">{item.expression_kor || item.sentence_kor}</p>
                                    <p className="text-gray-500 italic text-sm">{item.expression_eng || item.sentence_eng}</p>
                                </li>
                            ))}
                        </ul>
                    ) : (<p className="text-gray-700 font-medium text-[18px]">{content}</p>)}
                </div>
            ));

            return (
                <div>
                    <textarea className="w-full p-3 border rounded-md focus:ring-2 focus:ring-green-400 transition text-lg" rows="3" placeholder={placeholder} value={value} onChange={onChange} />
                    <button onClick={checkSentence} disabled={isLoading} className="mt-3 flex items-center justify-center gap-2 bg-green-200 text-gray-900 py-2 px-4 rounded-md transition-colors hover:bg-green-300 disabled:opacity-50 disabled:cursor-wait font-semibold text-[14px]">
                        {isLoading ? <Spinner className="w-5 h-5" /> : '‚ú®'} {isLoading ? 'ÌîºÎìúÎ∞± ÏÉùÏÑ± Ï§ë...' : 'AIÏóêÍ≤å ÌîºÎìúÎ∞± Î∞õÍ∏∞'}
                    </button>
                    {error && <p className="mt-2 text-sm text-red-600">{error}</p>}
                    {feedback && (
                        <div className="mt-4 p-4 bg-green-50 border-l-4 border-green-100 rounded-r-lg space-y-4">
                            {!feedback.is_relevant && ( <div><p className="font-bold text-red-800 flex items-center gap-2 text-lg">{feedback.relevance_feedback_kor}</p><p className="text-gray-600 italic">{feedback.relevance_feedback_eng}</p></div> )}
                            {feedback.is_relevant && feedback.is_correct && ( <div><p className="font-bold text-green-800 flex items-center gap-2 text-lg"><ThumbsUp className="w-5 h-5"/> {feedback.feedback_message_kor}</p><p className="text-gray-600 italic">{feedback.feedback_message_eng}</p></div> )}
                            {feedback.is_relevant && !feedback.is_correct && (<>
                                {feedback.corrected_sentence && ( <div><p className="text-gray-800 font-bold text-[17px]">‚ú® ÏàòÏ†ïÎêú Î¨∏Ïû•:</p><p className="text-gray-700 font-medium text-[18px]">{feedback.corrected_sentence}</p></div> )}
                                {(feedback.explanation_kor || feedback.explanation_eng) && ( <div><p className="text-gray-800 font-bold text-[17px]">ÏÑ§Î™Ö:</p>{feedback.explanation_kor && <p className="text-gray-600 text-[16px]">{feedback.explanation_kor}</p>}{feedback.explanation_eng && <p className="text-gray-500 italic mt-1 text-[15px]">{feedback.explanation_eng}</p>}</div> )}
                            </>)}
                            {feedback.alternative_expressions && feedback.alternative_expressions.length > 0 && renderFeedbackSection('üí° Îã§Î•∏ ÌëúÌòÑ:', feedback.alternative_expressions)}
                        </div>
                    )}
                </div>
            );
        };

        const DiscussionSection = ({ questions }) => {
            const { useState } = React;
            const [translationsVisible, setTranslationsVisible] = useState({});
            const [userQuestionAnswers, setUserQuestionAnswers] = useState({});
            const toggleTranslation = (id) => { setTranslationsVisible(prev => ({ ...prev, [id]: !prev[id] })); };

            return (
                <div className="space-y-10">
                    {questions.map((q) => (
                        <div key={q.num} className="p-6 border rounded-xl bg-white shadow-lg">
                            <p className="text-gray-900 text-xl font-bold">{q.num}. {q.kor}</p>
                            {translationsVisible[`q-${q.num}`] && (<p className="whitespace-pre-wrap text-gray-600 italic mt-1 text-base">{q.eng}</p>)}
                            <button onClick={() => toggleTranslation(`q-${q.num}`)} className="text-xs text-gray-800 bg-gray-200 hover:bg-gray-300 font-bold py-1 px-3 rounded-full transition duration-200 mt-2 mb-6">Î≤àÏó≠ (Translation)</button>
                            {q.vocab && q.vocab.length > 0 && (
                                <div className="mt-4 space-y-4">
                                    <h3 className="font-bold text-lg text-gray-800">üìçÌïµÏã¨ ÌëúÌòÑ (Essential phrases)</h3>
                                    {q.vocab.map((v, i) => (
                                        <div key={i} className="pl-4 border-l-2 border-gray-200 py-2">
                                            <p className="font-semibold text-green-700 text-lg">{v.term}: <span className="font-medium text-gray-700 text-base">{v.meaning_eng}</span></p>
                                            
                                            {/* "ÎåÄÌôî ÏÜçÏóêÏÑú ÏÇ¥Ìé¥Î≥¥Í∏∞" ÏÑπÏÖò Ï†úÍ±∞Îê®
                                            <div className="mt-2">
                                                <h4 className="flex items-center gap-2 text-sm font-bold text-gray-600"><span>üí¨</span> ÎåÄÌôî ÏÜçÏóêÏÑú ÏÇ¥Ìé¥Î≥¥Í∏∞ (See it in Context)</h4>
                                                <div className="mt-1 p-3 bg-gray-100 rounded-lg">
                                                    <p className="text-gray-800">"{v.context}"</p>
                                                    {translationsVisible[`q-${q.num}-context-${i}`] && (<p className="text-gray-600 italic text-sm mt-1">{v.context_eng}</p>)}
                                                    <button onClick={() => toggleTranslation(`q-${q.num}-context-${i}`)} className="text-xs bg-gray-200 hover:bg-gray-300 text-gray-700 font-bold py-1 px-2 rounded-full transition duration-200 mt-2">Î≤àÏó≠ (Translation)</button>
                                                </div>
                                            </div>
                                            */}
                                        </div>
                                    ))}
                                </div>
                            )}
                            <div className="mt-6">
                                <h3 className="font-bold text-lg text-gray-800 mb-2">ÌïµÏã¨ ÌëúÌòÑÏùÑ ÏÇ¨Ïö©Ìï¥ÏÑú ÏßàÎ¨∏Ïóê ÎåÄÎãµÌï¥ Î≥¥ÏÑ∏Ïöî.</h3>
                                <SentenceChecker
                                    value={userQuestionAnswers[`q-${q.num}`] || ''}
                                    onChange={(e) => setUserQuestionAnswers(prev => ({...prev, [`q-${q.num}`]: e.target.value}))}
                                    placeholder="Ïó¨Í∏∞Ïóê ÎãµÎ≥ÄÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî (Type your response here)"
                                    question={q.kor}
                                />
                            </div>
                        </div>
                    ))}
                </div>
            );
        };

        const Tabs = ({ tabs }) => {
            const { useState } = React;
            const [activeTab, setActiveTab] = useState(0);
            return (
                <div>
                    <div className="border-b border-gray-200 no-print">
                        <nav className="
                            -mb-px flex items-center 
                            flex-wrap sm:flex-nowrap 
                            gap-x-2 sm:gap-x-3 md:gap-x-4 lg:gap-x-6
                        " aria-label="Tabs">
                            {tabs.map((tab, index) => (
                                <button
                                    key={tab.name_kor} onClick={() => setActiveTab(index)}
                                    className={`${ 
                                        index === activeTab 
                                            ? 'border-green-500 text-green-600' 
                                            : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'
                                    } 
                                    py-4 px-1 border-b-2 font-medium transition-colors 
                                    flex items-center 
                                    gap-1 md:gap-2 
                                    text-sm md:text-base
                                    mb-2 sm:mb-0
                                    `}
                                >
                                    {React.cloneElement(tab.icon, { className: 'w-5 h-5 md:w-6 md:h-6 flex-shrink-0' })}
                                    
                                    <span className="
                                        flex items-baseline gap-x-1.5 
                                        flex-wrap 
                                    ">
                                        <span className="kor-text whitespace-nowrap">{tab.name_kor}</span>
                                        <span className="eng-text text-gray-400 whitespace-nowrap text-xs md:text-sm">{tab.name_eng}</span>
                                    </span>
                                </button>
                            ))}
                        </nav>
                    </div>
                    <div className="pt-10">{tabs[activeTab].content}</div>
                </div>
            );
        };

        // --- Î©îÏù∏ App Ïª¥Ìè¨ÎÑåÌä∏ ---
        const App = () => {
            const { useState, useEffect, useMemo } = React;
            const [containerWidth, setContainerWidth] = useState('30cm');
            const [layoutMode, setLayoutMode] = useState('large');

            useEffect(() => {
                const handleResize = () => {
                    const heightInPx = window.innerHeight; const widthInPx = window.innerWidth;
                    const isMobileDevice = /Mobi|Android/i.test(navigator.userAgent);
                    const isTabletDevice = /iPad|Android(?!.*Mobi)/i.test(navigator.userAgent);
                    const isPortrait = window.matchMedia("(orientation: portrait)").matches;
                    let newMode = 'large'; let newContainerWidth = '30cm';

                    if ((isMobileDevice || isTabletDevice) && isPortrait) { newMode = 'mobile'; newContainerWidth = '100%'; }
                    else {
                        if (heightInPx < 832) { newMode = 'split'; newContainerWidth = '100%'; }
                        else if (heightInPx < 907) { newMode = 'small'; newContainerWidth = '22cm'; }
                        else if (heightInPx < 983) { newMode = 'medium'; newContainerWidth = '24cm'; }
                        else { newMode = 'large'; newContainerWidth = '30cm'; }
                    }
                    setContainerWidth(newContainerWidth); setLayoutMode(newMode); document.body.dataset.layoutMode = newMode;
                    
                    const baseWidthPx = 35 * 37.795; let effectiveWidthPx;
                    
                    if (newContainerWidth === '100%') { effectiveWidthPx = widthInPx; }
                    else { const cmValue = parseFloat(newContainerWidth); effectiveWidthPx = cmValue * 37.795; }
                    if (newMode !== 'large') { const scale = Math.min(1.0, effectiveWidthPx / baseWidthPx); 
                        const finalScale = Math.max(0.7, scale); 
                        document.documentElement.style.fontSize = `${16 * finalScale}px`; }
                    else { document.documentElement.style.fontSize = '16px'; }
                };
                window.addEventListener('resize', handleResize); handleResize();
                return () => window.removeEventListener('resize', handleResize);
            }, []);

            const { scriptContent, vocabAndGrammarList, sentences, discussionQuestions } = useMemo(() => {
                const scriptContent = [
                  { id: 's1', speaker: 'Ïö∞Îîî', kor: 'ÏïàÎÖïÌïòÏÑ∏Ïöî! <Ïù¥ Ï£ºÏ†úÎ°ú Ïù¥ÏïºÍ∏∞Ìï¥ Î¥êÏöî> ÌåüÏ∫êÏä§Ìä∏ÏòàÏöî.', time: [12.500, 16.167], eng: 'Hello! This is the <Let\'s Talk About This Topic> podcast.' },
                  { id: 's2', speaker: 'Ïö∞Îîî', kor: 'Ï†ÄÎäî Ïö∞ÎîîÏòàÏöî?', time: [16.229, 17.802], eng: 'I\'m Woody?' },
                  { id: 's3', speaker: 'Ïú†ÎÇò', kor: 'ÏïàÎÖïÌïòÏÑ∏Ïöî! Ï†ÄÎäî Ïú†ÎÇòÏòàÏöî.', time: [17.948, 20.648], eng: 'Hello! I\'m Yuna.' },
                  { id: 's4', speaker: 'Ïö∞Îîî', kor: 'Ïú†ÎÇò Ïî®, Ïò§Îäò Ï†ÄÎäî Ï†ïÎßê Î∞îÎπ†Ïöî!', time: [20.700, 24.267], eng: 'Yuna, I\'m really busy today!' },
                  { id: 's5', speaker: 'Ïö∞Îîî', kor: 'Í∑∏Îü∞Îç∞ Î¨∏Ï†úÍ∞Ä ÏûàÏñ¥Ïöî.', time: [24.267, 26.080], eng: 'But there\'s a problem.' },
                  { id: 's6', speaker: 'Ïú†ÎÇò', kor: 'Î¨¥Ïä® Î¨∏Ï†úÏöî?', time: [26.192, 27.445], eng: 'What problem?' },
                  { id: 's7', speaker: 'Ïö∞Îîî', kor: 'Ìï† ÏùºÏù¥ ÎÑàÎ¨¥ ÎßéÏïÑÏÑú Ïò§Îäò ÏùºÏùÑ Î™ª ÎÅùÎÇº Í≤É Í∞ôÏïÑÏöî.üò¢', time: [27.532, 31.841], eng: 'I have so much work, I don\'t think I can finish it today. üò¢' },
                  { id: 's8', speaker: 'Ïú†ÎÇò', kor: 'Ïùå... Í∑∏Îüº Îä¶Í≤å Ìá¥Í∑ºÌïòÎ©¥ ÎêòÍ≤†ÎÑ§Ïöî.', time: [31.940, 35.629], eng: 'Hmm... Then you can just leave work late.' },
                  { id: 's9', speaker: 'Ïú†ÎÇò', kor: 'Î®ºÏ†Ä Ìá¥Í∑ºÌï†Í≤åÏöî.', time: [35.703, 37.327], eng: 'I\'ll be leaving first.' },
                  { id: 's10', speaker: 'Ïú†ÎÇò', kor: '‚ÄòÌá¥Í∑ºÌïòÎã§‚ÄôÎäî ‚ÄòÏùºÏù¥ ÎÅùÎÇòÍ≥† ÏßëÏóê Í∞ÄÎã§‚ÄôÎùºÎäî ÎúªÏù¥ÏóêÏöî.', time: [37.426, 42.188], eng: '‚ÄòTo leave work‚Äô (Ìá¥Í∑ºÌïòÎã§) means ‚Äòto finish work and go home‚Äô.' },
                  { id: 's11', speaker: 'Ïö∞Îîî', kor: 'ÎÑ§?üòß Î¨¥Ïä® ÎßêÏù¥ÏóêÏöî?', time: [42.399, 44.760], eng: 'What? üòß What do you mean?' },
                  { id: 's12', speaker: 'Ïö∞Îîî', kor: 'Ï†ÄÎèÑ Ìá¥Í∑ºÌï† Í±∞ÏòàÏöî.', time: [44.896, 46.177], eng: 'I\'m going to leave work too.' },
                  { id: 's13', speaker: 'Ïö∞Îîî', kor: 'Ïò§ÎäòÏùÄ Îä¶Í≤åÍπåÏßÄ ÏùºÌïòÍ∏∞ Ïã´Ïñ¥Ïöî.', time: [46.425, 48.939], eng: 'I don\'t want to work late today.' },
                  { id: 's14', speaker: 'Ïú†ÎÇò', kor: 'Í∑∏ÎÉ• ÎØ∏Î£®Îäî Í±∞ ÏïÑÎãàÏóêÏöî?', time: [49.200, 51.166], eng: 'Aren\'t you just procrastinating?' },
                  { id: 's15', speaker: 'Ïú†ÎÇò', kor: '\'ÎØ∏Î£®Îã§\'Îäî \'ÎÇòÏ§ëÏóê ÌïòÎã§\'ÎùºÎäî ÎúªÏù¥ÏóêÏöî.', time: [51.290, 54.836], eng: '‚ÄòTo procrastinate‚Äô (ÎØ∏Î£®Îã§) means ‚Äòto do later‚Äô.' },
                  { id: 's16', speaker: 'Ïö∞Îîî', kor: 'ÏïÑÎãàÏóêÏöî. Ìö®Ïú®Ï†ÅÏù∏ Í±∞ÏòàÏöî.', time: [55.059, 57.959], eng: 'No. It\'s being efficient.' },
                  { id: 's17', speaker: 'Ïö∞Îîî', kor: '‚ÄòÌö®Ïú®Ï†ÅÏù¥Îã§‚ÄôÏùÄ ‚ÄôÏ°∞Í∏à ÏùºÌïòÍ≥† Ï¢ãÏùÄ Í≤∞Í≥ºÎ•º ÏñªÏñ¥Ïöî.\'', time: [58.133, 62.583], eng: '‚ÄòTo be efficient‚Äô (Ìö®Ïú®Ï†ÅÏù¥Îã§) means ‚Äòyou work a little and get good results‚Äô.' },
                  { id: 's18', speaker: 'Ïö∞Îîî', kor: 'Ïò§ÎäòÏùò Ïö∞ÎîîÎäî Ïâ¨Í≥†, ÎÇ¥ÏùºÏùò Ïö∞ÎîîÍ∞Ä Ïó¥Ïã¨Ìûà ÏùºÌïòÎäî Í±∞ÏòàÏöî!', time: [62.901, 68.352], eng: 'Today\'s Woody rests, and tomorrow\'s Woody works hard!' },
                  { id: 's19', speaker: 'Ïú†ÎÇò', kor: 'Ïö∞Îîî Ïî®... Í∑∏Í±¥ ÎßêÏù¥ Ïïà ÎèºÏöî.', time: [68.600, 72.000], eng: 'Woody... that doesn\'t make sense.' },
                  { id: 's20', speaker: 'Ïú†ÎÇò', kor: 'Ïò§ÎäòÏùò Ïö∞ÎîîÏôÄ ÎÇ¥ÏùºÏùò Ïö∞ÎîîÎäî Í∞ôÏùÄ ÏÇ¨ÎûåÏù¥ÏóêÏöî.ü§®', time: [72.000, 76.095], eng: 'Today\'s Woody and tomorrow\'s Woody are the same person. ü§®' },
                  { id: 's21', speaker: 'Ïö∞Îîî', kor: 'ÏïÑÎãàÏóêÏöî! ÏôÑÏ†ÑÌûà Îã§Î•∏ ÏÇ¨ÎûåÏù¥ÏóêÏöî!', time: [76.400, 79.558], eng: 'No! They are completely different people!' },
                  { id: 's22', speaker: 'Ïö∞Îîî', kor: 'ÎÇ¥ÏùºÏùò Ïö∞ÎîîÎäî Ï≤úÏû¨ÏòàÏöî.', time: [79.694, 82.062], eng: 'Tomorrow\'s Woody is a genius.' },
                  { id: 's23', speaker: 'Ïö∞Îîî', kor: '‚ÄòÏ≤úÏû¨‚ÄôÎäî ‚ÄòÎ®∏Î¶¨Í∞Ä Ï¢ãÏùÄ ÏÇ¨Îûå‚ÄôÏù¥ÎùºÎäî ÎúªÏù¥ÏóêÏöî.', time: [82.236, 86.242], eng: '‚ÄòGenius‚Äô (Ï≤úÏû¨) means ‚Äòa person who is very smart‚Äô.' },
                  { id: 's24', speaker: 'Ïú†ÎÇò', kor: 'Í∑∏Îüº Ïñ¥Ï†úÏùò Ïö∞ÎîîÍ∞Ä Ïò§ÎäòÏùò Ïö∞ÎîîÏóêÍ≤å ÏùºÏùÑ Îß°Í≤ºÎäîÎç∞,', time: [86.316, 91.244], eng: 'Then yesterday\'s Woody entrusted work to today\'s Woody,' },
                  { id: 's25', speaker: 'Ïú†ÎÇò', kor: 'Ïò§ÎäòÏùò Ïö∞ÎîîÎäî Ïôú Ïïà ÌñàÏñ¥Ïöî?', time: [91.244, 93.695], eng: 'so why didn\'t today\'s Woody do it?' },
                  { id: 's26', speaker: 'Ïú†ÎÇò', kor: '‚ÄòÎß°Í∏∞Îã§‚ÄôÎäî ‚ÄòÎÇòÏùò ÏùºÏùÑ Îã§Î•∏ ÏÇ¨ÎûåÏóêÍ≤å Ï£ºÎã§‚ÄôÎùºÎäî ÎúªÏù¥ÏóêÏöî.', time: [93.881, 99.879], eng: '‚ÄòTo entrust‚Äô (Îß°Í∏∞Îã§) means ‚Äòto give my work to another person‚Äô.' },
                  { id: 's27', speaker: 'Ïö∞Îîî', kor: 'üò≥ Í∑∏‚Ä¶Í∑∏Í±¥... Ïñ¥Ï†úÏùò Ïö∞ÎîîÍ∞Ä Î∞îÎ≥¥ÏòÄÏñ¥Ïöî!ü§™', time: [101.080, 107.798], eng: 'üò≥ Th...that\'s... Yesterday\'s Woody was a fool! ü§™' },
                  { id: 's28', speaker: 'Ïö∞Îîî', kor: '\'Î∞îÎ≥¥\'Îäî \'Î®∏Î¶¨Í∞Ä ÎÇòÏÅú ÏÇ¨Îûå\'Ïù¥ÎùºÎäî ÎúªÏù¥ÏóêÏöî.', time: [108.108, 112.683], eng: '‚ÄòFool‚Äô (Î∞îÎ≥¥) means ‚Äòa person who is not smart‚Äô.' },
                  { id: 's29', speaker: 'Ïö∞Îîî', kor: 'ÌïòÏßÄÎßå ÎÇ¥ÏùºÏùò Ïö∞ÎîîÎäî Îã¨ÎùºÏöî!', time: [113.067, 116.467], eng: 'But tomorrow\'s Woody is different!' },
                  { id: 's30', speaker: 'Ïú†ÎÇò', kor: 'ÎÇ¥ÏùºÏùò Ïö∞ÎîîÍ∞Ä "Î™®Î†àÏùò Ïö∞ÎîîÍ∞Ä Ìï† Í±∞Ïïº"ÎùºÍ≥† ÎßêÌï† ÏàòÎèÑ ÏûàÏñ¥Ïöî.', time: [117.000, 122.207], eng: 'Tomorrow\'s Woody might say, "The day after tomorrow\'s Woody will do it".' },
                  { id: 's31', speaker: 'Ïú†ÎÇò', kor: '‚ÄòÎ™®Î†à‚ÄôÎäî ‚ÄòÎÇ¥ÏùºÏùò Îã§Ïùå ÎÇ†‚ÄôÏù¥ÎùºÎäî ÎúªÏù¥ÏóêÏöî.', time: [122.268, 126.397], eng: '‚ÄòThe day after tomorrow‚Äô (Î™®Î†à) means ‚Äòthe day after tomorrow‚Äô.' },
                  { id: 's32', speaker: 'Ïú†ÎÇò', kor: 'Í∑∏Îüº Ïñ¥ÎñªÍ≤å Ìï† Í±∞ÏòàÏöî?', time: [126.757, 128.802], eng: 'What will you do then?' },
                  { id: 's33', speaker: 'Ïö∞Îîî', kor: 'ÏïÑ... Í∑∏Í±¥... Ïùå...ü§î Í¥úÏ∞ÆÏïÑÏöî!', time: [129.199, 133.968], eng: 'Ah... that\'s... um... ü§î It\'s okay!' },
                  { id: 's34', speaker: 'Ïö∞Îîî', kor: 'Ïñ∏Ï††Í∞ÄÎäî ÎòëÎòëÌïú Ïö∞ÎîîÍ∞Ä Îã§ Ìï† Í±∞ÏòàÏöîüòé!', time: [134.336, 138.176], eng: 'Sometime, a smart Woody will do it all! üòé' },
                  { id: 's35', speaker: 'Ïú†ÎÇò', kor: 'Ïö∞Îîî Ïî®Îäî Í≤åÏùÑÎü¨Ïöî.', time: [138.400, 140.579], eng: 'Woody, you are lazy.' },
                  { id: 's36', speaker: 'Ïú†ÎÇò', kor: '\'Í≤åÏúºÎ•¥Îã§\'Îäî \'ÏùºÌïòÍ∏∞ Ïã´Ïñ¥ÌïòÎã§\'ÎùºÎäî ÎúªÏù¥ÏóêÏöî.', time: [140.652, 144.454], eng: '‚ÄòTo be lazy‚Äô (Í≤åÏúºÎ•¥Îã§) means ‚Äòto hate working‚Äô.' },
                  { id: 's37', speaker: 'Ïö∞Îîî', kor: 'Ïú†ÎÇò Ïî®Îäî Î°úÎ¥áÏù¥ÏóêÏöî?', time: [144.800, 146.819], eng: 'Yuna, are you a robot?' },
                  { id: 's38', speaker: 'Ïö∞Îîî', kor: 'Ïñ¥ÎñªÍ≤å Ïïà Ïâ¨Í≥† ÏùºÏùÑ Ìï¥Ïöî?', time: [147.000, 148.833], eng: 'How do you work without resting?' },
                  { id: 's39', speaker: 'Ïö∞Îîî', kor: 'Ï†ÄÎäî Ïò§Îäò ÌîºÍ≥§Ìï¥ÏÑú ÏùºÏùÑ Ìï† Ïàò ÏóÜÏñ¥Ïöî.', time: [149.283, 152.730], eng: 'I\'m tired today, so I can\'t work.' },
                  { id: 's40', speaker: 'Ïú†ÎÇò', kor: 'Í∑∏ÎûòÎèÑ Ïò§Îäò ÏùºÏùÄ Ïò§Îäò Ìï¥Ïïº Ìï¥Ïöî.', time: [153.301, 156.882], eng: 'Still, today\'s work must be done today.' },
                  { id: 's41', speaker: 'Ïú†ÎÇò', kor: 'Í∑∏Î†áÏßÄ ÏïäÏúºÎ©¥, ÌöåÏÇ¨ÏóêÏÑú ÏûòÎ¶¥ Ïàò ÏûàÏñ¥Ïöî.', time: [156.979, 160.708], eng: 'Otherwise, you could get fired from the company.' },
                  { id: 's42', speaker: 'Ïú†ÎÇò', kor: 'ÌöåÏÇ¨ÏóêÏÑú ÏûòÎ¶¨Îã§‚ÄôÎäî ‚ÄòÎçî Ïù¥ÏÉÅ ÌöåÏÇ¨Ïóê Í∞à Ïàò ÏóÜÎã§‚ÄôÎùºÎäî ÎúªÏù¥ÏóêÏöî.', time: [161.017, 166.928], eng: '‚ÄòTo get fired‚Äô (ÌöåÏÇ¨ÏóêÏÑú ÏûòÎ¶¨Îã§) means ‚Äòyou cannot go to the company anymore‚Äô.' },
                  { id: 's43', speaker: 'Ïö∞Îîî', kor: 'Ìóê üò±üò®. Ïú†ÎÇò Ïî®, Ï†Ä Ïò§Îäò ÏïºÍ∑ºÌï†Í≤åÏöî.üò´üò≠', time: [167.400, 172.349], eng: 'Whoa üò±üò®. Yuna, I\'ll work overtime tonight. üò´üò≠' },
                  { id: 's44', speaker: 'Ïö∞Îîî', kor: '‚ÄòÏïºÍ∑ºÌïòÎã§‚ÄôÎäî \'Î∞§ Îä¶Í≤åÍπåÏßÄ ÏùºÌïòÎã§‚ÄôÎùºÎäî ÎúªÏù¥ÏóêÏöî.', time: [172.659, 177.819], eng: '‚ÄòTo work overtime‚Äô (ÏïºÍ∑ºÌïòÎã§) means ‚Äòto work late into the night‚Äô.' },
                  { id: 's45', speaker: 'Ïö∞Îîî', kor: 'Î®ºÏ†Ä ÏßëÏóê Í∞ÄÏÑ∏Ïöî.üòûüò¢', time: [178.455, 180.229], eng: 'You can go home first. üòûüò¢' },
                  { id: 's46', speaker: 'Ïú†ÎÇò', kor: 'ÎÑ§, Í∑∏Îüº ÎÇ¥Ïùº ÏïÑÏπ®Ïóê ÎßåÎÇòÏöî.', time: [180.501, 183.932], eng: 'Okay, then I\'ll see you tomorrow morning.' },
                  { id: 's47', speaker: 'Ïö∞Îîî', kor: 'Í∑∏Îüº Ïò§ÎäòÏùÄ ÌòºÏûêüò¢ Îã®Ïñ¥Î•º Ï†ïÎ¶¨Ìï¥ Î≥ºÍ≤åÏöî.', time: [184.427, 189.186], eng: 'Then I\'ll review the vocabulary by myselfüò¢ today.' },
                  { id: 's48', speaker: 'Ïö∞Îîî', kor: '‚Ä¢ Ìá¥Í∑ºÌïòÎã§: ÏùºÏù¥ ÎÅùÎÇòÍ≥† ÏßëÏóê Í∞ÄÎã§', time: [189.782, 193.526], eng: '‚Ä¢ To leave work (Ìá¥Í∑ºÌïòÎã§): to finish work and go home' },
                  { id: 's49', speaker: 'Ïö∞Îîî', kor: '‚Ä¢ ÎØ∏Î£®Îã§: ÎÇòÏ§ëÏóê ÌïòÎã§', time: [193.910, 196.657], eng: '‚Ä¢ To procrastinate (ÎØ∏Î£®Îã§): to do later' },
                  { id: 's50', speaker: 'Ïö∞Îîî', kor: '‚Ä¢ Ìö®Ïú®Ï†ÅÏù¥Îã§: Ï°∞Í∏à ÏùºÌïòÍ≥† Ï¢ãÏùÄ Í≤∞Í≥ºÎ•º ÏñªÎã§', time: [197.142, 201.817], eng: '‚Ä¢ To be efficient (Ìö®Ïú®Ï†ÅÏù¥Îã§): to work a little and get good results' },
                  { id: 's51', speaker: 'Ïö∞Îîî', kor: '‚Ä¢ Ï≤úÏû¨: Î®∏Î¶¨Í∞Ä Ï¢ãÏùÄ ÏÇ¨Îûå', time: [202.154, 205.160], eng: '‚Ä¢ Genius (Ï≤úÏû¨): a person who is very smart' },
                  { id: 's52', speaker: 'Ïö∞Îîî', kor: '‚Ä¢ Îß°Í∏∞Îã§: ÎÇòÏùò ÏùºÏùÑ Îã§Î•∏ ÏÇ¨ÎûåÏóêÍ≤å Ï£ºÎã§', time: [205.520, 209.647], eng: '‚Ä¢ To entrust (Îß°Í∏∞Îã§): to give my work to another person' },
                  { id: 's53', speaker: 'Ïú†ÎÇò', kor: '‚Ä¢ Î∞îÎ≥¥: Î®∏Î¶¨Í∞Ä ÎÇòÏÅú ÏÇ¨Îûå', time: [210.614, 213.819], eng: '‚Ä¢ Fool (Î∞îÎ≥¥): a person who is not smart' },
                  { id: 's54', speaker: 'Ïú†ÎÇò', kor: '‚Ä¢ Î™®Î†à: ÎÇ¥ÏùºÏùò Îã§Ïùå ÎÇ†', time: [214.004, 216.782], eng: '‚Ä¢ The day after tomorrow (Î™®Î†à): the day after tomorrow' },
                  { id: 's55', speaker: 'Ïú†ÎÇò', kor: '‚Ä¢ Í≤åÏúºÎ•¥Îã§: ÏùºÌïòÍ∏∞ Ïã´Ïñ¥ÌïòÎã§', time: [216.968, 220.079], eng: '‚Ä¢ To be lazy (Í≤åÏúºÎ•¥Îã§): to hate working' },
                  { id: 's56', speaker: 'Ïú†ÎÇò', kor: '‚Ä¢ ÌöåÏÇ¨ÏóêÏÑú ÏûòÎ¶¨Îã§: Îçî Ïù¥ÏÉÅ ÌöåÏÇ¨Ïóê Í∞à Ïàò ÏóÜÎã§', time: [220.252, 224.787], eng: '‚Ä¢ To get fired (ÌöåÏÇ¨ÏóêÏÑú ÏûòÎ¶¨Îã§): to not be able to go to the company anymore' },
                  { id: 's57', speaker: 'Ïú†ÎÇò', kor: '‚Ä¢ ÏïºÍ∑ºÌïòÎã§: Î∞§ Îä¶Í≤åÍπåÏßÄ ÏùºÌïòÎã§', time: [225.126, 228.643], eng: '‚Ä¢ To work overtime (ÏïºÍ∑ºÌïòÎã§): to work late into the night' },
                  { id: 's58', speaker: 'Ïö∞Îîî', kor: 'üòØÏú†ÎÇò Ïî®, ÏïÑÏßÅ ÏßëÏóê Ïïà Í∞îÏñ¥Ïöî?', time: [230.000, 233.500], eng: 'üòØ Yuna, you haven\'t gone home yet?' },
                  { id: 's59', speaker: 'Ïú†ÎÇò', kor: 'ÎÑ§, Ï†ÄÎäî Ï∞©Ìïú ÏÇ¨ÎûåÏù¥ÎãàÍπå Ïö∞Îîî Ïî® ÏùºÏùÑ Ï°∞Í∏à ÎèÑÏôÄÏ§ÑÍ≤åÏöî.', time: [233.698, 239.931], eng: 'No, I\'m a nice person, so I\'ll help you with your work a little.' },
                  { id: 's60', speaker: 'Ïö∞Îîî', kor: 'Í≥†ÎßàÏõåÏöî Ïú†ÎÇò Ïî®.ü•π', time: [240.439, 242.655], eng: 'Thank you, Yuna. ü•π' },
                  { id: 's61', speaker: 'Ïö∞Îîî', kor: 'Í∑∏Îüº Ïó¨Îü¨Î∂Ñ Ïò§ÎäòÏùÄ Ïó¨Í∏∞ÍπåÏßÄ Ìï†Í≤åÏöî.', time: [243.151, 246.764], eng: 'Well everyone, that\'s all for today.' },
                  { id: 's62', speaker: 'Ïö∞Îîî', kor: 'Ï†ÄÎäî ÏùºÌï¥Ïïº Ìï¥Ïöî.üò•', time: [246.764, 248.491], eng: 'I have to work. üò•' },
                  { id: 's63', speaker: 'Ïú†ÎÇò', kor: 'ÏïàÎÖïÌûà Í≥ÑÏÑ∏Ïöî! Îã§ÏùåÏóê Îòê ÎßåÎÇòÏöî!', time: [248.827, 252.688], eng: 'Goodbye! See you next time!' }
                ];
                const vocabAndGrammarList = [
                    { term: 'Ïù¥ Ï£ºÏ†úÎ°ú Ïù¥ÏïºÍ∏∞Ìï¥ Î¥êÏöî', mainDef: 'Let\'s Talk About This Topic', examples: [], translations: { en: { main: 'Let\'s Talk About This Topic' } }, subDefs: [{ subTerm: '‚Ä¢ ‚ñ¢‚ñ¢ÏùÑ/Î•º Ï£ºÏ†úÎ°ú Ïù¥ÏïºÍ∏∞ÌïòÎã§', subDef: 'to talk about [something] as a topic', translations: { en: { def: 'to talk about [something] as a topic' } } }, { subTerm: '‚Ä¢ -ÏïÑ/Ïñ¥ Î≥¥Îã§', subDef: 'used to make gentle suggestions without sounding pushy', translations: { en: { def: 'used to make gentle suggestions without sounding pushy' } } }] },
                    { term: 'Ìï† Ïùº', mainDef: 'work to do', examples: [], translations: { en: { main: 'work to do' } }, subDefs: [{ subTerm: '‚Ä¢ ÌïòÎã§', subDef: 'to do', translations: { en: { def: 'to do' } } }, { subTerm: '‚Ä¢ -„Ñπ/ÏùÑ', subDef: 'used to turn a future-tense verb into an "adjective-ish" phrase that describes the following noun', translations: { en: { def: 'used to turn a future-tense verb into an "adjective-ish" phrase that describes the following noun' } } }, { subTerm: '‚Ä¢ Ïùº', subDef: 'work', translations: { en: { def: 'work' } } }] },
                    { term: 'ÎßéÏïÑÏÑú', mainDef: 'because there is a lot of...', examples: [], translations: { en: { main: 'because there is a lot of...' } }, subDefs: [{ subTerm: '‚Ä¢ ÎßéÎã§', subDef: 'to be many, a lot of', translations: { en: { def: 'to be many, a lot of' } } }, { subTerm: '‚Ä¢ -ÏïÑÏÑú/Ïñ¥ÏÑú', subDef: 'used to connect clauses indicating cause or reason ("because‚Ä¶")', translations: { en: { def: 'used to connect clauses indicating cause or reason ("because‚Ä¶")' } } }] },
                    { term: 'ÏùºÏùÑ Î™ª ÎÅùÎÇº Í≤É Í∞ôÏïÑÏöî', mainDef: 'I don\'t think I can finish the work.', examples: [], translations: { en: { main: 'I don\'t think I can finish the work.' } }, subDefs: [{ subTerm: '‚Ä¢ ÏùºÏùÑ ÎÅùÎÇ¥Îã§', subDef: 'to finish work', translations: { en: { def: 'to finish work' } } }, { subTerm: '‚Ä¢ -„Ñπ Í≤É Í∞ôÎã§', subDef: 'used to express assumption or guess about something that seems likely, often translated as ‚ÄúI think ‚Ä¶ will ‚Ä¶ / It looks like ‚Ä¶ / It seems ‚Ä¶.‚Äù', translations: { en: { def: 'used to express assumption or guess about something that seems likely, often translated as ‚ÄúI think ‚Ä¶ will ‚Ä¶ / It looks like ‚Ä¶ / It seems ‚Ä¶.‚Äù' } } }] },
                    { term: 'Îä¶Í≤å', mainDef: 'late', examples: [], translations: { en: { main: 'late' } }, subDefs: [] },
                    { term: 'Ìá¥Í∑ºÌïòÎ©¥ ÎêòÍ≤†ÎÑ§Ïöî', mainDef: 'It\'s fine if you leave work late.', examples: [], translations: { en: { main: 'It\'s fine if you leave work late.' } }, subDefs: [{ subTerm: '‚Ä¢ Ìá¥Í∑ºÌïòÎã§', subDef: 'to leave work', translations: { en: { def: 'to leave work' } } }, { subTerm: '‚Ä¢ -Î©¥ ÎêòÎã§', subDef: 'used to say that one condition or action is enough, often translated as ‚Äúall you have to do is ‚Ä¶‚Äù or ‚Äúit‚Äôs fine if ‚Ä¶.‚Äù', translations: { en: { def: 'used to say that one condition or action is enough, often translated as ‚Äúall you have to do is ‚Ä¶‚Äù or ‚Äúit‚Äôs fine if ‚Ä¶.‚Äù' } } }, { subTerm: '‚Ä¢ -Í≤†ÎÑ§Ïöî', subDef: 'used to show an immediate reaction, realization, or empathy, often translated as ‚ÄúI guess ‚Ä¶ / That must be ‚Ä¶ / Sounds ‚Ä¶‚Äù', translations: { en: { def: 'used to show an immediate reaction, realization, or empathy, often translated as ‚ÄúI guess ‚Ä¶ / That must be ‚Ä¶ / Sounds ‚Ä¶‚Äù' } } }] },
                    { term: 'Ìá¥Í∑ºÌïòÎã§', mainDef: 'to leave work', examples: [], translations: { en: { main: 'to leave work' } }, subDefs: [] },
                    { term: 'ÏùºÏù¥ ÎÅùÎÇòÍ≥†', mainDef: 'after the work is done', examples: [], translations: { en: { main: 'after the work is done' } }, subDefs: [{ subTerm: '‚Ä¢ ÏùºÏù¥ ÎÅùÎÇòÎã§', subDef: 'for the work to be finished', translations: { en: { def: 'for the work to be finished' } } }, { subTerm: '‚Ä¢ -Í≥†', subDef: 'used to connect two verbs, meaning ‚Äúand then‚Äù or simply ‚Äúand,‚Äù to show actions happening in sequence.', translations: { en: { def: 'used to connect two verbs, meaning ‚Äúand then‚Äù or simply ‚Äúand,‚Äù to show actions happening in sequence.' } } }] },
                    { term: '-ÎùºÎäî ÎúªÏù¥ÏóêÏöî', mainDef: '"It means that‚Ä¶"', examples: [], translations: { en: { main: '"It means that‚Ä¶"' } }, subDefs: [{ subTerm: '‚Ä¢ -(Ïù¥)ÎùºÎäî Îúª', subDef: 'used to state the meaning of a word or phrase', translations: { en: { def: 'used to state the meaning of a word or phrase' } } }] },
                    { term: 'Î¨¥Ïä® ÎßêÏù¥ÏóêÏöî?', mainDef: 'What do you mean?', examples: [], translations: { en: { main: 'What do you mean?' } }, subDefs: [] },
                    { term: 'Îä¶Í≤åÍπåÏßÄ', mainDef: 'until late', examples: [], translations: { en: { main: 'until late' } }, subDefs: [{ subTerm: '‚Ä¢ Îä¶Í≤å', subDef: 'late', translations: { en: { def: 'late' } } }, { subTerm: '‚Ä¢ -ÍπåÏßÄ', subDef: 'until', translations: { en: { def: 'until' } } }] },
                    { term: 'ÏùºÌïòÍ∏∞ Ïã´Ïñ¥Ïöî', mainDef: 'I don\'t want to work.', examples: [], translations: { en: { main: 'I don\'t want to work.' } }, subDefs: [{ subTerm: '‚Ä¢ ÏùºÌïòÎã§', subDef: 'to work', translations: { en: { def: 'to work' } } }, { subTerm: '‚Ä¢ -Í∏∞ Ïã´Îã§', subDef: 'used for your own dislike (‚ÄúI don\‚Äôt want to ‚Ä¶‚Äù),', translations: { en: { def: 'used for your own dislike (‚ÄúI don\‚Äôt want to ‚Ä¶‚Äù),' } } }] },
                    { term: 'ÎØ∏Î£®Îäî Í±∞', mainDef: 'the act of postponing', examples: [], translations: { en: { main: 'the act of postponing' } }, subDefs: [{ subTerm: '‚Ä¢ ÎØ∏Î£®Îã§', subDef: 'to postpone, to put off', translations: { en: { def: 'to postpone, to put off' } } }, { subTerm: '‚Ä¢ -Îäî Í±∞', subDef: 'A colloquial form of -Îäî Í≤É, used to nominalize verbs by turning a verb into a noun phrase meaning ‚Äúthe act of ‚Ä¶,‚Äù ‚Äúthe fact of ‚Ä¶,‚Äù or ‚Äúthe thing that ‚Ä¶‚Äù', translations: { en: { def: 'A colloquial form of -Îäî Í≤É, used to nominalize verbs by turning a verb into a noun phrase meaning ‚Äúthe act of ‚Ä¶,‚Äù ‚Äúthe fact of ‚Ä¶,‚Äù or ‚Äúthe thing that ‚Ä¶‚Äù' } } }] },
                    { term: 'ÎØ∏Î£®Îã§', mainDef: 'to postpone, to put off', examples: [], translations: { en: { main: 'to postpone, to put off' } }, subDefs: [] },
                    { term: 'Ìö®Ïú®Ï†ÅÏù∏ Í±∞ÏòàÏöî', mainDef: 'it is being efficient.', examples: [], translations: { en: { main: 'it is being efficient.' } }, subDefs: [{ subTerm: '‚Ä¢ Ìö®Ïú®Ï†ÅÏù¥Îã§', subDef: 'to be efficient', translations: { en: { def: 'to be efficient' } } }, { subTerm: '‚Ä¢ -„Ñ¥ Í±∞ÏòàÏöî', subDef: 'A colloquial form of -„Ñ¥ Í≤ÉÏù¥Îã§, used to explain, clarify, or emphasize what something really is; ‚Äúit is that ‚Ä¶‚Äù, ‚Äúthe fact is that ‚Ä¶‚Äù, or ‚Äúwhat ‚Ä¶ means is ‚Ä¶‚Äù', translations: { en: { def: 'A colloquial form of -„Ñ¥ Í≤ÉÏù¥Îã§, used to explain, clarify, or emphasize what something really is; ‚Äúit is that ‚Ä¶‚Äù, ‚Äúthe fact is that ‚Ä¶‚Äù, or ‚Äúwhat ‚Ä¶ means is ‚Ä¶‚Äù' } } }] },
                    { term: 'Ìö®Ïú®Ï†ÅÏù¥Îã§', mainDef: 'to be efficient', examples: [], translations: { en: { main: 'to be efficient' } }, subDefs: [] },
                    { term: 'Í≤∞Í≥º', mainDef: 'result', examples: [], translations: { en: { main: 'result' } }, subDefs: [] },
                    { term: 'ÏñªÎã§', mainDef: 'to get, to obtain', examples: [], translations: { en: { main: 'to get, to obtain' } }, subDefs: [] },
                    { term: 'Ïó¥Ïã¨Ìûà', mainDef: 'hard, diligently', examples: [], translations: { en: { main: 'hard, diligently' } }, subDefs: [] },
                    { term: 'ÏùºÌïòÎäî Í±∞ÏòàÏöî', mainDef: 'it is the act of working.', examples: [], translations: { en: { main: 'it is the act of working.' } }, subDefs: [{ subTerm: '‚Ä¢ ÏùºÌïòÎã§', subDef: 'to work', translations: { en: { def: 'to work' } } }, { subTerm: '‚Ä¢ -Îäî Í±∞ÏòàÏöî', subDef: 'A colloquial form of -Îäî Í≤ÉÏù¥Îã§, which is  used to explain, clarify, or emphasize what something really is; ‚Äúit is that ‚Ä¶‚Äù, ‚Äúthe fact is that ‚Ä¶‚Äù, or ‚Äúwhat ‚Ä¶ means is ‚Ä¶‚Äù', translations: { en: { def: 'A colloquial form of -Îäî Í≤ÉÏù¥Îã§, which is  used to explain, clarify, or emphasize what something really is; ‚Äúit is that ‚Ä¶‚Äù, ‚Äúthe fact is that ‚Ä¶‚Äù, or ‚Äúwhat ‚Ä¶ means is ‚Ä¶‚Äù' } } }] },
                    { term: 'Í∑∏Í±¥ ÎßêÏù¥ Ïïà ÎèºÏöî', mainDef: 'That doesn\'t make sense.', examples: [], translations: { en: { main: 'That doesn\'t make sense.' } }, subDefs: [{ subTerm: '‚Ä¢ ÎßêÏù¥ ÎêòÎã§', subDef: 'to make sense', translations: { en: { def: 'to make sense' } } }] },
                    { term: 'Í∞ôÏùÄ ÏÇ¨Îûå', mainDef: 'the same person', examples: [], translations: { en: { main: 'the same person' } }, subDefs: [{ subTerm: '‚Ä¢ Í∞ôÎã§', subDef: 'to be the same, to be like', translations: { en: { def: 'to be the same, to be like' } } }, { subTerm: '‚Ä¢ -„Ñ¥/ÏùÄ', subDef: 'used to turn a descriptive verb, which means an adjective in English, into an ‚Äúadjective-ish‚Äù phrase that describes the following noun', translations: { en: { def: 'used to turn a descriptive verb, which means an adjective in English, into an ‚Äúadjective-ish‚Äù phrase that describes the following noun' } } }] },
                    { term: 'ÏôÑÏ†ÑÌûà', mainDef: 'completely', examples: [], translations: { en: { main: 'completely' } }, subDefs: [] },
                    { term: 'Îã§Î•∏ ÏÇ¨Îûå', mainDef: 'a different person', examples: [], translations: { en: { main: 'a different person' } }, subDefs: [{ subTerm: '‚Ä¢ Îã§Î•¥Îã§', subDef: 'to be different', translations: { en: { def: 'to be different' } } }, { subTerm: '‚Ä¢ -„Ñ¥/ÏùÄ', subDef: 'used to turn a descriptive verb, which means an adjective in English, into an ‚Äúadjective-ish‚Äù phrase that describes the following noun', translations: { en: { def: 'used to turn a descriptive verb, which means an adjective in English, into an ‚Äúadjective-ish‚Äù phrase that describes the following noun' } } }] },
                    { term: 'Ï≤úÏû¨', mainDef: 'a genius', examples: [], translations: { en: { main: 'a genius' } }, subDefs: [] },
                    { term: 'Îß°Í≤ºÎäîÎç∞', mainDef: 'entrusted, but...', examples: [], translations: { en: { main: 'entrusted, but...' } }, subDefs: [{ subTerm: '‚Ä¢ Îß°Í∏∞Îã§', subDef: 'to entrust, to assign', translations: { en: { def: 'to entrust, to assign' } } }, { subTerm: '‚Ä¢ -ÎäîÎç∞', subDef: 'used to show contrast, or set up background often softening the tone or inviting the listener to respond.', translations: { en: { def: 'used to show contrast, or set up background often softening the tone or inviting the listener to respond.' } } }] },
                    { term: 'Îß°Í∏∞Îã§', mainDef: 'to entrust, to assign', examples: [], translations: { en: { main: 'to entrust, to assign' } }, subDefs: [] },
                    { term: 'Î∞îÎ≥¥', mainDef: 'a fool, an idiot', examples: [], translations: { en: { main: 'a fool, an idiot' } }, subDefs: [] },
                    { term: 'Î™®Î†à', mainDef: 'the day after tomorrow', examples: [], translations: { en: { main: 'the day after tomorrow' } }, subDefs: [] },
                    { term: 'Ïñ∏Ï††Í∞Ä', mainDef: 'someday', examples: [], translations: { en: { main: 'someday' } }, subDefs: [] },
                    { term: 'ÎòëÎòëÌïú', mainDef: 'smart', examples: [], translations: { en: { main: 'smart' } }, subDefs: [{ subTerm: '‚Ä¢ ÎòëÎòëÌïòÎã§', subDef: 'to be smart', translations: { en: { def: 'to be smart' } } }] },
                    { term: 'Í≤åÏúºÎ•¥Îã§', mainDef: 'to be lazy', examples: [], translations: { en: { main: 'to be lazy' } }, subDefs: [] },
                    { term: 'ÏùºÌïòÍ∏∞ Ïã´Ïñ¥ÌïòÎã§', mainDef: 'to dislike working', examples: [], translations: { en: { main: 'to dislike working' } }, subDefs: [{ subTerm: '‚Ä¢ ÏùºÌïòÎã§', subDef: 'to work', translations: { en: { def: 'to work' } } }, { subTerm: '‚Ä¢ -Í∏∞ Ïã´Ïñ¥ÌïòÎã§', subDef: 'used when talking about someone else‚Äôs dislike (‚ÄúThey don‚Äôt want to ‚Ä¶‚Äù).', translations: { en: { def: 'used when talking about someone else‚Äôs dislike (‚ÄúThey don‚Äôt want to ‚Ä¶‚Äù).' } } }] },
                    { term: 'Î°úÎ¥á', mainDef: 'a robot', examples: [], translations: { en: { main: 'a robot' } }, subDefs: [] },
                    { term: 'ÌîºÍ≥§Ìï¥ÏÑú', mainDef: 'because I am tired', examples: [], translations: { en: { main: 'because I am tired' } }, subDefs: [{ subTerm: '‚Ä¢ ÌîºÍ≥§ÌïòÎã§', subDef: 'to be tired', translations: { en: { def: 'to be tired' } } }, { subTerm: '‚Ä¢ -ÏïÑÏÑú/Ïñ¥ÏÑú', subDef: 'used to connect clauses indicating cause or reason ("because‚Ä¶")', translations: { en: { def: 'used to connect clauses indicating cause or reason ("because‚Ä¶")' } } }] },
                    { term: 'Í∑∏Î†áÏßÄ ÏïäÏúºÎ©¥', mainDef: 'if not, otherwise', examples: [], translations: { en: { main: 'if not, otherwise' } }, subDefs: [] },
                    { term: 'ÌöåÏÇ¨ÏóêÏÑú ÏûòÎ¶¨Îã§', mainDef: 'to get fired', examples: [], translations: { en: { main: 'to get fired' } }, subDefs: [] },
                    { term: 'Îçî Ïù¥ÏÉÅ', mainDef: 'any more, no longer', examples: [], translations: { en: { main: 'any more, no longer' } }, subDefs: [] },
                    { term: 'Ìóê', mainDef: 'OMG', examples: [], translations: { en: { main: 'OMG' } }, subDefs: [] },
                    { term: 'ÏïºÍ∑ºÌïòÎã§', mainDef: 'to work overtime', examples: [], translations: { en: { main: 'to work overtime' } }, subDefs: [] },
                    { term: 'Ï†ïÎ¶¨Ìï¥ Î≥ºÍ≤åÏöî', mainDef: 'I will organize', examples: [], translations: { en: { main: 'I will organize' } }, subDefs: [{ subTerm: '‚Ä¢ Ï†ïÎ¶¨ÌïòÎã§', subDef: 'to summarize, to organize', translations: { en: { def: 'to summarize, to organize' } } }, { subTerm: '‚Ä¢ -ÏïÑ/Ïñ¥ Î≥ºÍ≤åÏöî', subDef: 'used to politely show your intention to attempt something.', translations: { en: { def: 'used to politely show your intention to attempt something.' } } }] },
                    { term: 'Ï∞©Ìïú ÏÇ¨Îûå', mainDef: 'a good person', examples: [], translations: { en: { main: 'a good person' } }, subDefs: [{ subTerm: '‚Ä¢ Ï∞©ÌïòÎã§', subDef: 'to be good, kind', translations: { en: { def: 'to be good, kind' } } }, { subTerm: '‚Ä¢ -„Ñ¥/ÏùÄ', subDef: 'used to turn a descriptive verb, which means an adjective in English, into an ‚Äúadjective-ish‚Äù phrase that describes the following noun', translations: { en: { def: 'used to turn a descriptive verb, which means an adjective in English, into an ‚Äúadjective-ish‚Äù phrase that describes the following noun' } } }] },
                    { term: 'Ïó¨Í∏∞ÍπåÏßÄ Ìï†Í≤åÏöî', mainDef: 'I\'ll stop here.', examples: [], translations: { en: { main: 'I\'ll stop here.' } }, subDefs: [{ subTerm: '‚Ä¢ Ïó¨Í∏∞ÍπåÏßÄ ÌïòÎã§', subDef: 'to stop here, wrap something up', translations: { en: { def: 'to stop here, wrap something up' } } }, { subTerm: '‚Ä¢ -Í≤åÏöî', subDef: 'used to politely express your decision or intention to do something, especially when it affects the listener.', translations: { en: { def: 'used to politely express your decision or intention to do something, especially when it affects the listener.' } } }] }
                ];
                const sentences = [
                { id: 1, parts: ["Ïö∞ÎîîÎäî Ìï† ÏùºÏù¥ ÎÑàÎ¨¥ ", " Ïò§Îäò ÏùºÏùÑ Îã§ Î™ª ÎÅùÎÇº Í≤É Í∞ôÏïòÏñ¥Ïöî."], blank: 'because there was a lot', answer: 'ÎßéÏïÑÏÑú', bank: ['ÎßéÏïÑÏÑú', 'ÎßéÍ≥†', 'ÎßéÏúºÎ©¥ÏÑú', 'ÎßéÏùÄÎç∞'], explanation: "The grammar pattern '-ÏïÑÏÑú/Ïñ¥ÏÑú' is used to show cause or reason.", eng: "Woody had too much work, so he couldn't finish it all today.", wrongAnswerExplanations: { 'ÎßéÍ≥†': "'-Í≥†' connects two actions sequentially.", 'ÎßéÏúºÎ©¥ÏÑú': "'-ÏúºÎ©¥ÏÑú' means 'while doing something else.'", 'ÎßéÏùÄÎç∞': "'-„Ñ¥Îç∞' is for background information or contrast." } },
                { id: 2, parts: ["Ïú†ÎÇòÎäî Ïö∞ÎîîÎ≥¥Îã§ Î®ºÏ†Ä ", "Í≥† ÌñàÏñ¥Ïöî."], blank: 'would leave work', answer: 'Ìá¥Í∑ºÌïòÍ≤†Îã§Í≥†', bank: ['ÏûêÍ≤†Îã§Í≥†', 'ÌöåÏùòÌïòÍ≤†Îã§Í≥†', 'Ï∂úÍ∑ºÌïòÍ≤†Îã§Í≥†', 'Ìá¥Í∑ºÌïòÍ≤†Îã§Í≥†'], explanation: "The phrase 'Ìá¥Í∑ºÌïòÍ≤†Îã§' means 'I will leave work'. The ending '-Í≥† ÌïòÎã§' is used to quote what someone said.", eng: "Yuna said she would leave work before Woody.", wrongAnswerExplanations: { 'ÏûêÍ≤†Îã§Í≥†': "'ÏûêÍ≤†Îã§' means 'I will sleep'.", 'ÌöåÏùòÌïòÍ≤†Îã§Í≥†': "'ÌöåÏùòÌïòÍ≤†Îã§' means 'I will have a meeting'.", 'Ï∂úÍ∑ºÌïòÍ≤†Îã§Í≥†': "'Ï∂úÍ∑ºÌïòÍ≤†Îã§' means 'I will go to work'." } },
                { id: 3, parts: ["Ïö∞ÎîîÎäî Ïò§Îäò ÏùºÏùÑ ÎÅùÎÇ¥Îäî ÎåÄÏã† ÎÇ¥ÏùºÎ°ú ", " Ïã∂ÏóàÏñ¥Ïöî."], blank: 'to postpone', answer: 'ÎØ∏Î£®Í≥†', bank: ['Îß°Í∏∞Í≥†', 'ÎØ∏Î£®Í≥†', 'ÎèÑÏôÄÏ£ºÍ≥†', 'ÎßåÎì§Í≥†'], explanation: "'ÎØ∏Î£®Îã§' means 'to postpone'. The phrase 'ÎØ∏Î£®Í≥† Ïã∂Îã§' means 'to want to postpone'.", eng: "Instead of finishing his work today, Woody wanted to postpone it until tomorrow.", wrongAnswerExplanations: { 'Îß°Í∏∞Í≥†': "'Îß°Í∏∞Îã§' means 'to entrust/assign'.", 'ÎèÑÏôÄÏ£ºÍ≥†': "'ÎèÑÏôÄÏ£ºÎã§' means 'to help'.", 'ÎßåÎì§Í≥†': "'ÎßåÎì§Îã§' means 'to make'." } },
                { id: 4, parts: ["Ïö∞ÎîîÎäî ÏùºÏùÑ ÎØ∏Î£®Îäî ÏûêÏã†Ïùò ÌñâÎèôÏù¥ ", " Î∞©Î≤ïÏù¥ÎùºÍ≥† Ï£ºÏû•ÌñàÏñ¥Ïöî."], blank: 'efficient', answer: 'Ìö®Ïú®Ï†ÅÏù∏', bank: ['Î∞îÎ≥¥ Í∞ôÏùÄ', 'Í≤åÏúºÎ•∏', 'Ï≤úÏû¨Ï†ÅÏù∏', 'Ìö®Ïú®Ï†ÅÏù∏'], explanation: "'Ìö®Ïú®Ï†ÅÏù¥Îã§' means 'to be efficient'. Woody claimed his procrastination was actually efficient.", eng: "Woody claimed that postponing his work was an 'efficient' method.", wrongAnswerExplanations: { 'Î∞îÎ≥¥ Í∞ôÏùÄ': "Means 'like a fool'.", 'Í≤åÏúºÎ•∏': "Means 'lazy'.", 'Ï≤úÏû¨Ï†ÅÏù∏': "Means 'genius-like'." } },
                { id: 5, parts: ["Ïö∞ÎîîÎäî ÎÇ¥ÏùºÏùò Ïö∞ÎîîÍ∞Ä ", "ÎùºÏÑú ÏùºÏùÑ ÏûòÌï† Í≤ÉÏù¥ÎùºÍ≥† ÎØøÏóàÏñ¥Ïöî."], blank: 'a genius', answer: 'Ï≤úÏû¨', bank: ['Î∞îÎ≥¥', 'Ï≤úÏû¨', 'Ïñ¥Î•∏', 'Î°úÎ¥á'], explanation: "Woody's reason for procrastinating is that his 'future self' will be a genius.", eng: "Woody believed that his future self would be a 'genius' and do the work well.", wrongAnswerExplanations: { 'Î∞îÎ≥¥': "Means 'fool' or 'idiot'.", 'Ïñ¥Î•∏': "Means 'adult'.", 'Î°úÎ¥á': "Means 'robot'." } },
                { id: 6, parts: ["ÌïòÏßÄÎßå Ïñ¥Ï†úÏùò Ïö∞ÎîîÎäî Ïò§ÎäòÏùò Ïö∞ÎîîÏóêÍ≤å ÏùºÏùÑ ", "."], blank: 'assigned', answer: 'Îß°Í≤ºÏñ¥Ïöî', bank: ['Îß°Í≤ºÏñ¥Ïöî', 'ÎÅùÎÉàÏñ¥Ïöî', 'Í∞ÄÎ•¥Ï≥§Ïñ¥Ïöî', 'ÎèÑÏôÄÏ§¨Ïñ¥Ïöî'], explanation: "'Îß°Í∏∞Îã§' means 'to entrust' or 'to assign'. This is Yuna's counter-argument.", eng: "However, yesterday's Woody entrusted the work to today's Woody.", wrongAnswerExplanations: { 'ÎÅùÎÉàÏñ¥Ïöî': "Means 'finished'.", 'Í∞ÄÎ•¥Ï≥§Ïñ¥Ïöî': "Means 'taught'.", 'ÎèÑÏôÄÏ§¨Ïñ¥Ïöî': "Means 'helped'." } },
                { id: 7, parts: ["Í∑∏ÎûòÏÑú Ïú†ÎÇòÎäî ÏùºÏùÑ ÎØ∏Î£®Îäî Ïö∞ÎîîÎ•º Î≥¥Í≥† ", "Í≥† ÏÉùÍ∞ÅÌñàÏñ¥Ïöî."], blank: 'lazy', answer: 'Í≤åÏúºÎ•¥Îã§', bank: ['ÎòëÎòëÌïòÎã§', 'Î∞îÏÅòÎã§', 'Í≤åÏúºÎ•¥Îã§', 'ÌîºÍ≥§ÌïòÎã§'], explanation: "Yuna's direct opinion of Woody's behavior is that it is lazy.", eng: "So Yuna thought Woody was 'lazy' for postponing his work.", wrongAnswerExplanations: { 'ÎòëÎòëÌïòÎã§': "Means 'smart'.", 'Î∞îÏÅòÎã§': "Means 'busy'.", 'ÌîºÍ≥§ÌïòÎã§': "Means 'tired'." } },
                { id: 8, parts: ["Ïú†ÎÇòÎäî ÎÇ¥ÏùºÏùò Ïö∞ÎîîÍ∞Ä ", "Ïùò Ïö∞ÎîîÏóêÍ≤å Îòê ÎØ∏Î£∞ ÏàòÎèÑ ÏûàÎã§Í≥† ÎßêÌñàÏñ¥Ïöî."], blank: 'the day after tomorrow', answer: 'Î™®Î†à', bank: ['Î™®Î†à', 'Ïñ¥Ï†ú', 'Ïò§Îäò', 'Í∑∏Ï†ú'], explanation: "'Î™®Î†à' means 'the day after tomorrow'. This is a prediction about future procrastination.", eng: "Yuna said that tomorrow's Woody might postpone the work to the day after tomorrow.", wrongAnswerExplanations: { 'Ïñ¥Ï†ú': "Means 'yesterday'.", 'Ïò§Îäò': "Means 'today'.", 'Í∑∏Ï†ú': "Means 'the day before yesterday'." } },
                { id: 9, parts: ["Ïú†ÎÇòÎäî ÏùºÏùÑ Í≥ÑÏÜç ÎØ∏Î£®Î©¥ ÌöåÏÇ¨ÏóêÏÑú ", " Ïàò ÏûàÎã§Í≥† Í≤ΩÍ≥†ÌñàÏñ¥Ïöî."], blank: 'get fired', answer: 'ÏûòÎ¶¥', bank: ['ÏûòÎ¶¥', 'ÎèàÏùÑ Î≤å', 'ÏäπÏßÑÌï†', 'Ìá¥Í∑ºÌï†'], explanation: "'ÌöåÏÇ¨ÏóêÏÑú ÏûòÎ¶¨Îã§' means 'to get fired'. This is the consequence Yuna warns Woody about.", eng: "Yuna warned that if he kept postponing his work, he might get 'fired' from the company.", wrongAnswerExplanations: { 'ÎèàÏùÑ Î≤å': "Means 'earn money'.", 'ÏäπÏßÑÌï†': "Means 'get promoted'.", 'Ìá¥Í∑ºÌï†': "Means 'leave work'." } },
                { id: 10, parts: ["Ïú†ÎÇòÏùò Í≤ΩÍ≥†Î•º Îì§ÏùÄ Ïö∞ÎîîÎäî Í≤∞Íµ≠ ", "Î°ú ÎßàÏùåÏùÑ Î∞îÍø®Ïñ¥Ïöî."], blank: 'to work overtime', answer: 'ÏïºÍ∑ºÌïòÍ∏∞Î°ú', bank: ['ÌöåÏùòÌïòÍ∏∞Î°ú', 'Ìá¥Í∑ºÌïòÍ∏∞Î°ú', 'ÏÇ¨ÏßÅÌïòÍ∏∞Î°ú', 'ÏïºÍ∑ºÌïòÍ∏∞Î°ú'], explanation: "'ÏïºÍ∑ºÌïòÎã§' means 'to work overtime'. After Yuna's warning, Woody decides to do the work.", eng: "After hearing Yuna's warning, Woody finally changed his mind and decided to work overtime.", wrongAnswerExplanations: { 'ÌöåÏùòÌïòÍ∏∞Î°ú': "Means 'to decide to have a meeting'.", 'Ìá¥Í∑ºÌïòÍ∏∞Î°ú': "Means 'to decide to leave work'.", 'ÏÇ¨ÏßÅÌïòÍ∏∞Î°ú': "Means 'to decide to resign'." } }
                ];
                const discussionQuestions = [
                { num: 1, kor: "Ïó¨Îü¨Î∂ÑÏùÄ Ïò§Îäò Ìï† ÏùºÏùÑ ÎÇ¥ÏùºÎ°ú ÎØ∏Î£®Îäî Ìé∏Ïù¥ÏóêÏöî? ÏôúÏöî?", eng: "Are you the type of person who procrastinates on today's tasks until tomorrow? Why?", vocab: [ { term: "ÏùºÏùÑ ÎØ∏Î£®Îã§", meaning_eng: "To procrastinate on work" }, { term: "-Îäî Ìé∏Ïù¥Îã§", meaning_eng: "To be the type/tend to..." } ] },
                { num: 2, kor: "ÏùºÏùÑ ÎØ∏Î£®Îäî Í≤ÉÏù¥ 'Ìö®Ïú®Ï†Å'Ïù¥ÎùºÍ≥† ÏÉùÍ∞ÅÌï¥Ïöî? ÏïÑÎãàÎ©¥ 'Í≤åÏúºÎ•¥Îã§‚ÄôÍ≥† ÏÉùÍ∞ÅÌï¥Ïöî?", eng: "Do you think procrastinating is 'efficient'? Or do you think it's 'lazy'?", vocab: [ { term: "ÏùºÏùÑ ÎØ∏Î£®Îäî Í≤É", meaning_eng: "To procrastinate (noun form)" }, { term: "Ìö®Ïú®Ï†ÅÏù¥Îã§", meaning_eng: "To be efficient" }, { term: "Í≤åÏúºÎ•¥Îã§", meaning_eng: "To be lazy" } ] },
                { num: 3, kor: "Ïó¨Îü¨Î∂ÑÏùÄ ÏùºÏù¥ Ïïà ÎÅùÎÇ¨ÏùÑ Îïå, Î≥¥ÌÜµ Î∞§ Îä¶Í≤åÍπåÏßÄ ÏùºÌï¥Ïöî? ÏïÑÎãàÎ©¥ Îã§Ïùå ÎÇ† Ìï¥Ïöî?", eng: "When you haven't finished your work, do you usually work late into the night? Or do you do it the next day?", vocab: [ { term: "Î∞§ Îä¶Í≤åÍπåÏßÄ", meaning_eng: "Late into the night" }, { term: "Îã§Ïùå ÎÇ†", meaning_eng: "The next day" } ] },
                { num: 4, kor: "Ïö∞ÎîîÎäî 'ÎÇ¥ÏùºÏùò Ïö∞ÎîîÎäî Ï≤úÏû¨'ÎùºÍ≥† ÎßêÌñàÏñ¥Ïöî. Ïó¨Îü¨Î∂ÑÎèÑ 'ÎÇ¥ÏùºÏùò ÎÇò'Î•º ÎØøÎäî Ìé∏Ïù¥ÏóêÏöî?", eng: "Woody said, 'Tomorrow's Woody is a genius.' Are you also the type to believe in 'Tomorrow's Me'?", vocab: [ { term: "Ï≤úÏû¨", meaning_eng: "Genius" }, { term: "ÎØøÎã§", meaning_eng: "To believe" }, { term: "-Îäî Ìé∏Ïù¥Îã§", meaning_eng: "To be the type/tend to..." } ] },
                { num: 5, kor: "Ïñ¥Ï†úÏùò ÎÇ¥Í∞Ä Ïò§ÎäòÏùò ÎÇòÏóêÍ≤å ÏùºÏùÑ Îß°Í≤ºÏñ¥Ïöî. Í∑∏Îü∞Îç∞ Ïò§ÎäòÏùò ÎÇ¥Í∞Ä Í∑∏ ÏùºÏùÑ ÌïòÍ∏∞ Ïã´Ïñ¥Ïöî. Í∑∏Îüº Ïñ¥ÎñªÍ≤å Ìï¥Ïöî?", eng: "Yesterday's Me left a task for Today's Me. But Today's Me doesn't want to do it. What do you do?", vocab: [ { term: "Ïñ¥Ï†úÏùò ÎÇò", meaning_eng: "Yesterday's Me" }, { term: "Ïò§ÎäòÏùò ÎÇò", meaning_eng: "Today's Me" }, { term: "ÏùºÏùÑ Îß°Í∏∞Îã§", meaning_eng: "To entrust a task" }, { term: "ÌïòÍ∏∞ Ïã´Îã§", meaning_eng: "To not want to do" } ] },
                { num: 6, kor: "ÏùºÏùÑ ÌïòÍ∏∞ Ïã´ÏùÑ Îïå Î≥¥ÌÜµ Ïñ¥Îñ§ Î≥ÄÎ™ÖÏùÑ Ìï¥Ïöî? (Ïòà: ÌîºÍ≥§Ìï¥Ïöî, Î∞îÎπ†Ïöî)", eng: "When you don't want to work, what excuses do you usually make? (e.g., I'm tired, I'm busy)", vocab: [ { term: "Î≥ÄÎ™Ö(ÏùÑ ÌïòÎã§)", meaning_eng: "To make an excuse" }, { term: "ÌîºÍ≥§ÌïòÎã§", meaning_eng: "To be tired" }, { term: "Î∞îÏÅòÎã§", meaning_eng: "To be busy" } ] },
                { num: 7, kor: "Ïö∞ÎîîÎäî 'Ïñ¥ÎñªÍ≤å Ïïà Ïâ¨Í≥† ÏùºÏùÑ Ìï¥Ïöî?'ÎùºÍ≥† Î¨ºÏóàÏñ¥Ïöî. Ïó¨Îü¨Î∂ÑÏóêÍ≤å ÏùºÍ≥º Ìú¥Ïãù Ï§ëÏóê Î¨¥ÏóáÏù¥ Îçî Ï§ëÏöîÌï¥Ïöî?", eng: "Woody asked, 'How can you work without resting?' What is more important to you: work or rest?", vocab: [ { term: "Ïâ¨Îã§", meaning_eng: "To rest" }, { term: "Ìú¥Ïãù", meaning_eng: "Rest; break" }, { term: "Ï§ëÏöîÌïòÎã§", meaning_eng: "To be important" } ] },
                { num: 8, kor: "ÎèôÎ£åÍ∞Ä ÏïºÍ∑ºÌï† Îïå, Ïú†ÎÇòÏ≤òÎüº ÎèÑÏôÄÏ§Ñ Í±∞ÏòàÏöî? ÏïÑÎãàÎ©¥ Î®ºÏ†Ä Ìá¥Í∑ºÌï† Í±∞ÏòàÏöî?", eng: "When your colleague works overtime, will you help them like Yuna? Or will you leave work first?", vocab: [ { term: "ÎèôÎ£å", meaning_eng: "Colleague" }, { term: "ÏïºÍ∑ºÌïòÎã§", meaning_eng: "To work overtime" }, { term: "ÎèÑÏôÄÏ£ºÎã§", meaning_eng: "To help" }, { term: "Î®ºÏ†Ä Ìá¥Í∑ºÌïòÎã§", meaning_eng: "To leave work first" } ] },
                { num: 9, kor: "ÌöåÏÇ¨ÏóêÏÑú ÏûòÎ¶¥Íπå Î¥ê Í±±Ï†ïÌï¥ Î≥∏ Ï†ÅÏù¥ ÏûàÏñ¥Ïöî? Ïñ¥Îñ§ ÏÉÅÌô©Ïù¥ÏóàÏñ¥Ïöî?", eng: "Have you ever worried about being fired from work? What was the situation?", vocab: [ { term: "ÏûòÎ¶¨Îã§", meaning_eng: "To be fired" }, { term: "-„ÑπÍπå Î¥ê Í±±Ï†ïÌïòÎã§", meaning_eng: "To worry that... might happen" }, { term: "ÏÉÅÌô©", meaning_eng: "Situation" } ] },
                { num: 10, kor: "ÎÇ¥ÏùºÏù¥ÎÇò Î™®Î†àÎ°ú Í≥ÑÏÜç ÏùºÏùÑ ÎØ∏Î£®Í≤å Îê† Í≤É Í∞ôÏùÑ Îïå, Ïñ¥ÎñªÍ≤å ÌïòÎ©¥ ÏùºÏùÑ ÏãúÏûëÌï† Ïàò ÏûàÏùÑÍπåÏöî?", eng: "When you feel like you'll keep procrastinating until tomorrow or the day after, how do you get yourself to start?", vocab: [ { term: "Î™®Î†à", meaning_eng: "The day after tomorrow" }, { term: "Í≥ÑÏÜç", meaning_eng: "Continuously" }, { term: "ÎØ∏Î£®Îã§", meaning_eng: "To procrastinate" }, { term: "ÏãúÏûëÌïòÎã§", meaning_eng: "To start" }, { term: "-Í≤å ÎêòÎã§", meaning_eng: "to end up (doing); to get to (do)" }, { term: "Ïñ¥ÎñªÍ≤å ÌïòÎ©¥", meaning_eng: "How can I...; What should I do to..." } ] }
                ];
                return { scriptContent, vocabAndGrammarList, sentences, discussionQuestions };
            }, []);

            const { vocabMap, highlightData } = useMemo(() => {
                const vocabMap = new Map(vocabAndGrammarList.map(item => [item.term, item]));
                const wordMap = new Map();
                vocabAndGrammarList.forEach(item => wordMap.set(item.term, item));
                const allWords = Array.from(wordMap.keys()).sort((a, b) => b.length - a.length);
                const regexParts = [];
                allWords.forEach(word => {
                    const item = wordMap.get(word);
                    if (item.variants) item.variants.forEach(v => regexParts.push(v.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')));
                    let processed = word.replace(/[.*+?^${}()|[\]\\]/g, '\\$&').replace(/\s+/g, '\\s*');
                    if (word.endsWith('Îã§')) {
                        const parts = word.split(' ');
                        const lastPart = parts[parts.length - 1];
                        if (lastPart.endsWith('Îã§')) {
                            const stem = lastPart.slice(0, -1).replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
                            const firstParts = parts.slice(0, -1).map(p => p.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'));
                            regexParts.push([...firstParts, `${stem}[Í∞Ä-Ìû£]*`].join('\\s*'));
                        } else { regexParts.push(`${processed.slice(0, -1)}[Í∞Ä-Ìû£]*`); }
                    } else { regexParts.push(processed); }
                });
                const regexString = [...new Set(regexParts)].sort((a,b) => b.length - a.length).join('|');
                return { vocabMap, highlightData: { regex: new RegExp(`(${regexString})`, 'g'), wordMap, sortedWords: allWords }};
            }, [vocabAndGrammarList]);

            const tabs = useMemo(() => {
                const baseTabs = [
                    { name_kor: 'ÎåÄÌôî Ïä§ÌÅ¨Î¶ΩÌä∏', name_eng: '(Transcript)', icon: <Video className="w-6 h-6"/>, content: <VideoMaterialsTab scriptContent={scriptContent} vocabAndGrammarList={vocabAndGrammarList} highlightData={highlightData} vocabMap={vocabMap} /> },
                    { name_kor: 'ÌïµÏã¨ Ïñ¥Ìúò', name_eng: '(Key Vocabulary)', icon: <List className="w-6 h-6"/>, content: (
                        <div>
                            <h2 className="text-3xl font-extrabold text-gray-900 mb-8 flex items-center gap-3"><List className="w-8 h-8 text-green-600"/> ÌïµÏã¨ Ïñ¥Ìúò (Key Vocabulary)</h2>
                            <div className="w-full overflow-y-auto" style={{maxHeight: `calc(100vh - 150px)`}}>
                                <div className="border rounded-lg bg-white p-2 shadow-lg">
                                    <div className="space-y-1">{vocabAndGrammarList.map(item => <VocabItem key={item.term} item={item} />)}</div>
                                </div>
                            </div>
                        </div>
                    )},
                    { name_kor: 'ÎÇ¥Ïö© ÌôïÏù∏ ÌÄ¥Ï¶à', name_eng: '(Comprehension Check-Up)', icon: <BookOpen className="w-6 h-6"/>, content: (
                        <div>
                            <h2 className="text-3xl font-extrabold text-gray-900 mb-8 flex items-center gap-3"><BookOpen className="w-8 h-8 text-green-600"/> ÎÇ¥Ïö© ÌôïÏù∏ ÌÄ¥Ï¶à (Comprehension Check-Up)</h2>
                            <ComprehensionQuiz sentences={sentences} />
                        </div>
                    )},
                    { name_kor: 'ÏÉùÍ∞ÅÌï¥ Î≥¥Í∏∞', name_eng: '(Food For Thought)', icon: <MessageSquare className="w-6 h-6"/>, content: (
                        <div>
                            <h2 className="text-3xl font-extrabold text-gray-900 mb-8 flex items-center gap-3"><MessageSquare className="w-8 h-8 text-green-600"/> ÏÉùÍ∞ÅÌï¥ Î≥¥Í∏∞ (Food For Thought)</h2>
                            <DiscussionSection questions={discussionQuestions} />
                        </div>
                    ) }
                ];
                return baseTabs;
            }, [layoutMode, scriptContent, vocabAndGrammarList, sentences, discussionQuestions, highlightData, vocabMap]);

            return (
                <div className="bg-gray-50 text-gray-800 p-4 sm:p-6 md:p-8">
                    <div className="mx-auto transition-all duration-300" style={{ maxWidth: containerWidth }}>
                        <header className="text-center mb-12">
                            <h1 className="text-4xl md:text-5xl font-black text-gray-900 mb-2">Ïò§Îäò ÏùºÏùÑ Îã§ Î™ªÌñàÏñ¥Ïöî</h1>
                            <p className="text-xl text-gray-500" style={{fontFamily: "'Nanum Gothic', sans-serif"}}>I couldn't finish all my work today: Should I work late or work tomorrow?</p>
                        </header>
                        <Tabs tabs={tabs} />
                        {layoutMode === 'mobile' && (
                            <div className="pt-10">
                                <h2 className="text-3xl font-extrabold text-gray-900 mb-8 flex items-center gap-3"><List className="w-8 h-8 text-green-600"/> ÌïµÏã¨ Ïñ¥Ìúò (Key Vocabulary)</h2>
                                <div className="w-full">
                                    <div className="border rounded-lg bg-white p-2 shadow-lg">
                                        <div className="space-y-1">{vocabAndGrammarList.map(item => <VocabItem key={item.term} item={item} />)}</div>
                                    </div>
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        };
    
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
