<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OpenKorean - ì‹ë‹¹: ìŒì‹ì´ ì˜ëª» ë‚˜ì™”ì„ ë•Œ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://www.youtube.com/iframe_api"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- í°íŠ¸ ë§í¬: IBM Plex Sans KR, Jua, Noto Sans KR, Sunflower -->
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+KR:wght@400;500;600;700&family=Jua&family=Noto+Sans+KR:wght@400;500;700;900&family=Sunflower:wght@300;500;700&display=swap" rel="stylesheet">
    <style>
        /* ê¸°ë³¸ ê¸€ê¼´ ì„¤ì •: IBM Plex Sans KR */
        body { font-family: 'IBM Plex Sans KR', sans-serif; background-color: #f9fafb; }
        
        /* ì‚¬ìš©ì ì§€ì • í°íŠ¸ ìœ í‹¸ë¦¬í‹° í´ë˜ìŠ¤ */
        .font-jua { font-family: 'Jua', sans-serif; }
        .font-noto { font-family: 'Noto Sans KR', sans-serif; }
        .font-sunflower { font-family: 'Sunflower', sans-serif; }
        
        /* ìŠ¤í¬ë¡¤ë°” ì»¤ìŠ¤í…€ */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        /* ì• ë‹ˆë©”ì´ì…˜ */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .animate-fade-in { animation: fadeIn 0.3s ease-out forwards; }

        /* Range Slider Custom Style */
        input[type=range] {
            -webkit-appearance: none;
            background: transparent;
        }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 16px;
            width: 16px;
            border-radius: 50%;
            background: #22c55e;
            cursor: pointer;
            margin-top: -6px;
            border: 2px solid white;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%;
            height: 4px;
            cursor: pointer;
            background: #e2e8f0;
            border-radius: 2px;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useMemo, useCallback } = React;
        const { createPortal } = ReactDOM;

        // --- Data: Level Definitions & Styles ---
        const LEVEL_DEFINITIONS = {
            "A1": { title: "Novice", desc: "Can use and understand very simple everyday expressions. Can introduce themselves, ask and answer basic questions (name, age, where they live, etc.)." },
            "A1+": { title: "Pre-Beginner", desc: "Still beginner, but can handle slightly more than A1: simple short conversations about familiar topics if the other person speaks slowly and clearly." },
            "A2": { title: "Beginner", desc: "Can understand frequently used sentences (family, shopping, work, hobbies). Can handle simple routine tasks and short social exchanges." },
            "A2+": { title: "Upper Beginner", desc: "Between A2 and B1. Can speak a bit more smoothly about daily life, give simple opinions, and manage short conversations with some support." },
            "B1": { title: "Pre-Intermediate", desc: "Can understand the main points of clear standard speech or texts on familiar topics (school, work, leisure). Can describe experiences, plans, and briefly explain opinions." },
            "B1+": { title: "Lower Intermediate", desc: "Stronger B1. More comfortable carrying conversations, handling some unexpected situations, and linking ideas more coherently, but still with gaps." },
            "B2": { title: "Intermediate", desc: "Can understand the main ideas of complex texts, interact quite fluently with natives, and produce clear, detailed speech and writing on many topics." },
            "B2+": { title: "Upper Intermediate", desc: "Near C1. Can argue a point logically, follow more abstract discussions, and use a wide range of vocabulary with fewer mistakes, though not fully â€œadvancedâ€." },
            "C1": { title: "Advanced", desc: "Can understand long, demanding texts and implied meanings; express ideas fluently and spontaneously; use language flexibly in academic, professional, and social settings." },
            "C1+": { title: "Upper Advanced", desc: "Very strong C1, approaching native-like flexibility. Still occasional non-native patterns, but can operate comfortably in almost all situations." },
            "C2": { title: "Proficient", desc: "Can understand virtually everything heard or read; express themselves very precisely, subtly, and naturally, even in complex, nuanced situations." }
        };

        const LEVEL_STYLES = {
            "A1": "bg-orange-50 text-orange-600 border-orange-100", 
            "A1+": "bg-orange-50 text-orange-600 border-orange-100", 
            "A2": "bg-green-50 text-green-600 border-green-100",    
            "A2+": "bg-green-50 text-green-600 border-green-100",    
            "B1": "bg-blue-50 text-blue-600 border-blue-100",       
            "B1+": "bg-blue-50 text-blue-600 border-blue-100",       
            "B2": "bg-purple-50 text-purple-600 border-purple-100", 
            "B2+": "bg-purple-50 text-purple-600 border-purple-100", 
            "C1": "bg-fuchsia-50 text-fuchsia-700 border-fuchsia-100", 
            "C1+": "bg-fuchsia-50 text-fuchsia-700 border-fuchsia-100", 
            "C2": "bg-red-50 text-red-600 border-red-100",        
        };

        // --- Icons ---
        const HomeIcon = ({ className }) => (<svg viewBox="0 0 24 24" fill="currentColor" className={className}><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg>);
        const DashboardIcon = ({ className }) => (<svg viewBox="0 0 24 24" fill="currentColor" className={className}><path d="M4 11h5V5H4v6zm0 7h5v-6H4v6zm6 0h5v-6h-5v6zm6 0h5v-6h-5v6zm-6-7h5V5h-5v6zm6-6v6h5V5h-5z"/></svg>);
        const LearnIcon = ({ className }) => (<svg viewBox="0 0 24 24" fill="currentColor" className={className}><path d="M21.582,6.186c-0.23-0.86-0.908-1.538-1.768-1.768C18.254,4,12,4,12,4S5.746,4,4.186,4.418 c-0.86,0.23-1.538,0.908-1.768,1.768C2,7.746,2,12,2,12s0,4.254,0.418,5.814c0.23,0.86,0.908,1.538,1.768,1.768 C5.746,20,12,20,12,20s6.254,0,7.814-0.418c0.861-0.23,1.538-0.908,1.768-1.768C22,16.254,22,12,22,12S22,7.746,21.582,6.186z M10,15.464V8.536L16,12L10,15.464z"/></svg>);
        const VocabIcon = ({ className }) => (<svg viewBox="0 0 24 24" fill="currentColor" className={className}><rect x="3" y="6" width="13" height="15" rx="2" transform="rotate(-8 9.5 13.5)" opacity="0.5" /><rect x="8" y="3" width="13" height="15" rx="2" transform="rotate(4 14.5 10.5)" /><circle cx="10.5" cy="6.5" r="1.2" fill="white" /></svg>);
        const QuizIcon = ({ className }) => (<svg viewBox="0 0 24 24" fill="currentColor" className={className}><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-2h2v2zm2.07-7.75l-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25z"/></svg>);
        const DiscussIcon = ({ className }) => (<svg viewBox="0 0 24 24" fill="currentColor" className={className}><path d="M20 2H8C6.9 2 6 2.9 6 4V16C6 17.1 6.9 18 8 18H18L22 22V4C22 2.9 21.1 2 20 2ZM19 14H9V6H19V14Z"/><path d="M4 6H2V20C2 21.1 2.9 22 4 22H18V20H4V6Z"/></svg>);
        const UserIcon = ({ className }) => (<svg viewBox="0 0 24 24" fill="currentColor" className={className}><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>);
        const QuizHeaderIcon = ({ className }) => (<svg viewBox="0 0 48 48" fill="none" className={className}><rect x="8" y="14" width="28" height="28" rx="4" stroke="#7C3AED" strokeWidth="4"/><rect x="14" y="6" width="28" height="28" rx="4" fill="#8B5CF6"/><path d="M28 14C30.2 14 32 15.8 32 18C32 20.2 30.2 22 28 22C26.8 22 26 22.8 26 24V25" stroke="white" strokeWidth="3" strokeLinecap="round"/><circle cx="26" cy="29" r="2" fill="white"/></svg>);
        const VocabHeaderIcon = ({ className }) => (<svg viewBox="0 0 48 48" fill="none" className={className} xmlns="http://www.w3.org/2000/svg"><path d="M24 10C24 10 34 11 40 10V38C34 39 24 38 24 38V10Z" fill="#43A047"/><path d="M24 10C24 10 14 11 8 10V38C14 39 24 38 24 38V10Z" fill="#2E7D32"/><path d="M12 16H20" stroke="white" strokeWidth="3" strokeLinecap="round"/><path d="M12 22H20" stroke="white" strokeWidth="3" strokeLinecap="round"/><path d="M12 28H20" stroke="white" strokeWidth="3" strokeLinecap="round"/><path d="M12 34H17" stroke="white" strokeWidth="3" strokeLinecap="round"/><path d="M28 16H36" stroke="white" strokeWidth="3" strokeLinecap="round"/><path d="M28 22H36" stroke="white" strokeWidth="3" strokeLinecap="round"/><path d="M28 28H36" stroke="white" strokeWidth="3" strokeLinecap="round"/><path d="M28 34H33" stroke="white" strokeWidth="3" strokeLinecap="round"/></svg>);
        const DiscussHeaderIcon = ({ className }) => (<svg viewBox="0 0 48 48" fill="none" className={className} xmlns="http://www.w3.org/2000/svg"><path d="M18 10H38C39.1 10 40 10.9 40 12V32C40 33.1 39.1 34 38 34H34V38L30 34H18C16.9 34 16 33.1 16 32V28" stroke="#3B82F6" strokeWidth="4" strokeLinecap="round" strokeLinejoin="round"/><path d="M8 16H28C29.1 16 30 16.9 30 18V30C30 31.1 29.1 32 28 32H16L12 36V32H8C6.9 32 6 31.1 6 30V18C6 16.9 6.9 16 8 16Z" fill="#3B82F6"/><path d="M10 22H26" stroke="white" strokeWidth="2" strokeLinecap="round" opacity="0.3"/></svg>);
        const LineIcon = ({ d, className }) => (<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d={d} /></svg>);
        const PlayIconLine = (props) => <LineIcon {...props} d="M5 3l14 9-14 9V3z" />;
        const OpenBookSolidIcon = ({ className }) => (<svg viewBox="0 0 24 24" fill="currentColor" className={className}><path d="M21 5c-1.11-.35-2.33-.5-3.5-.5-1.95 0-4.05.4-5.5 1.5-1.45-1.1-3.55-1.5-5.5-1.5S2.45 4.9 1 6v14.65c0 .25.25.5.5.5.1 0 .15-.05.25-.05C3.1 20.45 5.05 20 6.5 20c1.95 0 4.05.4 5.5 1.5 1.35-.85 3.8-1.5 5.5-1.5 1.65 0 3.35.3 4.75 1.05.1.05.15.05.25.05.25 0 .5-.25.5-.5V6c-.6-.45-1.25-.75-2-1z" /></svg>);
        const TranslateIcon = (props) => <LineIcon {...props} d="M5 8l6 6M4 14l6-6 2-3M2 5h12M7 2h1" />;
        const ChevronLeft = ({ className }) => <LineIcon d="m15 18-6-6 6-6" className={className}/>;
        const ChevronRight = ({ className }) => <LineIcon d="m9 18 6-6-6-6" className={className}/>;
        const SpeedSolidIcon = ({ className }) => (<svg viewBox="0 0 24 24" fill="currentColor" className={className}><path d="M20.38 8.57l-1.23 1.85a8 8 0 0 1-.22 7.58H5.07A8 8 0 0 1 15.58 6.85l1.85-1.23A10 10 0 0 0 3.35 19a2 2 0 0 0 1.72 1h13.85a2 2 0 0 0 1.74-1 10 10 0 0 0-.27-10.44z"/><path d="M10.59 15.41a2 2 0 0 0 2.83 0l5.66-8.49-8.49 5.66a2 2 0 0 0 0 2.83z"/></svg>);
        const SparklesIcon = ({ className }) => (<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" className={className}><path d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.894 20.567L16.5 21.75l-.394-1.183a2.25 2.25 0 00-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 001.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 001.423 1.423l1.183.394-1.183.394a2.25 2.25 0 00-1.423 1.423z" /></svg>);

        // --- Component: Level Badge ---
        const LevelBadge = ({ levelCode }) => {
            const [isHovered, setIsHovered] = useState(false);
            const info = LEVEL_DEFINITIONS[levelCode] || LEVEL_DEFINITIONS["A2+"];
            
            const getLevelStyle = (code) => {
                if (LEVEL_STYLES[code]) return LEVEL_STYLES[code];
                const base = code.substring(0, 2);
                return LEVEL_STYLES[base] || "bg-gray-50 text-gray-600 border-gray-100";
            };
            
            const badgeStyle = getLevelStyle(levelCode);

            return (
                <div 
                    className="relative inline-flex items-center cursor-help z-50"
                    onMouseEnter={() => setIsHovered(true)}
                    onMouseLeave={() => setIsHovered(false)}
                >
                    <span className={`px-2 py-0.5 rounded text-[10px] font-bold border uppercase tracking-wide shadow-sm font-sunflower ${badgeStyle}`}>
                        Level: {info.title}
                    </span>
                    {isHovered && (
                        <div className="absolute top-full left-0 mt-2 w-64 bg-gray-900/95 backdrop-blur text-white text-xs rounded-xl p-4 shadow-xl z-[100] animate-fade-in text-left">
                            <p className={`font-bold mb-1.5 text-sm ${badgeStyle.split(' ')[1]}`}>{levelCode} â€“ {info.title}</p>
                            <p className="opacity-90 leading-relaxed font-medium">{info.desc}</p>
                            <div className="absolute -top-1 left-4 w-2 h-2 bg-gray-900/95 rotate-45"></div>
                        </div>
                    )}
                </div>
            );
        };

        const VOCAB_DATA = [
            {
                term: 'ì´ ì£¼ì œë¡œ ì´ì•¼ê¸°í•´ ë´ìš”',
                mainDef: "Let's Talk About This Topic",
                examples: [],
                subDefs: [
                    { subTerm: 'â–¢â–¢ì„/ë¥¼ ì£¼ì œë¡œ ì´ì•¼ê¸°í•˜ë‹¤', subDef: 'to talk about [something] as a topic' },
                    { subTerm: '-ì•„/ì–´ ë³´ë‹¤', subDef: 'used to make gentle suggestions without sounding pushy' }
                ]
            },
            {
                term: 'ë°°ê³ í”„ë‹¤',
                mainDef: 'to be hungry',
                examples: [],
                subDefs: []
            },
            {
                term: '-ëŠ” ëœ»ì´ì—ìš”',
                mainDef: '"It means thatâ€¦"',
                examples: [],
                subDefs: [
                    { subTerm: 'Usage', subDef: 'used to state the meaning of a word or phrase' }
                ]
            },
            {
                term: 'ë¨¹ê³  ì‹¶ë‹¤',
                mainDef: 'to want to eat',
                examples: [],
                subDefs: [
                    { subTerm: 'ë¨¹ë‹¤', subDef: 'to eat' },
                    { subTerm: '-ê³  ì‹¶ë‹¤', subDef: '"want toâ€¦"' }
                ]
            },
            {
                term: 'ì§œì¥ë©´',
                mainDef: 'Jajangmyeon (noodles in black bean sauce)',
                examples: [],
                subDefs: []
            },
            {
                term: 'ì¢‹ì€ ìƒê°',
                mainDef: 'good idea',
                examples: [],
                subDefs: [
                    { subTerm: 'ì¢‹ì€', subDef: 'good' },
                    { subTerm: 'ìƒê°', subDef: 'idea' }
                ]
            },
            {
                term: 'ë§¤ìš´',
                mainDef: 'spicy',
                examples: [],
                subDefs: []
            },
            {
                term: 'ì§¬ë½•',
                mainDef: 'Jjamppong (spicy seafood noodle soup)',
                examples: [],
                subDefs: []
            },
            {
                term: 'ë¨¹ì„ë˜ìš”',
                mainDef: 'I will eat / I want to eat',
                examples: [],
                subDefs: [
                    { subTerm: 'ë¨¹ë‹¤', subDef: 'to eat' },
                    { subTerm: '-ë˜ìš”/ì„ë˜ìš”', subDef: '"will/want toâ€¦"' }
                ]
            },
            {
                term: 'ì£¼ë¬¸í•˜ë‹¤',
                mainDef: 'to order',
                examples: [],
                subDefs: []
            },
            {
                term: 'â€˜ìŒì‹ ì£¼ì„¸ìš”â€™ë¼ê³  ë§í•˜ëŠ” ê±°ì˜ˆìš”.',
                mainDef: 'It means to say "Food, please."',
                examples: [],
                subDefs: [
                    { subTerm: '-ë¼ê³  ë§í•˜ë‹¤', subDef: 'to say thatâ€¦' },
                    { subTerm: '-ëŠ” ê²ƒì´ë‹¤', subDef: 'used to state or explain a fact or essence...' }
                ]
            },
            {
                term: 'ì‚¬ì¥ë‹˜',
                mainDef: 'owner (of a restaurant/store)',
                examples: [],
                subDefs: []
            },
            {
                term: 'ë¹¨ë¦¬ ë‚˜ì˜¤ë©´ ì¢‹ê² ì–´ìš”.',
                mainDef: 'I hope it comes out quickly',
                examples: [],
                subDefs: [
                    { subTerm: 'ë¹¨ë¦¬', subDef: 'quickly' },
                    { subTerm: 'ë‚˜ì˜¤ë‹¤', subDef: 'to come out' },
                    { subTerm: '-ë©´ ì¢‹ê² ì–´ìš”', subDef: '"I hope/wish thatâ€¦"' }
                ]
            },
            {
                term: 'ë‚˜ì˜¤ë‹¤',
                mainDef: 'to come out',
                examples: [],
                subDefs: []
            },
            {
                term: 'ì˜ ë¨¹ê² ìŠµë‹ˆë‹¤',
                mainDef: 'I will eat well',
                examples: [],
                subDefs: [
                    { subTerm: 'Culture', subDef: 'A common phrase said before eating to show gratitude for the meal.' }
                ]
            },
            {
                term: 'ë‘ ê°œë„¤ìš”',
                mainDef: "It's two items!",
                examples: [],
                subDefs: [
                    { subTerm: 'ë‘ ê°œ', subDef: 'two items' },
                    { subTerm: '-ë„¤ìš”', subDef: 'sentence ending expressing surprise or realization' }
                ]
            },
            {
                term: 'ê·¸ëŸ¬ë‹ˆê¹Œìš”',
                mainDef: 'I know, right? / Exactly',
                examples: [],
                subDefs: []
            },
            {
                term: 'ì„¸ìƒì—',
                mainDef: 'Oh my gosh / Oh my goodness',
                examples: [],
                subDefs: []
            },
            {
                term: 'ì˜ëª» ë‚˜ì˜¤ë‹¤',
                mainDef: 'to come out wrong (for an order)',
                examples: [],
                subDefs: [
                    { subTerm: 'ì˜ëª»', subDef: 'wrongly, incorrectly' },
                    { subTerm: 'ë‚˜ì˜¤ë‹¤', subDef: 'to come out' }
                ]
            },
            {
                term: 'ì£¼ë¬¸í•œ ìŒì‹ì´ ì•„ë‹ˆë‹¤',
                mainDef: "It's not the food I ordered",
                examples: [],
                subDefs: [
                    { subTerm: 'ì£¼ë¬¸í•˜ë‹¤', subDef: 'to order' },
                    { subTerm: '-ã„´/ì€', subDef: 'used to turn a past-tense verb into an "adjective-ish" phrase...' }
                ]
            },
            {
                term: '-ë¼ëŠ” ëœ»ì´ì—ìš”',
                mainDef: '"It means thatâ€¦"',
                examples: [],
                subDefs: [
                    { subTerm: 'Usage', subDef: 'used to state the meaning of a word or phrase' }
                ]
            },
            {
                term: 'ê°€ì„œ ë§í• ê²Œìš”.',
                mainDef: "I'll go and tell them",
                examples: [],
                subDefs: [
                    { subTerm: 'ê°€ë‹¤', subDef: 'to go' },
                    { subTerm: '-ì•„ì„œ/ì–´ì„œ', subDef: 'used when the first action is a necessary step...' },
                    { subTerm: 'ë§í•˜ë‹¤', subDef: 'to speak' },
                    { subTerm: '-ê²Œìš”', subDef: '"I willâ€¦"' }
                ]
            },
            {
                term: 'ì ê¹ë§Œìš”',
                mainDef: 'Wait a moment',
                examples: [],
                subDefs: []
            },
            {
                term: 'ì§¬ë½• ë¨¹ê³  ì‹¶ë‹¤ê³  í–ˆì–ì•„ìš”',
                mainDef: 'You said you wanted to eat Jjamppong!',
                examples: [],
                subDefs: [
                    { subTerm: 'ë¨¹ë‹¤', subDef: 'to eat' },
                    { subTerm: '-ê³  ì‹¶ë‹¤', subDef: '"want toâ€¦"' },
                    { subTerm: '-ë‹¤ê³  í•˜ë‹¤', subDef: 'used to quote what someone said' },
                    { subTerm: '-ì–ì•„ìš”', subDef: 'used to remind the listener of shared or obvious information...' }
                ]
            },
            {
                term: 'ì°¨ì´ê°€ ì—†ë‹¤',
                mainDef: 'There is no difference',
                examples: [],
                subDefs: [
                    { subTerm: 'ì°¨ì´', subDef: 'difference' }
                ]
            },
            {
                term: 'ë‘˜ ë‹¤',
                mainDef: 'both',
                examples: [],
                subDefs: []
            },
            {
                term: 'ë¬¸ì œ',
                mainDef: 'problem',
                examples: [],
                subDefs: []
            },
            {
                term: 'ëˆì„ ë‚´ë‹¤',
                mainDef: 'to pay money',
                examples: [],
                subDefs: []
            },
            {
                term: 'ì£¼ë¬¸í•œ ìŒì‹ì´ ë¨¹ëŠ” ê±´',
                mainDef: 'eating the food that was ordered',
                examples: [],
                subDefs: [
                    { subTerm: 'ì£¼ë¬¸í•˜ë‹¤', subDef: 'to order' },
                    { subTerm: '-ã„´/ì€', subDef: 'used to turn a past-tense verb into an "adjective-ish" phrase...' },
                    { subTerm: 'ë¨¹ë‹¤', subDef: 'to eat' },
                    { subTerm: '-ëŠ” ê±´', subDef: 'A colloquial form of -ã„´/ì€ ê²ƒì€, used to nominalize verbs...' }
                ]
            },
            {
                term: 'ê¶Œë¦¬',
                mainDef: 'a right',
                examples: [],
                subDefs: []
            },
            {
                term: 'ë‚´ê°€ ë°›ì•„ì•¼ í•˜ëŠ” ê²ƒ',
                mainDef: 'the thing I must receive',
                examples: [],
                subDefs: [
                    { subTerm: 'ë°›ë‹¤', subDef: 'to receive' },
                    { subTerm: '-ì•¼ í•˜ë‹¤', subDef: '"have toâ€¦" or "mustâ€¦"; used to express necessity or obligation' },
                    { subTerm: '-ëŠ” ê²ƒ', subDef: 'used to nominalize verbs...' }
                ]
            },
            {
                term: 'ë‹¤ì‹œ ë§í•˜ëŠ” ê±´',
                mainDef: 'saying it again',
                examples: [],
                subDefs: [
                    { subTerm: 'ë‹¤ì‹œ', subDef: 'again' },
                    { subTerm: 'ë§í•˜ë‹¤', subDef: 'to speak' },
                    { subTerm: '-ëŠ” ê±´', subDef: 'A colloquial form of -ã„´/ì€ ê²ƒ...' }
                ]
            },
            {
                term: 'ê·€ì°®ë‹¤',
                mainDef: 'to be a hassle, to be bothersome',
                examples: [],
                subDefs: []
            },
            {
                term: 'ì•„ë¬´ê²ƒë„ ì•ˆ í•˜ê³  ì‹¶ë‹¤',
                mainDef: 'to not want to do anything',
                examples: [],
                subDefs: [
                    { subTerm: 'ì•„ë¬´ê²ƒë„', subDef: 'nothing' }
                ]
            },
            {
                term: 'ë‹¤ì‹œ ì£¼ë¬¸í•˜ëŠ” ê±´',
                mainDef: 'ordering again',
                examples: [],
                subDefs: [
                    { subTerm: 'ë‹¤ì‹œ', subDef: 'again' },
                    { subTerm: 'ì£¼ë¬¸í•˜ë‹¤', subDef: 'to order' },
                    { subTerm: '-ëŠ” ê±´', subDef: 'A colloquial form...' }
                ]
            },
            {
                term: 'ê°„ë‹¨í•˜ë‹¤',
                mainDef: 'to be simple, to be easy',
                examples: [],
                subDefs: []
            },
            {
                term: 'ì‰½ê²Œ',
                mainDef: 'easily',
                examples: [],
                subDefs: []
            },
            {
                term: 'ì§ì›',
                mainDef: 'staff, employee',
                examples: [],
                subDefs: []
            },
            {
                term: 'ê°€ì„œ',
                mainDef: 'go and then...',
                examples: [],
                subDefs: [
                    { subTerm: 'ê°€ë‹¤', subDef: 'to go' },
                    { subTerm: '-ì•„ì„œ/ì–´ì„œ', subDef: 'used when the first action is a necessary step...' }
                ]
            },
            {
                term: 'ë§í•˜ë©´ ë¼ìš”',
                mainDef: 'you just have to say...',
                examples: [],
                subDefs: [
                    { subTerm: 'ë§í•˜ë‹¤', subDef: 'to speak' },
                    { subTerm: '-ë©´ ë¼ìš”', subDef: '"all one has to do isâ€¦" or "it is okay ifâ€¦"' }
                ]
            },
            {
                term: 'ë³€í˜¸ì‚¬',
                mainDef: 'lawyer',
                examples: [],
                subDefs: []
            },
            {
                term: 'ê°™ë‹¤',
                mainDef: 'to be like, to seem',
                examples: [],
                subDefs: []
            },
            {
                term: 'ë§Œì•½ì—',
                mainDef: 'if, in case',
                examples: [],
                subDefs: []
            },
            {
                term: 'ë¹„ì‹¼',
                mainDef: 'expensive',
                examples: [],
                subDefs: [
                    { subTerm: 'ë¹„ì‹¸ë‹¤', subDef: 'to be expensive' },
                    { subTerm: '-ã„´/ì€', subDef: 'used to turn a descriptive verb...' }
                ]
            },
            {
                term: 'ì‹œì¼°ëŠ”ë°',
                mainDef: 'ordered, but...',
                examples: [],
                subDefs: [
                    { subTerm: 'ì‹œí‚¤ë‹¤', subDef: 'to order' },
                    { subTerm: '-ëŠ”ë°', subDef: 'provides background' }
                ]
            },
            {
                term: '-ê³  ë§í•  ê±°ì˜ˆìš”?',
                mainDef: 'Are you going to say that...?',
                examples: [],
                subDefs: []
            },
            {
                term: 'ë‹¤ë¥´ì£ ',
                mainDef: "It's different, of course",
                examples: [],
                subDefs: [
                    { subTerm: 'ë‹¤ë¥´ë‹¤', subDef: 'to be different' },
                    { subTerm: '-ì´ì£ /ì£ ', subDef: 'informal sentence ending used for confirmation or emphasis' }
                ]
            },
            {
                term: 'ê±°ë´ìš”',
                mainDef: 'See? I told you so.',
                examples: [],
                subDefs: []
            },
            {
                term: 'í•´ê²°í•˜ê³  ì˜¬ê²Œìš”',
                mainDef: "I'll solve it and come back",
                examples: [],
                subDefs: [
                    { subTerm: 'í•´ê²°í•˜ë‹¤', subDef: 'to solve' },
                    { subTerm: '-ê³ ', subDef: 'used to connect two verbs...' },
                    { subTerm: 'ì˜¤ë‹¤', subDef: 'to come' },
                    { subTerm: '-ê²Œìš”', subDef: '"I willâ€¦"' }
                ]
            },
            {
                term: 'í•´ê²°í•˜ë‹¤',
                mainDef: 'to solve',
                examples: [],
                subDefs: []
            },
            {
                term: 'ë¬¸ì œë¥¼ ëë‚´ë‹¤',
                mainDef: 'to finish the problem',
                examples: [],
                subDefs: [
                    { subTerm: 'ë¬¸ì œ', subDef: 'problem' },
                    { subTerm: 'ëë‚´ë‹¤', subDef: 'to finish' }
                ]
            },
            {
                term: 'ë§ì´ ë‹¤ ë§ë‹¤',
                mainDef: 'Everything you say is right.',
                examples: [],
                subDefs: [
                    { subTerm: 'ë§', subDef: 'words, speech' },
                    { subTerm: 'ë‹¤', subDef: 'all' },
                    { subTerm: 'ë§ë‹¤', subDef: 'to be correct' }
                ]
            },
            {
                term: 'ëŒ€ì‹ ',
                mainDef: 'instead, in place of',
                examples: [],
                subDefs: []
            },
            {
                term: 'ë°°ìš´ ë‹¨ì–´',
                mainDef: 'learned words/vocabulary',
                examples: [],
                subDefs: [
                    { subTerm: 'ë°°ìš°ë‹¤', subDef: 'to learn' },
                    { subTerm: '-ã„´/ì€', subDef: 'used to turn a past-tense verb into an "adjective-ish" phrase...' },
                    { subTerm: 'ë‹¨ì–´', subDef: 'word, vocabulary' }
                ]
            },
            {
                term: 'í™•ì¸í•´ ë³¼ê¹Œìš”?',
                mainDef: 'Shall we summarize?',
                examples: [],
                subDefs: [
                    { subTerm: 'í™•ì¸í•˜ë‹¤', subDef: 'to check, confirm' },
                    { subTerm: '-ì•„/ì–´ ë³¼ê¹Œìš”?', subDef: '"Shall weâ€¦?" "How aboutâ€¦?"; used to suggest trying something together' }
                ]
            },
            {
                term: 'ìŒì‹ì´ ì˜ëª» ë‚˜ì™”ì„ ë•Œ',
                mainDef: 'when the food comes out wrong',
                examples: [],
                subDefs: [
                    { subTerm: 'ì˜ëª» ë‚˜ì˜¤ë‹¤', subDef: 'to come out wrong' },
                    { subTerm: '-ã„¹/ì„ ë•Œ', subDef: '"whenâ€¦"' }
                ]
            },
            {
                term: 'ì—¬ê¸°ê¹Œì§€ì˜ˆìš”',
                mainDef: 'Should we stop here?',
                examples: [],
                subDefs: [
                    { subTerm: 'ì—¬ê¸°ê¹Œì§€ í•˜ë‹¤', subDef: 'to stop here, wrap something up' },
                    { subTerm: '-(ìœ¼)ã„¹ê¹Œìš”?', subDef: '"Shall weâ€¦?"' }
                ]
            },
            {
                term: 'ì¬ë¯¸ìˆëŠ” ì´ì•¼ê¸°',
                mainDef: 'an interesting story',
                examples: [],
                subDefs: [
                    { subTerm: 'ì¬ë¯¸ìˆë‹¤', subDef: 'be fun, interesting' },
                    { subTerm: '-ëŠ”', subDef: 'used to turn a present-tense verb into an â€œadjective-ishâ€ phrase...' }
                ]
            }
        ];
        
        const QUIZ_LIST = [
            {
                id: 1,
                questionKor: "ì™œ ì‹ë‹¹ì— ê°”ë‚˜ìš”?",
                questionEng: "Why did they go to the restaurant?",
                sentence_pre: "ë¯¼í˜¸ì™€ ì¡°ì´ëŠ” ",
                sentence_post: " ì‹ë‹¹ì— ê°”ì–´ìš”.",
                correct_word: "ë°°ê³ íŒŒì„œ",
                translation: "Minho and Joy went to the restaurant because they were hungry.",
                hint: "because they were hungry",
                options: [
                    { text: 'ë°°ê³ íŒŒì„œ', isCorrect: true, feedback: "The grammar pattern '-ì•„ì„œ/ì–´ì„œ' is used to show reason or cause. They went to the restaurant *because* they were hungry." },
                    { text: 'ë°°ê³ í”ˆë°', isCorrect: false, feedback: "'-(ìœ¼)ã„´ë°' provides background information." },
                    { text: 'ë°°ê³ í”„ê³ ', isCorrect: false, feedback: "'-ê³ ' connects two actions sequentially." },
                    { text: 'ë°°ê³ í”„ë©´', isCorrect: false, feedback: "'-(ìœ¼)ë©´' means 'if'." }
                ]
            },
            {
                id: 2,
                questionKor: "ë‘ ì‚¬ëŒì€ ë¬´ì—‡ì„ í–ˆë‚˜ìš”?",
                questionEng: "What did the two people do?",
                sentence_pre: "ë‘ ì‚¬ëŒì€ ì§œì¥ë©´ê³¼ ì§¬ë½•ì„ ",
                sentence_post: ".",
                correct_word: "ì£¼ë¬¸í–ˆì–´ìš”",
                translation: "The two people ordered Jajangmyeon and Jjamppong.",
                hint: "ordered",
                options: [
                    { text: 'ì£¼ë¬¸í–ˆì–´ìš”', isCorrect: true, feedback: "In the dialogue, they decide what to eat and then order. 'ì£¼ë¬¸í•˜ë‹¤' means 'to order'." },
                    { text: 'ë¨¹ì—ˆì–´ìš”', isCorrect: false, feedback: "'ë¨¹ë‹¤' means to eat. They haven't eaten yet." },
                    { text: 'ìƒ€ì–´ìš”', isCorrect: false, feedback: "'ì‚¬ë‹¤' means to buy. While related, 'order' is more specific in a restaurant context." },
                    { text: 'ë§Œë“¤ì—ˆì–´ìš”', isCorrect: false, feedback: "'ë§Œë“¤ë‹¤' means to make." }
                ]
            },
            {
                id: 3,
                questionKor: "ì£¼ë¬¸ í›„ì— ë¬´ìŠ¨ ì¼ì´ ìˆì—ˆë‚˜ìš”?",
                questionEng: "What happened after ordering?",
                sentence_pre: "ë¯¼í˜¸ëŠ” ì§¬ë½•ì„ ì‹œì¼°ê³  ì¡°ì´ëŠ” ì§œì¥ë©´ì„ ",
                sentence_post: " ì§œì¥ë©´ì´ ë‘ ê°œ ë‚˜ì™”ì–´ìš”.",
                correct_word: "ì£¼ë¬¸í–ˆëŠ”ë°",
                translation: "Minho ordered Jjamppong and Joy ordered Jajangmyeon, but two Jajangmyeons came out.",
                hint: "ordered, but",
                options: [
                    { text: 'ì£¼ë¬¸í–ˆëŠ”ë°', isCorrect: true, feedback: "The grammar pattern '-(ìœ¼)ã„´/ëŠ”ë°' is used to provide background information for the following clause, often with a sense of contrast. They ordered, *but* something unexpected happened." },
                    { text: 'ì£¼ë¬¸í•´ì„œ', isCorrect: false, feedback: "'-ì•„ì„œ/ì–´ì„œ' indicates a cause-and-effect relationship." },
                    { text: 'ì£¼ë¬¸í•˜ë‹ˆê¹Œ', isCorrect: false, feedback: "'-ìœ¼ë‹ˆê¹Œ' also indicates a reason, often one the listener is aware of." },
                    { text: 'ì£¼ë¬¸í•˜ê³ ', isCorrect: false, feedback: "'-ê³ ' simply connects two actions in sequence." }
                ]
            },
            {
                id: 4,
                questionKor: "ì¡°ì´ëŠ” ë­ë¼ê³  ë§í•˜ë ¤ê³  í–ˆë‚˜ìš”?",
                questionEng: "What was Joy going to say?",
                sentence_pre: "ì¡°ì´ëŠ” ì§ì›ì—ê²Œ â€œìŒì‹ì´ ",
                sentence_post: "â€ë¼ê³  ë§í•˜ë ¤ê³  í–ˆì–´ìš”.",
                correct_word: "ì˜ëª» ë‚˜ì™”ì–´ìš”",
                translation: "Joy was about to tell the staff, 'The food came out wrong'.",
                hint: "came out wrong",
                options: [
                    { text: 'ì˜ëª» ë‚˜ì™”ì–´ìš”', isCorrect: true, feedback: "This is the specific phrase Joy used in the dialogue to describe the situation. 'ì˜ëª» ë‚˜ì˜¤ë‹¤' is the set phrase for a wrong order." },
                    { text: 'ë‚˜ë¹ ìš”', isCorrect: false, feedback: "'ë‚˜ì˜ë‹¤' means 'bad'. The food might not be bad, just incorrect." },
                    { text: 'ë¨¹ì„ ìˆ˜ ì—†ì–´ìš”', isCorrect: false, feedback: "'ë¨¹ì„ ìˆ˜ ì—†ë‹¤' means 'cannot eat'. They can eat it, it's just not what they ordered." },
                    { text: 'ì´ìƒí•´ìš”', isCorrect: false, feedback: "'ì´ìƒí•˜ë‹¤' means 'strange'. While the situation is strange, 'ì˜ëª» ë‚˜ì™”ì–´ìš”' is more precise." }
                ]
            },
            {
                id: 5,
                questionKor: "ë¯¼í˜¸ëŠ” ì™œ ê·¸ëƒ¥ ë¨¹ìœ¼ë ¤ê³  í–ˆë‚˜ìš”?",
                questionEng: "Why did Minho try to just eat it?",
                sentence_pre: "í•˜ì§€ë§Œ ë¯¼í˜¸ëŠ” ë‹¤ì‹œ ì£¼ë¬¸í•˜ê¸° ",
                sentence_post: " ê·¸ëƒ¥ ë¨¹ìœ¼ë ¤ê³  í–ˆì–´ìš”.",
                correct_word: "ê·€ì°®ì•„ì„œ",
                translation: "But Minho tried to just eat it because reordering was bothersome.",
                hint: "because it was bothersome",
                options: [
                    { text: 'ê·€ì°®ì•„ì„œ', isCorrect: true, feedback: "Minho explicitly says it's 'ê·€ì°®ë‹¤' (bothersome) to reorder." },
                    { text: 'ë¬´ì„œì›Œì„œ', isCorrect: false, feedback: "'ë¬´ì„­ë‹¤' means 'scary'." },
                    { text: 'í˜ë“¤ì–´ì„œ', isCorrect: false, feedback: "'í˜ë“¤ë‹¤' means 'difficult' or 'tiring'." },
                    { text: 'ì–´ë ¤ì›Œì„œ', isCorrect: false, feedback: "'ì–´ë µë‹¤' means 'difficult'." }
                ]
            },
            {
                id: 6,
                questionKor: "ë¯¼í˜¸ëŠ” ë‘ ìŒì‹ì— ëŒ€í•´ ì–´ë–»ê²Œ ìƒê°í–ˆë‚˜ìš”?",
                questionEng: "What did Minho think about the two foods?",
                sentence_pre: "ë¯¼í˜¸ëŠ” â€œì§œì¥ë©´ê³¼ ì§¬ë½•ì€ ",
                sentence_post: "â€ê³  ë§í–ˆì§€ë§Œ, ì¡°ì´ëŠ” ê·¸ë ‡ê²Œ ìƒê°í•˜ì§€ ì•Šì•˜ì–´ìš”.",
                correct_word: "ì°¨ì´ê°€ ì—†ì–´ìš”",
                translation: "Minho said, 'There is no difference between Jajangmyeon and Jjamppong,' but Joy didn't think so.",
                hint: "there is no difference",
                options: [
                    { text: 'ì°¨ì´ê°€ ì—†ì–´ìš”', isCorrect: true, feedback: "This is the direct quote from Minho in the dialogue. 'ì°¨ì´ê°€ ì—†ë‹¤' means 'there is no difference'." },
                    { text: 'ì°¨ì´ê°€ ì»¤ìš”', isCorrect: false, feedback: "Means 'there is a big difference'." },
                    { text: 'ì°¨ì´ê°€ ìˆì–´ìš”', isCorrect: false, feedback: "Means 'there is a difference'." },
                    { text: 'ì°¨ì´ê°€ ë§ì•„ìš”', isCorrect: false, feedback: "Means 'there are many differences'." }
                ]
            },
            {
                id: 7,
                questionKor: "ì¡°ì´ëŠ” ì´ê²ƒì´ ë¬´ì—‡ì´ë¼ê³  í–ˆë‚˜ìš”?",
                questionEng: "What did Joy say this was?",
                sentence_pre: "ì¡°ì´ëŠ” â€œëˆì„ ëƒˆìœ¼ë‹ˆê¹Œ ë‹¤ì‹œ ì£¼ë¬¸í•˜ëŠ” ê²ƒì´ ",
                sentence_post: "ì˜ˆìš”â€ë¼ê³  ë§í–ˆì–´ìš”.",
                correct_word: "ê¶Œë¦¬",
                translation: "Joy said, 'Since we paid, reordering is our right'.",
                hint: "a right",
                options: [
                    { text: 'ê¶Œë¦¬', isCorrect: true, feedback: "Joy argues that it is their 'ê¶Œë¦¬' (right) to get the food they paid for." },
                    { text: 'ì°¨ì´', isCorrect: false, feedback: "'ì°¨ì´' means 'difference'." },
                    { text: 'ë¬¸ì œ', isCorrect: false, feedback: "'ë¬¸ì œ' means 'problem'." },
                    { text: 'ì˜ë¬´', isCorrect: false, feedback: "'ì˜ë¬´' means 'duty' or 'obligation'." }
                ]
            },
            {
                id: 8,
                questionKor: "ì¡°ì´ëŠ” ë‹¤ì‹œ ì£¼ë¬¸í•˜ëŠ” ê²ƒì— ëŒ€í•´ ì–´ë–»ê²Œ ë§í–ˆë‚˜ìš”?",
                questionEng: "What did Joy say about reordering?",
                sentence_pre: "ì¡°ì´ëŠ” â€œë‹¤ì‹œ ì£¼ë¬¸í•˜ëŠ” ê²ƒì´ ",
                sentence_post: "â€ë¼ê³  ë§í–ˆì–´ìš”.",
                correct_word: "ê°„ë‹¨í•´ìš”",
                translation: "Joy said, 'Reordering is simple'.",
                hint: "is simple",
                options: [
                    { text: 'ê°„ë‹¨í•´ìš”', isCorrect: true, feedback: "Joy's counter-argument to Minho's 'ê·€ì°®ë‹¤' is that it's 'ê°„ë‹¨í•˜ë‹¤' (simple)." },
                    { text: 'ë³µì¡í•´ìš”', isCorrect: false, feedback: "'ë³µì¡í•˜ë‹¤' means 'complicated', the opposite." },
                    { text: 'ê·€ì°®ì•„ìš”', isCorrect: false, feedback: "This is what Minho felt." },
                    { text: 'ë¶€ë„ëŸ¬ì›Œìš”', isCorrect: false, feedback: "'ë¶€ë„ëŸ½ë‹¤' means 'shy' or 'embarrassed'." }
                ]
            },
            {
                id: 9,
                questionKor: "ë¯¼í˜¸ëŠ” ë¬´ì—‡ì„ í•˜ê¸° ì‹«ì–´í–ˆë‚˜ìš”?",
                questionEng: "What did Minho not want to do?",
                sentence_pre: "í•˜ì§€ë§Œ ë¯¼í˜¸ëŠ” ì§ì›ì—ê²Œ ",
                sentence_post: " ë§í•˜ê¸° ì‹«ì—ˆì–´ìš”.",
                correct_word: "ê°€ì„œ",
                translation: "But Minho didn't want to go and talk to the staff.",
                hint: "to go and",
                options: [
                    { text: 'ê°€ì„œ', isCorrect: true, feedback: "The grammar pattern '-ì•„ì„œ/ì–´ì„œ' connects two actions that happen in sequence, where the first is a necessary step for the second. He has to *go* in order to *talk*." },
                    { text: 'ê°€ê³ ', isCorrect: false, feedback: "'-ê³ ' simply lists actions." },
                    { text: 'ê°€ë‹ˆê¹Œ', isCorrect: false, feedback: "'-ìœ¼ë‹ˆê¹Œ' means 'because he goes'." },
                    { text: 'ê°€ë©´', isCorrect: false, feedback: "'-ë©´' means 'if he goes'." }
                ]
            },
            {
                id: 10,
                questionKor: "ê²°êµ­ ì¡°ì´ê°€ ë¬´ì—‡ì„ í•  ê±´ê°€ìš”?",
                questionEng: "What will Joy do in the end?",
                sentence_pre: "ê·¸ë˜ì„œ ì¡°ì´ê°€ ë¯¼í˜¸ ëŒ€ì‹  ë¬¸ì œë¥¼ ",
                sentence_post: ".",
                correct_word: "í•´ê²°í•  ê±°ì˜ˆìš”",
                translation: "So Joy will solve the problem instead of Minho.",
                hint: "will solve",
                options: [
                    { text: 'í•´ê²°í•  ê±°ì˜ˆìš”', isCorrect: true, feedback: "Joy states her intention to 'í•´ê²°í•˜ë‹¤' (solve) the problem. '-(ìœ¼)ã„¹ ê±°ì˜ˆìš”' is the future tense." },
                    { text: 'ë§Œë“¤ ê±°ì˜ˆìš”', isCorrect: false, feedback: "'ë§Œë“¤ë‹¤' means 'to make'." },
                    { text: 'ì¼ìœ¼í‚¬ ê±°ì˜ˆìš”', isCorrect: false, feedback: "'ì¼ìœ¼í‚¤ë‹¤' means 'to cause' (a problem)." },
                    { text: 'ë¬¼ì–´ë³¼ ê±°ì˜ˆìš”', isCorrect: false, feedback: "'ë¬¼ì–´ë³´ë‹¤' means 'to ask'." }
                ]
            }
        ];

        const DISCUSS_DATA = [
            { 
                num: 1, 
                kor: "ì‹ë‹¹ì—ì„œ ìŒì‹ì´ ì˜ëª» ë‚˜ì˜¨ ì ì´ ìˆì–´ìš”? ê·¸ëƒ¥ ë¨¹ì—ˆì–´ìš”? ì•„ë‹ˆë©´ ë‹¤ì‹œ ì£¼ë¬¸ì„ í–ˆì–´ìš”?", 
                eng: "Have you ever had your food come out wrong at a restaurant? Did you just eat it? Or did you reorder?", 
                vocab: [{ term: "ì˜ëª» ë‚˜ì˜¤ë‹¤", meaning: "to come out wrong", context: "ì¡°ì´: ìŒì‹ì´ ì˜ëª» ë‚˜ì™”ë„¤ìš”.", context_eng: "Joy: The food came out wrong." }, { term: "ì£¼ë¬¸í•˜ë‹¤", meaning: "to order", context: "ì¡°ì´: ë‹¤ì‹œ ì£¼ë¬¸í•˜ëŠ” ê²ƒì€ ì•„ì£¼ ê°„ë‹¨í•´ìš”!", context_eng: "Joy: Re-ordering is very simple!" }] 
            },
            { 
                num: 2, 
                kor: "ì—¬ëŸ¬ë¶„ì´ í–„ë²„ê±°ë¥¼ ì£¼ë¬¸í–ˆëŠ”ë°, ì¹˜í‚¨ë²„ê±°ê°€ ë‚˜ì™”ì–´ìš”. ê°€ê²© ì°¨ì´ê°€ ì—†ì–´ìš”. ê·¸ëŸ¬ë©´, ê·¸ëƒ¥ ë¨¹ì„ ê±°ì˜ˆìš”? ë‹¤ì‹œ ì£¼ë¬¸í•  ê±°ì˜ˆìš”?", 
                eng: "You ordered a hamburger, but a chicken burger came out. There's no price difference. In that case, will you just eat it? Or will you reorder?", 
                vocab: [{ term: "ì£¼ë¬¸í•˜ë‹¤", meaning: "to order", context: "ì¡°ì´: ë‹¤ì‹œ ì£¼ë¬¸í•˜ëŠ” ê²ƒì€ ì•„ì£¼ ê°„ë‹¨í•´ìš”!", context_eng: "Joy: Re-ordering is very simple!" }, { term: "ì°¨ì´ê°€ ì—†ë‹¤", meaning: "there is no difference", context: "ë¯¼í˜¸: ì§œì¥ë©´ì´ë‘ ì§¬ë½•ì€ í° ì°¨ì´ê°€ ì—†ì–´ìš”.", context_eng: "Minho: There's not a big difference between Jajangmyeon and Jjamppong." }] 
            },
            { 
                num: 3, 
                kor: "ì—¬ëŸ¬ë¶„ì´ ìŠ¤í…Œì´í¬ë¥¼ ì£¼ë¬¸í–ˆëŠ”ë°, í–„ë²„ê±°ê°€ ë‚˜ì™”ì–´ìš”. ê·¸ëŸ¬ë©´, ê·¸ëƒ¥ ë¨¹ì„ ê±°ì˜ˆìš”? ë‹¤ì‹œ ì£¼ë¬¸í•  ê±°ì˜ˆìš”?", 
                eng: "You ordered a steak, but a hamburger came out. In that case, will you just eat it? Or will you reorder?", 
                vocab: [{ term: "ì£¼ë¬¸í•˜ë‹¤", meaning: "to order", context: "ì¡°ì´: ë‹¤ì‹œ ì£¼ë¬¸í•˜ëŠ” ê²ƒì€ ì•„ì£¼ ê°„ë‹¨í•´ìš”!", context_eng: "Joy: Re-ordering is very simple!" }] 
            },
            { 
                num: 4, 
                kor: "ì—¬ëŸ¬ë¶„ì´ ë ˆì–´ ìŠ¤í…Œì´í¬ë¥¼ ì£¼ë¬¸í–ˆëŠ”ë°, ë¯¸ë””ì›€ ìŠ¤í…Œì´í¬ê°€ ë‚˜ì™”ì–´ìš”. ê·¸ëƒ¥ ë¨¹ì„ ê±°ì˜ˆìš”? ë‹¤ì‹œ ì£¼ë¬¸í•  ê±°ì˜ˆìš”?", 
                eng: "You ordered a rare steak, but a medium steak came out. Will you just eat it? Or will you reorder?", 
                vocab: [{ term: "ì£¼ë¬¸í•˜ë‹¤", meaning: "to order", context: "ì¡°ì´: ë‹¤ì‹œ ì£¼ë¬¸í•˜ëŠ” ê²ƒì€ ì•„ì£¼ ê°„ë‹¨í•´ìš”!", context_eng: "Joy: Re-ordering is very simple!" }] 
            },
            { 
                num: 5, 
                kor: "ì—¬ëŸ¬ë¶„ì´ ë„ˆë¬´ ë°°ê³ í”Œ ë•Œ, ìŒì‹ì´ ì˜ëª» ë‚˜ì˜¤ë©´, ê·¸ëƒ¥ ë¨¹ì„ ê±°ì˜ˆìš”? ë‹¤ì‹œ ì£¼ë¬¸í•  ê±°ì˜ˆìš”?", 
                eng: "When you are very hungry and the food comes out wrong, will you just eat it? Or will you reorder?", 
                vocab: [{ term: "ë°°ê³ í”„ë‹¤", meaning: "to be hungry", context: "ë¯¼í˜¸: ì¡°ì´ ì”¨, ì˜¤ëŠ˜ ì € ì§„ì§œ ë°°ê³ íŒŒìš”.", context_eng: "Joy, I'm really hungry today." }, { term: "ì˜ëª» ë‚˜ì˜¤ë‹¤", meaning: "to come out wrong", context: "ì¡°ì´: ìŒì‹ì´ ì˜ëª» ë‚˜ì™”ë„¤ìš”.", context_eng: "Joy: The food came out wrong." }] 
            },
            { 
                num: 6, 
                kor: "ì—¬ëŸ¬ë¶„ì€ ìŒì‹ì´ ì˜ëª» ë‚˜ì™”ì„ ë•Œ, ê·€ì°®ì•„ì„œ ë‹¤ì‹œ ë§ ì•ˆ í•œ ì ì´ ìˆì–´ìš”?", 
                eng: "Have you ever not said anything because you were bothered when your food came out wrong?", 
                vocab: [{ term: "ì˜ëª» ë‚˜ì˜¤ë‹¤", meaning: "to come out wrong", context: "ì¡°ì´: ìŒì‹ì´ ì˜ëª» ë‚˜ì™”ë„¤ìš”.", context_eng: "Joy: The food came out wrong." }, { term: "ê·€ì°®ë‹¤", meaning: "to be a hassle", context: "ë¯¼í˜¸: ë‹¤ì‹œ ë§í•˜ëŠ” ê±´ ë„ˆë¬´ ê·€ì°®ì•„ìš”.", context_eng: "Minho: Saying it again is so bothersome." }] 
            },
            { 
                num: 7, 
                kor: "ì—¬ëŸ¬ë¶„ì—ê²Œ ë‹¤ì‹œ ì£¼ë¬¸í•˜ëŠ” ê²ƒì´ ê°„ë‹¨í•´ìš”? ì•„ë‹ˆë©´ ì–´ë ¤ì›Œìš”?", 
                eng: "Is reordering simple for you? Or is it difficult?", 
                vocab: [{ term: "ì£¼ë¬¸í•˜ë‹¤", meaning: "to order", context: "ì¡°ì´: ë‹¤ì‹œ ì£¼ë¬¸í•˜ëŠ” ê²ƒì€ ì•„ì£¼ ê°„ë‹¨í•´ìš”!", context_eng: "Joy: Re-ordering is very simple!" }, { term: "ê°„ë‹¨í•˜ë‹¤", meaning: "to be simple", context: "ì¡°ì´: ë‹¤ì‹œ ì£¼ë¬¸í•˜ëŠ” ê²ƒì€ ì•„ì£¼ ê°„ë‹¨í•´ìš”!", context_eng: "Joy: Re-ordering is very simple!" }] 
            },
            { 
                num: 8, 
                kor: "ì‹ë‹¹ì—ì„œ ì†ë‹˜ì˜ ê¶Œë¦¬ê°€ ë­˜ê¹Œìš”?", 
                eng: "What are a customer's rights at a restaurant?", 
                vocab: [{ term: "ê¶Œë¦¬", meaning: "a right", context: "ì¡°ì´: ìš°ë¦¬ê°€ ì£¼ë¬¸í•œ ìŒì‹ì„ ë¨¹ëŠ” ê±´ ìš°ë¦¬ì˜ 'ê¶Œë¦¬'ì˜ˆìš”!", context_eng: "Joy: Eating the food we ordered is our 'right'!" }] 
            },
            { 
                num: 9, 
                kor: "ì‹ë‹¹ì—ì„œ ì–´ë–¤ ë¬¸ì œê°€ ìƒê¸¸ ìˆ˜ ìˆì„ê¹Œìš”?", 
                eng: "What kind of problems can happen at a restaurant?", 
                vocab: [{ term: "ë¬¸ì œ", meaning: "problem", context: "ì¡°ì´: ì œê°€ ê°€ì„œ ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ê³  ì˜¬ê²Œìš”.", context_eng: "Joy: I'll go and solve this problem." }] 
            },
            { 
                num: 10, 
                kor: "ë¬¸ì œê°€ ìˆì„ ë•Œ ëˆ„êµ¬í•œí…Œ ë„ì›€ì„ ìš”ì²­í•´ìš”? í˜¼ì í•´ê²°í•´ìš”?", 
                eng: "When there is a problem, who do you ask for help? Do you solve it by yourself?", 
                vocab: [{ term: "ë¬¸ì œ", meaning: "problem", context: "ì¡°ì´: ì œê°€ ê°€ì„œ ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ê³  ì˜¬ê²Œìš”.", context_eng: "Joy: I'll go and solve this problem." }, { term: "í•´ê²°í•˜ë‹¤", meaning: "to solve", context: "ì¡°ì´: ì œê°€ ê°€ì„œ ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ê³  ì˜¬ê²Œìš”.", context_eng: "Joy: I'll go and solve this problem." }] 
            }
        ];

        const SCRIPT_DATA = [
            { id: 's1', speaker: 'ë¯¼í˜¸', kor: 'ğŸ’¬ ì•ˆë…•í•˜ì„¸ìš”! <ì´ ì£¼ì œë¡œ ì´ì•¼ê¸°í•´ ë´ìš”> íŒŸìºìŠ¤íŠ¸ì˜ˆìš”. ì €ëŠ” ë¯¼í˜¸ì˜ˆìš”.', time: [0, 5], eng: "Hello! This is the <Let's Talk About This Topic> podcast. I'm Minho." },
            { id: 's2', speaker: 'ì¡°ì´', kor: 'ğŸ’¬ ì•ˆë…•í•˜ì„¸ìš”. ì €ëŠ” ì¡°ì´ì˜ˆìš”.', time: [5, 8], eng: "Hello. I'm Joy." },
            { id: 's3', speaker: 'ë¯¼í˜¸', kor: 'ğŸ’¬ ì¡°ì´ ì”¨, ì˜¤ëŠ˜ ì € ì§„ì§œ ë°°ê³ íŒŒìš”. â€˜ë°°ê³ í”„ë‹¤â€™ëŠ” â€˜ìŒì‹ì„ ë¨¹ê³  ì‹¶ë‹¤â€™ëŠ” ëœ»ì´ì—ìš”. ì ì‹¬ ë­ ë¨¹ì„ê¹Œìš”?', time: [8, 15], eng: "Joy, I'm really hungry today. 'ë°°ê³ í”„ë‹¤' means 'to want to eat food'. What should we eat for lunch?" },
            { id: 's4', speaker: 'ì¡°ì´', kor: 'ğŸ’¬ ì €ëŠ” ì§œì¥ë©´ì´ ë¨¹ê³  ì‹¶ì–´ìš”!', time: [15, 18], eng: "I want to eat Jajangmyeon!" },
            { id: 's5', speaker: 'ë¯¼í˜¸', kor: 'ğŸ’¬ ì˜¤, ì¢‹ì€ ìƒê°ì´ì—ìš”! ê·¸ëŸ¼ ì €ëŠ” ë§¤ìš´ ì§¬ë½•ì„ ë¨¹ì„ë˜ìš”!', time: [18, 22], eng: "Oh, good idea! Then I'll have spicy Jjamppong!" },
            { id: 's6', speaker: 'ì¡°ì´', kor: 'ğŸ’¬ ì, ìš°ë¦¬ê°€ ì‹ë‹¹ì— ì™”ì–´ìš”. ì£¼ë¬¸í• ê¹Œìš”? â€˜ì£¼ë¬¸í•˜ë‹¤â€™ëŠ” â€˜ìŒì‹ ì£¼ì„¸ìš”â€™ë¼ê³  ë§í•˜ëŠ” ê±°ì˜ˆìš”. "ì‚¬ì¥ë‹˜! ì—¬ê¸° ì§œì¥ë©´ í•˜ë‚˜, ì§¬ë½• í•˜ë‚˜ ì£¼ì„¸ìš”!"', time: [22, 30], eng: "Okay, we're at the restaurant. Shall we order? 'ì£¼ë¬¸í•˜ë‹¤' means to say 'Please give us food'. \"Excuse me! One Jajangmyeon and one Jjamppong, please!\"" },
            { id: 's7', speaker: 'ë¯¼í˜¸', kor: 'ğŸ’¬ ë¹¨ë¦¬ ë‚˜ì˜¤ë©´ ì¢‹ê² ì–´ìš”. ë„ˆë¬´ ë°°ê³ íŒŒìš”.', time: [30, 34], eng: "I hope it comes out quickly. I'm so hungry." },
            { id: 's8', speaker: 'ì¡°ì´', kor: 'ğŸ’¬ ì™€, ìŒì‹ì´ ë‚˜ì™”ì–´ìš”! ì˜ ë¨¹ê² ìŠµë‹ˆë‹¤!', time: [34, 38], eng: "Wow, the food is here! Let's eat well!" },
            { id: 's9', speaker: 'ë¯¼í˜¸', kor: 'ğŸ’¬ ì–´?ğŸ˜¯ ì¡°ì´ ì”¨, ì´ê²ƒ ì¢€ ë´ìš”.', time: [38, 42], eng: "Huh?ğŸ˜¯ Joy, look at this." },
            { id: 's10', speaker: 'ì¡°ì´', kor: 'ğŸ’¬ ë„¤?ğŸ˜® ì™œìš”? â€¦ì–´?ğŸ˜³ ì§œì¥ë©´ì´... ë‘ ê°œë„¤ìš”? ë¯¼í˜¸ ì”¨ ì§¬ë½•ì€ ì–´ë”” ê°”ì–´ìš”?ğŸ§', time: [42, 50], eng: "Yes?ğŸ˜® Why? ...Huh?ğŸ˜³ There are... two Jajangmyeons? Where did your Jjamppong go?ğŸ§" },
            { id: 's11', speaker: 'ë¯¼í˜¸', kor: 'ğŸ’¬ ê·¸ëŸ¬ë‹ˆê¹Œìš”. ì œ ì§¬ë½•ì´ ì—†ì–´ìš”.', time: [50, 53], eng: "I know. My Jjamppong is missing." },
            { id: 's12', speaker: 'ì¡°ì´', kor: 'ğŸ’¬ ì„¸ìƒì—.â€¼ï¸ ìŒì‹ì´ ì˜ëª» ë‚˜ì™”ë„¤ìš”. \'ì˜ëª» ë‚˜ì˜¤ë‹¤\'ëŠ” â€˜ì£¼ë¬¸í•œ ìŒì‹ì´ ì•„ë‹ˆë‹¤â€˜ë¼ëŠ” ëœ»ì´ì—ìš”. ì œê°€ ê°€ì„œ ë§í• ê²Œìš”.', time: [53, 60], eng: "Oh my gosh.â€¼ï¸ The food came out wrong. 'ì˜ëª» ë‚˜ì˜¤ë‹¤' means 'it's not the food that was ordered'. I'll go and tell them." },
            { id: 's13', speaker: 'ë¯¼í˜¸', kor: 'ğŸ’¬ ì•„, ì•„ë‹ˆì—ìš”! ì¡°ì´ ì”¨, ì ê¹ë§Œìš”! ê·¸ëƒ¥ ë¨¹ì–´ìš”.', time: [60, 65], eng: "Ah, no! Joy, wait a minute! Let's just eat." },
            { id: 's14', speaker: 'ì¡°ì´', kor: 'ğŸ’¬ ë„¤?ğŸ˜§ ë¯¼í˜¸ ì”¨ëŠ” ì§¬ë½• ë¨¹ê³  ì‹¶ë‹¤ê³  í–ˆì–ì•„ìš”.', time: [65, 70], eng: "What?ğŸ˜§ Minho, you said you wanted to eat Jjamppong." },
            { id: 's15', speaker: 'ë¯¼í˜¸', kor: 'ğŸ’¬ ê´œì°®ì•„ìš”. ì§œì¥ë©´ì´ë‘ ì§¬ë½•ì€ í° ì°¨ì´ê°€ ì—†ì–´ìš”.ğŸ˜… \'ì°¨ì´ê°€ ì—†ë‹¤\'ëŠ” \'ë‹¤ë¥´ì§€ ì•Šë‹¤\'ëŠ” ëœ»ì´ì—ìš”. ë‘˜ ë‹¤ ë§›ìˆì–´ìš”.', time: [70, 78], eng: "It's okay. There's not a big difference between Jajangmyeon and Jjamppong.ğŸ˜… 'ì°¨ì´ê°€ ì—†ë‹¤' means 'not different'. Both are delicious." },
            { id: 's16', speaker: 'ì¡°ì´', kor: 'ğŸ’¬ ê·¸ê²Œ ë¬¸ì œê°€ ì•„ë‹ˆì—ìš”!ğŸ˜¤ ìš°ë¦¬ëŠ” ëˆì„ ëƒˆì–´ìš”. ìš°ë¦¬ê°€ ì£¼ë¬¸í•œ ìŒì‹ì„ ë¨¹ëŠ” ê±´ ìš°ë¦¬ì˜ \'ê¶Œë¦¬\'ì˜ˆìš”! \'ê¶Œë¦¬\'ëŠ” \'ë‚´ê°€ ë°›ì•„ì•¼ í•˜ëŠ” ê²ƒ\'ì´ë¼ëŠ” ëœ»ì´ì—ìš”.', time: [78, 88], eng: "That's not the problem!ğŸ˜¤ We paid money. Eating the food we ordered is our 'right'! 'ê¶Œë¦¬' means 'what I deserve to receive'." },
            { id: 's17', speaker: 'ë¯¼í˜¸', kor: 'ğŸ’¬ ë‹¤ì‹œ ë§í•˜ëŠ” ê±´ ë„ˆë¬´ ê·€ì°®ì•„ìš”. ğŸ˜… â€˜ê·€ì°®ë‹¤â€™ëŠ” â€˜ì•„ë¬´ê²ƒë„ ì•ˆ í•˜ê³  ì‹¶ë‹¤â€™ëŠ” ëœ»ì´ì—ìš”.', time: [88, 94], eng: "Saying it again is so bothersome. ğŸ˜… 'ê·€ì°®ë‹¤' means 'to not want to do anything'." },
            { id: 's18', speaker: 'ì¡°ì´', kor: 'ğŸ’¬ ë‹¤ì‹œ ì£¼ë¬¸í•˜ëŠ” ê²ƒì€ ì•„ì£¼ ê°„ë‹¨í•´ìš”! ğŸ¤¨â€˜ê°„ë‹¨í•˜ë‹¤â€™ëŠ” â€˜ì‰½ê²Œ í•  ìˆ˜ ìˆë‹¤â€™ë¼ëŠ” ëœ»ì´ì—ìš”. ê·¸ëƒ¥ ì§ì›ì—ê²Œ ê°€ì„œ "ìŒì‹ì´ ì˜ëª» ë‚˜ì™”ì–´ìš”"ë¼ê³  ë§í•˜ë©´ ë¼ìš”.', time: [94, 102], eng: "Re-ordering is very simple! ğŸ¤¨ 'ê°„ë‹¨í•˜ë‹¤' means 'can be done easily'. You just have to go to the staff and say, \"The food came out wrong.\"" },
            { id: 's19', speaker: 'ë¯¼í˜¸', kor: 'ğŸ’¬ ì¡°ì´ ì”¨ëŠ” ê¼­ ë³€í˜¸ì‚¬ ê°™ì•„ìš”. í•˜ì§€ë§Œ ì €ëŠ” ê·¸ëƒ¥ ë¨¹ì„ë˜ìš”.', time: [102, 108], eng: "Joy, you're just like a lawyer. But I'll just eat it." },
            { id: 's20', speaker: 'ì¡°ì´', kor: 'ğŸ’¬ ì•„, ë¯¼í˜¸ ì”¨!ğŸ˜© ë§Œì•½ì— ìš°ë¦¬ê°€ ë¹„ì‹¼ ìŠ¤í…Œì´í¬ë¥¼ ì‹œì¼°ëŠ”ë°, í–„ë²„ê±°ê°€ ë‚˜ì˜¤ë©´, ê·¸ë•Œë„ ì°¨ì´ê°€ ì—†ë‹¤ê³  ë§í•  ê±°ì˜ˆìš”?', time: [108, 116], eng: "Ah, Minho!ğŸ˜© If we ordered an expensive steak and a hamburger came out, would you still say there's no difference then?" },
            { id: 's21', speaker: 'ë¯¼í˜¸', kor: 'ğŸ’¬ ğŸ¤” ìŒ... ê·¸ê±´... ë‹¤ë¥´ì£ .', time: [116, 120], eng: "ğŸ¤” Um... that's... different." },
            { id: 's22', speaker: 'ì¡°ì´', kor: 'ğŸ’¬ ê±°ë´ìš”!ğŸ¤« ì œê°€ ê°€ì„œ ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ê³  ì˜¬ê²Œìš”.ğŸ˜ \'í•´ê²°í•˜ë‹¤\'ëŠ” \'ë¬¸ì œë¥¼ ëë‚´ë‹¤\'ë¼ëŠ” ëœ»ì´ì—ìš”.', time: [120, 126], eng: "See!ğŸ¤« I'll go and solve this problem.ğŸ˜ 'í•´ê²°í•˜ë‹¤' means 'to finish a problem'." },
            { id: 's23', speaker: 'ë¯¼í˜¸', kor: 'ğŸ’¬ ğŸ˜®â€ğŸ’¨ ì•Œê² ì–´ìš”. ì¡°ì´ ì”¨ ë§ì´ ë‹¤ ë§ì•„ìš”. ëŒ€ì‹ ğŸ˜ ì¡°ì´ ì”¨ê°€ ê°€ì„œ ë§í•´ì£¼ì„¸ìš”.ğŸ˜‰', time: [126, 134], eng: "ğŸ˜®â€ğŸ’¨ Okay. Everything you say is right, Joy. Instead,ğŸ˜ please you go and tell them.ğŸ˜‰" },
            { id: 's24', speaker: 'ì¡°ì´', kor: 'ğŸ’¬ ì, ê·¸ëŸ¼ ì˜¤ëŠ˜ ë°°ìš´ ë‹¨ì–´ë¥¼ ë‹¤ì‹œ í™•ì¸í•´ ë³¼ê¹Œìš”?', time: [134, 138], eng: "Okay, then shall we check the words we learned today again?" },
            { id: 's29', speaker: 'ë¯¼í˜¸', kor: 'ğŸ’¬ ë„¤, ì¢‹ì•„ìš”!', time: [138, 140], eng: "Yes, sounds good!" },
            { id: 's25', speaker: 'ì¡°ì´', kor: 'ğŸ’¬ âˆ™ ë°°ê³ í”„ë‹¤: ìŒì‹ì„ ë¨¹ê³  ì‹¶ë‹¤', time: [140, 143], eng: "âˆ™ ë°°ê³ í”„ë‹¤: to want to eat food (to be hungry)" },
            { id: 's26', speaker: 'ì¡°ì´', kor: 'ğŸ’¬ âˆ™ ì£¼ë¬¸í•˜ë‹¤: ìŒì‹ ì£¼ì„¸ìš”', time: [143, 146], eng: "âˆ™ ì£¼ë¬¸í•˜ë‹¤: to order food" },
            { id: 's27', speaker: 'ì¡°ì´', kor: 'ğŸ’¬ âˆ™ ì˜ëª» ë‚˜ì˜¤ë‹¤: ì£¼ë¬¸í•œ ìŒì‹ì´ ì•„ë‹ˆë‹¤', time: [146, 149], eng: "âˆ™ ì˜ëª» ë‚˜ì˜¤ë‹¤: the order is not what you ordered" },
            { id: 's28', speaker: 'ì¡°ì´', kor: 'ğŸ’¬ âˆ™ ê·€ì°®ë‹¤: ì•„ë¬´ê²ƒë„ ì•ˆ í•˜ê³  ì‹¶ë‹¤', time: [149, 152], eng: "âˆ™ ê·€ì°®ë‹¤: to not want to do anything (to be a hassle)" },
            { id: 's30', speaker: 'ë¯¼í˜¸', kor: 'ğŸ’¬ âˆ™ ì°¨ì´ê°€ ì—†ë‹¤: ë‹¤ë¥´ì§€ ì•Šë‹¤', time: [152, 155], eng: "âˆ™ ì°¨ì´ê°€ ì—†ë‹¤: not different" },
            { id: 's31', speaker: 'ë¯¼í˜¸', kor: 'ğŸ’¬ âˆ™ ê¶Œë¦¬: ë‚´ê°€ ë°›ì•„ì•¼ í•˜ëŠ” ê²ƒ', time: [155, 158], eng: "âˆ™ ê¶Œë¦¬: what I deserve to receive (a right)" },
            { id: 's32', speaker: 'ë¯¼í˜¸', kor: 'ğŸ’¬ âˆ™ ê°„ë‹¨í•˜ë‹¤: ì‰½ê²Œ í•  ìˆ˜ ìˆë‹¤', time: [158, 161], eng: "âˆ™ ê°„ë‹¨í•˜ë‹¤: can be done easily (simple)" },
            { id: 's33', speaker: 'ë¯¼í˜¸', kor: 'ğŸ’¬ âˆ™ í•´ê²°í•˜ë‹¤: ë¬¸ì œë¥¼ ëë‚´ë‹¤', time: [161, 164], eng: "âˆ™ í•´ê²°í•˜ë‹¤: to finish a problem (to solve)" },
            { id: 's34', speaker: 'ì¡°ì´', kor: 'ğŸ’¬ ì—¬ëŸ¬ë¶„ì€ ìŒì‹ì´ ì˜ëª» ë‚˜ì™”ì„ ë•Œ, ê·¸ëƒ¥ ë¨¹ì–´ìš”? ì•„ë‹ˆë©´ ë‹¤ì‹œ ì£¼ë¬¸ì„ í•´ìš”?', time: [164, 168], eng: "Everyone, when your food comes out wrong, do you just eat it? Or do you reorder?" },
            { id: 's35', speaker: 'ë¯¼í˜¸', kor: 'ğŸ’¬ ì—¬ëŸ¬ë¶„ì˜ ìƒê°ì„ ì•Œë ¤ì£¼ì„¸ìš”. ê·¸ëŸ¼ ì˜¤ëŠ˜ì€ ì—¬ê¸°ê¹Œì§€ í• ê¹Œìš”?', time: [168, 172], eng: "Please let us know your thoughts. Then shall we stop here for today?" },
            { id: 's36', speaker: 'ì¡°ì´', kor: 'ğŸ’¬ ë„¤, ë‹¤ìŒì— ë˜ ì¬ë¯¸ìˆëŠ” ì´ì•¼ê¸°ë¡œ ë§Œë‚˜ìš”! ì•ˆë…•íˆ ê³„ì„¸ìš”!', time: [172, 175], eng: "Yes, see you next time with another interesting story! Goodbye!" }
        ];

        // --- Sidebar Component ---
        const Sidebar = ({ activeTab, setActiveTab, isCollapsed, toggleSidebar, userLevel }) => {
            const menus = [
                { id: 'home', label: 'í™ˆ', subLabel: 'Home', icon: DashboardIcon },
                { id: 'learn', label: 'ëŒ€í™” ìŠ¤í¬ë¦½íŠ¸', subLabel: 'Transcript', icon: LearnIcon },
                { id: 'vocab', label: 'í•µì‹¬ ì–´íœ˜', subLabel: 'Key Vocabulary', icon: VocabIcon },
                { id: 'quiz', label: 'ë‚´ìš© í™•ì¸ í€´ì¦ˆ', subLabel: 'Comprehension Quiz', icon: QuizIcon },
                { id: 'discuss', label: 'ìƒê°í•´ ë³´ê¸°', subLabel: 'Food For Thought', icon: DiscussIcon },
            ];
            
            const getLevelColor = (code) => {
                // If direct match exists in LEVEL_STYLES, use it. Otherwise fallback to base.
                if (LEVEL_STYLES[code]) return LEVEL_STYLES[code];
                const base = code.substring(0, 2);
                return LEVEL_STYLES[base] || "bg-gray-50 text-gray-600 border-gray-100";
            };

            const currentStyle = getLevelColor(userLevel);
            // Extract the background class (e.g., "bg-orange-50") and text class (e.g., "text-orange-600")
            const bgClass = currentStyle.split(' ')[0];
            const textClass = currentStyle.split(' ')[1];

            return (
                <aside className={`bg-white border-r border-gray-200 fixed h-full hidden md:flex flex-col z-50 transition-all duration-300 ease-in-out font-noto ${isCollapsed ? 'w-[88px]' : 'w-64'}`}>
                    <div className={`p-6 flex items-center gap-3 relative ${isCollapsed ? 'justify-center px-0' : ''}`}>
                        <img 
                            src="https://raw.githubusercontent.com/openkoreanlearninglab/Lets-talk-about-this-topic/02d57eda9b250e56fab00389758ecad51ce0c54a/OpenKoreanLearningLab_Logo.jpeg" 
                            alt="Logo" 
                            className={`rounded-2xl shadow-lg shrink-0 transition-all duration-300 object-cover ${isCollapsed ? 'w-[48px] h-[48px]' : 'w-[60px] h-[60px]'}`}
                        />
                        {!isCollapsed && (
                            <div className="animate-fade-in overflow-hidden whitespace-nowrap flex flex-col justify-center">
                                <span className="font-extrabold text-[20px] text-black leading-none font-jua">Open</span>
                                <span className={`font-bold text-[14px] leading-none font-jua ${textClass}`}>KoreanLearningLab</span>
                            </div>
                        )}
                        <button 
                            onClick={toggleSidebar}
                            className="absolute -right-3 top-1/2 -translate-y-1/2 bg-white border border-gray-200 rounded-full p-1 shadow-sm text-gray-500 hover:text-gray-700 hover:bg-gray-50 transition-colors z-10"
                        >
                            {isCollapsed ? <ChevronRight className="w-3 h-3" /> : <ChevronLeft className="w-3 h-3" />}
                        </button>
                    </div>
                    
                    <nav className={`flex-1 space-y-3 mt-4 ${isCollapsed ? 'px-3' : 'px-4'}`}>
                        {menus.map((menu) => {
                            const IconComp = menu.icon;
                            const isActive = activeTab === menu.id;
                            return (
                                <button
                                    key={menu.id}
                                    onClick={() => setActiveTab(menu.id)}
                                    className={`w-full flex items-center transition-all duration-200 group relative ${
                                        isCollapsed 
                                        ? 'justify-center h-14 rounded-2xl' 
                                        : 'gap-3 px-4 py-3 rounded-2xl'
                                    } ${
                                        isActive 
                                        ? 'bg-[#ecfdf5] text-green-600' 
                                        : 'text-gray-400 hover:bg-gray-50 hover:text-gray-600'
                                    }`}
                                >
                                    {isActive && isCollapsed && (
                                        <div className="absolute left-0 top-1/2 -translate-y-1/2 w-1.5 h-8 bg-green-500 rounded-r-lg"></div>
                                    )}
                                    {isActive && !isCollapsed && (
                                        <div className="absolute left-0 top-1/2 -translate-y-1/2 w-1 h-6 bg-green-500 rounded-r-lg"></div>
                                    )}
                                    
                                    <IconComp className={`shrink-0 transition-all duration-200 ${isCollapsed ? 'w-7 h-7' : 'w-6 h-6'} ${isActive ? 'text-green-600' : 'text-gray-400 group-hover:text-gray-50'}`} />
                                    
                                    {!isCollapsed && (
                                        <div className="flex flex-col items-start animate-fade-in overflow-hidden whitespace-nowrap">
                                            <span className="font-bold text-sm leading-none">{menu.label}</span>
                                            <span className="text-[10px] font-medium text-gray-400 mt-0.5 leading-none">{menu.subLabel}</span>
                                        </div>
                                    )}
                                    
                                    {isCollapsed && (
                                        <div className="absolute left-full ml-3 px-3 py-1.5 bg-gray-900 text-white rounded-lg opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none whitespace-nowrap z-50 shadow-xl flex flex-col items-start">
                                            <span className="text-xs font-bold">{menu.label}</span>
                                            <span className="text-[10px] opacity-80">{menu.subLabel}</span>
                                            <div className="absolute top-1/2 -left-1 -translate-y-1/2 w-2 h-2 bg-gray-900 rotate-45"></div>
                                        </div>
                                    )}
                                </button>
                            );
                        })}
                    </nav>

                    <div className="p-4 border-t border-gray-100">
                        <div className={`flex items-center gap-3 p-2 rounded-xl transition-colors hover:bg-gray-50 cursor-pointer ${isCollapsed ? 'justify-center' : ''}`}>
                            <div className={`w-[44px] h-[44px] rounded-xl flex items-center justify-center shrink-0 transition-colors duration-300 ${bgClass} border ${currentStyle.split(' ')[2]}`}>
                                <span className={`text-sm font-extrabold ${textClass}`}>{userLevel}</span>
                            </div>
                            {!isCollapsed && (
                                <div className="animate-fade-in overflow-hidden whitespace-nowrap flex-1">
                                    <p className="text-sm font-extrabold text-gray-900 mb-[1px] font-sunflower">í•™ìŠµì(Learner)</p>
                                    <div className="mt-[1px]">
                                        <span className={`block w-fit px-[2px] py-0.5 rounded text-[9px] font-bold border uppercase tracking-wide shadow-sm text-left cursor-default font-sunflower ${currentStyle}`}>
                                            Level: {LEVEL_DEFINITIONS[userLevel].title}
                                        </span>
                                    </div>
                                </div>
                            )}
                        </div>
                    </div>
                </aside>
            );
        };

        // --- View Components ---

        const HomeView = ({ setActiveTab, progress, userLevel }) => {
            const completedCount = Object.values(progress).filter(val => val === true || (typeof val === 'number' && val > 0)).length;
            const percentage = Math.round((completedCount / 4) * 100);

            // í€´ì¦ˆ ì§„í–‰ë¥  í‘œì‹œ ë¡œì§
            const quizScoreDisplay = typeof progress.quiz === 'number' ? `${progress.quiz}%` : (progress.quiz ? '100%' : '0%');
            const quizColorClass = (progress.quiz === 100 || progress.quiz === true) ? 'text-green-600' : 'text-gray-900';
            const quizIconBg = (progress.quiz === 100 || progress.quiz === true) ? 'bg-green-100 text-green-600' : 'bg-purple-50 text-purple-600';

            return (
                <div className="space-y-10 animate-fade-in max-w-6xl mx-auto">
                    <div className="space-y-3">
                        <div className="flex items-center gap-2">
                            <span className="px-2 py-1 bg-green-100 text-green-700 text-[10px] font-bold rounded-md tracking-wider">NEW</span>
                            <span className="text-xs font-bold text-green-600 tracking-wide uppercase">Today's Topic</span>
                        </div>
                        <h1 className="text-4xl font-black text-gray-900 tracking-tight font-jua">ì‹ë‹¹: ìŒì‹ì´ ì˜ëª» ë‚˜ì™”ì„ ë•Œ</h1>
                        <p className="text-gray-500 text-lg">Restaurant: When the food comes out wrong</p>
                    </div>

                    <div className="bg-white rounded-3xl border border-gray-100 shadow-sm overflow-hidden flex flex-col md:flex-row h-auto md:h-80">
                        <div className="md:w-5/12 relative group bg-black cursor-pointer overflow-hidden" onClick={() => setActiveTab('learn')}>
                            <img src="https://img.youtube.com/vi/klxx6ChKQFg/maxresdefault.jpg" alt="Thumbnail" className="w-full h-full object-cover opacity-80 group-hover:opacity-60 transition-opacity duration-300" />
                            <div className="absolute top-6 left-6">
                                <span className="bg-[#ea3323] text-white text-[10px] font-bold px-2 py-1 rounded border border-[#ea3323] shadow-sm tracking-wider">ON AIR</span>
                            </div>
                            <div className="absolute inset-0 flex items-center justify-center">
                                <div className="w-14 h-14 bg-white rounded-full flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform duration-300">
                                    <PlayIconLine className="w-6 h-6 text-green-600 fill-current ml-1" />
                                </div>
                            </div>
                        </div>

                        <div className="md:w-7/12 p-8 md:p-10 flex flex-col justify-center">
                            <div className="flex items-center gap-2 mb-4">
                                <span className="px-2 py-1 bg-gray-100 text-gray-600 text-[10px] font-bold rounded uppercase tracking-wide">Listening</span>
                                {/* Level Badge Applied */}
                                <LevelBadge levelCode={userLevel} />
                            </div>
                            
                            <div className="mb-3">
                                <h2 className="text-2xl font-black text-gray-900">ëŒ€í™” ìŠ¤í¬ë¦½íŠ¸</h2>
                                <span className="text-sm font-bold text-gray-400">Transcript</span>
                            </div>
                            
                            <div className="text-gray-600 text-sm leading-relaxed mb-8 pr-4">
                                <p>íŒŸìºìŠ¤íŠ¸ë¥¼ ë“£ê³  ì‹ë‹¹ì—ì„œ ì£¼ë¬¸ ì‹¤ìˆ˜ê°€ ìƒê²¼ì„ ë•Œì˜ ìƒí™©ì„ ë°°ì›Œë³´ì„¸ìš”.</p>
                                <p className="mt-1 text-gray-400 text-xs">Listen to the podcast about handling order mistakes at a restaurant.</p>
                            </div>
                            
                            <div className="flex items-center gap-3">
                                <button 
                                    onClick={() => setActiveTab('learn')}
                                    className="px-6 py-3 bg-[#111827] text-white rounded-xl hover:bg-black transition-colors shadow-md flex flex-col items-center leading-tight"
                                >
                                    <span className="text-sm font-bold">ë™ì˜ìƒ ë³´ëŸ¬ ê°€ê¸°</span>
                                    <span className="text-[10px] opacity-70 font-medium">Watch Video</span>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                        {/* Card 1: Vocabulary */}
                        <div className="bg-white p-6 rounded-3xl border border-gray-100 shadow-sm flex flex-col justify-between h-40 hover:shadow-md transition-shadow">
                            <div className="flex justify-between items-start">
                                <div>
                                    <div className="flex flex-col">
                                        <span className="text-xs font-bold text-gray-500 font-jua">í•µì‹¬ ì–´íœ˜</span>
                                        <span className="text-[10px] text-gray-400 font-medium">Key Vocabulary</span>
                                    </div>
                                    <p className="text-4xl font-black text-gray-900 mt-1">{VOCAB_DATA.length}ê°œ</p>
                                </div>
                                <div className="w-10 h-10 bg-green-50 text-green-600 rounded-xl flex items-center justify-center">
                                    <VocabIcon className="w-5 h-5" />
                                </div>
                            </div>
                            <button onClick={() => setActiveTab('vocab')} className="group flex items-center gap-1 transition-colors">
                                <div className="flex flex-col items-start">
                                    <span className="text-xs font-bold text-gray-400 group-hover:text-green-600">í•µì‹¬ ì–´íœ˜ í™•ì¸</span>
                                    <span className="text-[10px] text-gray-300 group-hover:text-green-400 font-medium">Check Vocabulary</span>
                                </div>
                                <span className="text-lg leading-none text-gray-400 group-hover:text-green-600 ml-1">â†’</span>
                            </button>
                        </div>

                        {/* Card 2: Quiz Progress */}
                        <div className="bg-white p-6 rounded-3xl border border-gray-100 shadow-sm flex flex-col justify-between h-40 hover:shadow-md transition-shadow">
                            <div className="flex justify-between items-start">
                                <div>
                                    <div className="flex flex-col">
                                        <span className="text-xs font-bold text-gray-500 font-jua">ë‚´ìš© í™•ì¸ í€´ì¦ˆ</span>
                                        <span className="text-[10px] text-gray-400 font-medium">Comprehension Quiz</span>
                                    </div>
                                    <p className={`text-4xl font-black mt-1 transition-all duration-500 ${quizColorClass}`}>
                                        {quizScoreDisplay}
                                    </p>
                                </div>
                                <div className={`w-10 h-10 rounded-xl flex items-center justify-center transition-colors ${quizIconBg}`}>
                                    <QuizIcon className="w-5 h-5" />
                                </div>
                            </div>
                            <button onClick={() => setActiveTab('quiz')} className="group flex items-center gap-1 transition-colors">
                                <div className="flex flex-col items-start">
                                    <span className="text-xs font-bold text-gray-400 group-hover:text-purple-600">í€´ì¦ˆ ì‹œì‘í•˜ê¸°</span>
                                    <span className="text-[10px] text-gray-300 group-hover:text-purple-400 font-medium">Start Quiz</span>
                                </div>
                                <span className="text-lg leading-none text-gray-400 group-hover:text-purple-600 ml-1">â†’</span>
                            </button>
                        </div>

                        {/* Card 3: Food For Thought -> Modified to Gemini AI Feedback */}
                        <div className="bg-white p-6 rounded-3xl border border-gray-100 shadow-sm flex flex-col justify-between h-40 hover:shadow-md transition-shadow">
                            <div className="flex justify-between items-start">
                                <div>
                                    <div className="flex flex-col">
                                        <span className="text-xs font-bold text-gray-500 font-jua">ìƒê°í•´ ë³´ê¸°</span>
                                        <span className="text-[10px] text-gray-400 font-medium">Food For Thought</span>
                                    </div>
                                    <div className="flex flex-col mt-3">
                                        <a 
                                            href="https://gemini.google.com/share/fd2560721f8f" 
                                            target="_blank" 
                                            rel="noopener noreferrer" 
                                            className="text-xl font-black text-blue-600 hover:text-blue-800 hover:underline transition-colors block leading-tight"
                                        >
                                            Gemini AI Feedback
                                        </a>
                                    </div>
                                </div>
                                <div className="w-10 h-10 bg-blue-50 text-blue-600 rounded-xl flex items-center justify-center">
                                    <DiscussIcon className="w-5 h-5" />
                                </div>
                            </div>
                            
                            <button onClick={() => setActiveTab('discuss')} className="group flex items-center gap-1 transition-colors">
                                <div className="flex flex-col items-start">
                                    <span className="text-xs font-bold text-gray-400 group-hover:text-blue-600">ë‹¤ìŒ ì§ˆë¬¸ë“¤ì„ ìƒê°í•´ ë³´ì„¸ìš”.</span>
                                    <span className="text-[10px] text-gray-300 group-hover:text-blue-400 font-medium">Have a think about the following questions.</span>
                                </div>
                                <span className="text-lg leading-none text-gray-400 group-hover:text-blue-600 ml-1">â†’</span>
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        const LearnView = ({ updateProgress }) => {
            const [player, setPlayer] = useState(null);
            const playerRef = useRef(null); 
            const [currentTime, setCurrentTime] = useState(0);
            const [activeLine, setActiveLine] = useState(null);
            const [autoScroll, setAutoScroll] = useState(true);
            const [showVocab, setShowVocab] = useState(false);
            const [playbackRate, setPlaybackRate] = useState(1.0);
            const [translations, setTranslations] = useState({});
            const [popup, setPopup] = useState({ show: false, fixed: false, data: null, x: 0, y: 0 });
            
            // New state for vocab highlight
            const [activeVocabTerm, setActiveVocabTerm] = useState(null);
            const sidebarVocabRefs = useRef({});

            const scriptRefs = useRef({});
            const intervalRef = useRef(null);

            useEffect(() => {
                const loadVideo = () => {
                    if (window.YT && window.YT.Player) {
                        new window.YT.Player('youtube-player', {
                            videoId: 'klxx6ChKQFg',
                            width: '100%',
                            height: '100%',
                            playerVars: { 'autoplay': 0, 'controls': 1, 'rel': 0 },
                            events: {
                                'onReady': (event) => {
                                    playerRef.current = event.target;
                                    setPlayer(event.target);
                                },
                                'onStateChange': (event) => {
                                    if (event.data === window.YT.PlayerState.PLAYING) {
                                        startInterval();
                                        updateProgress('learn');
                                    } else stopInterval();
                                }
                            }
                        });
                    }
                };
                if (!window.YT) {
                    const tag = document.createElement('script');
                    tag.src = "https://www.youtube.com/iframe_api";
                    const firstScriptTag = document.getElementsByTagName('script')[0];
                    firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
                    window.onYouTubeIframeAPIReady = loadVideo;
                } else {
                    loadVideo();
                }
                return () => stopInterval();
            }, []);

            useEffect(() => {
                const handleGlobalClick = () => {
                    if (popup.fixed) {
                        setPopup(prev => ({ ...prev, show: false, fixed: false }));
                    }
                };
                if (popup.fixed) {
                    window.addEventListener('click', handleGlobalClick);
                }
                return () => window.removeEventListener('click', handleGlobalClick);
            }, [popup.fixed]);

            const startInterval = () => {
                stopInterval();
                intervalRef.current = setInterval(() => {
                    const p = playerRef.current;
                    if (p && p.getCurrentTime) {
                        const time = p.getCurrentTime();
                        setCurrentTime(time);
                        const currentLine = SCRIPT_DATA.find(line => time >= line.time[0] && time < line.time[1]);
                        if (currentLine) setActiveLine(currentLine.id);
                    }
                }, 200);
            };
            const stopInterval = () => clearInterval(intervalRef.current);

            const handleSpeedChange = (e) => {
                const rate = parseFloat(e.target.value);
                setPlaybackRate(rate);
                if (player && player.setPlaybackRate) player.setPlaybackRate(rate);
            };

            useEffect(() => {
                if (popup.show) return;
                if (activeLine && autoScroll && scriptRefs.current[activeLine]) {
                    scriptRefs.current[activeLine].scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            }, [activeLine, autoScroll, popup.show]);

            const handleLineClick = (time) => {
                if (player) {
                    player.seekTo(time);
                    player.playVideo();
                }
            };

            const toggleTranslation = (id) => {
                setTranslations(prev => ({...prev, [id]: !prev[id]}));
            };

            const scrollToVocab = (term) => {
                const element = sidebarVocabRefs.current[term];
                if (element) {
                    element.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            };

            const handleVocabEnter = (e, wordData) => {
                if (popup.fixed) return; 
                const rect = e.target.getBoundingClientRect();
                setPopup({
                    show: true,
                    fixed: false, // í˜¸ë²„ ì‹œì—ëŠ” fixed: false (ê°„ë‹¨íˆ ë³´ì´ê¸°)
                    data: wordData,
                    x: rect.left + rect.width / 2, 
                    y: rect.bottom
                });

                // Scroll sidebar if open
                if (showVocab) {
                    setActiveVocabTerm(wordData.term);
                    scrollToVocab(wordData.term);
                }
            };

            const handleVocabLeave = () => {
                if (popup.fixed) return;
                setPopup(prev => ({ ...prev, show: false }));
            };

            const handleVocabClick = (e, wordData) => {
                e.stopPropagation(); 
                // Popup logic
                if (popup.fixed && popup.data && popup.data.term === wordData.term) {
                    setPopup(prev => ({ ...prev, show: false, fixed: false }));
                    return;
                }
                const rect = e.target.getBoundingClientRect();
                setPopup({
                    show: true,
                    fixed: true, // í´ë¦­ ì‹œì—ëŠ” fixed: true (ìì„¸íˆ ë³´ì´ê¸°)
                    data: wordData,
                    x: rect.left + rect.width / 2,
                    y: rect.bottom
                });

                // Sidebar logic
                if (!showVocab) {
                   // Do NOT open sidebar. Only show popup.
                } else {
                    setActiveVocabTerm(wordData.term);
                    scrollToVocab(wordData.term);
                }
            };

            const renderTextWithVocab = (text) => {
                let parts = [text];
                VOCAB_DATA.forEach(vocab => {
                    const nextParts = [];
                    parts.forEach(part => {
                        if (typeof part === 'string') {
                            const split = part.split(vocab.term);
                            split.forEach((s, i) => {
                                if (s) nextParts.push(s);
                                if (i < split.length - 1) {
                                    nextParts.push({ isVocab: true, ...vocab });
                                }
                            });
                        } else {
                            nextParts.push(part);
                        }
                    });
                    parts = nextParts;
                });

                return parts.map((part, index) => {
                    if (typeof part === 'string') return part;
                    const isActive = (popup.show && popup.data && popup.data.term === part.term) || (showVocab && activeVocabTerm === part.term);
                    return (
                        <span 
                            key={index}
                            className={`cursor-pointer border-b-2 transition-all duration-200 font-bold inline-block leading-tight
                                ${isActive 
                                    ? 'text-green-700 border-green-500 bg-green-100 rounded-sm px-0.5 mx-0.5' 
                                    : 'text-gray-900 border-dashed border-gray-400 hover:text-green-600 hover:border-green-400 hover:bg-green-50'
                                }`}
                            onMouseEnter={(e) => handleVocabEnter(e, part)}
                            onMouseLeave={handleVocabLeave}
                            onClick={(e) => handleVocabClick(e, part)}
                        >
                            {part.term}
                        </span>
                    );
                });
            };

            return (
                <div className="flex h-[calc(100vh-4rem)] gap-4 animate-fade-in overflow-hidden relative">
                    {/* Vocab Popup */}
                    {popup.show && popup.data && createPortal(
                        <div 
                            className="fixed z-[9999] bg-white rounded-xl shadow-xl border border-gray-200 p-4 w-72 animate-fade-in pointer-events-none"
                            style={{ 
                                left: popup.x, 
                                top: popup.y + 12,
                                transform: 'translate(-50%, 0)'
                            }}
                        >
                            <div className="flex items-center justify-between mb-2">
                                <h3 className="text-lg font-black text-gray-900">{popup.data.term}</h3>
                            </div>
                            <p className="text-sm text-gray-700 font-medium mb-3 leading-snug">{popup.data.mainDef}</p>
                            
                            {/* ì˜ˆë¬¸ ëŒ€ì‹  ê´€ë ¨ í‘œí˜„(subTerms) í‘œì‹œ: í´ë¦­ ì‹œ(fixed=true)ì—ë§Œ ë³´ì„ */}
                            {popup.fixed && popup.data.subDefs && popup.data.subDefs.length > 0 && (
                                <div className="space-y-1 mt-2">
                                    {popup.data.subDefs.map((sub, idx) => (
                                        <div key={idx} className="bg-blue-50 rounded-lg p-2 border border-blue-100">
                                            <p className="text-xs text-blue-900 font-bold">{sub.subTerm}</p>
                                            <p className="text-[10px] text-blue-700">{sub.subDef}</p>
                                        </div>
                                    ))}
                                </div>
                            )}
                            
                            <div className="absolute top-0 left-1/2 -translate-x-1/2 -translate-y-1/2 w-3 h-3 bg-white border-l border-t border-gray-200 rotate-45"></div>
                        </div>,
                        document.body
                    )}

                    <div className={`bg-black rounded-xl overflow-hidden shadow-lg transition-all duration-300 ${showVocab ? 'w-5/12' : 'flex-1'}`}>
                         <div id="youtube-player" className="w-full h-full"></div>
                    </div>

                    <div className={`flex flex-col bg-white rounded-xl border border-gray-200 shadow-sm transition-all duration-300 ${showVocab ? 'w-4/12' : 'w-5/12'}`}>
                        {/* --- Controls Header (Modified for Responsive Layout) --- */}
                        <div className="flex flex-col xl:flex-row items-center justify-between p-3 border-b border-gray-100 bg-white rounded-t-xl z-10 gap-3 xl:gap-0">
                            {/* Speed Control Group */}
                            <div className="w-full xl:w-auto flex items-center justify-between gap-2 px-3 py-2 bg-white border border-gray-200 rounded-xl shadow-sm">
                                <div className="flex items-center gap-1.5 text-gray-600 shrink-0">
                                    <SpeedSolidIcon className="w-5 h-5 text-gray-500" />
                                    <span className="text-sm font-extrabold text-gray-600">Speed</span>
                                </div>
                                <div className="flex items-center gap-2 flex-1 xl:flex-none justify-center px-2">
                                    <span className="text-[10px] font-medium text-gray-400">0.5x</span>
                                    <input 
                                        type="range" min="0.5" max="1.0" step="0.01" 
                                        value={playbackRate} onChange={handleSpeedChange}
                                        className="flex-1 xl:w-32 h-1.5 bg-gray-100 rounded-lg appearance-none cursor-pointer"
                                    />
                                    <span className="text-[10px] font-medium text-gray-400">1.0x</span>
                                </div>
                                <div className="bg-[#ecfdf5] px-2 py-1 rounded-md min-w-[3rem] text-center border border-green-100 shrink-0">
                                    <span className="text-xs font-bold text-green-700">{playbackRate.toFixed(2)}x</span>
                                </div>
                            </div>

                            {/* Right Group: Auto Scroll & Vocabulary */}
                            <div className="w-full xl:w-auto flex items-center justify-between xl:justify-end gap-3">
                                <div className="flex items-center gap-2 cursor-pointer group" onClick={() => setAutoScroll(!autoScroll)}>
                                    <div className={`w-9 h-5 rounded-full relative transition-colors duration-200 ease-in-out ${autoScroll ? 'bg-green-500' : 'bg-gray-300'}`}>
                                        <div className={`absolute top-1 w-3 h-3 bg-white rounded-full shadow-sm transition-transform duration-200 ${autoScroll ? 'left-5' : 'left-1'}`}></div>
                                    </div>
                                    <span className="text-sm font-bold text-gray-600 group-hover:text-gray-800 transition-colors whitespace-nowrap">Auto Scroll</span>
                                </div>

                                <button 
                                    onClick={() => setShowVocab(!showVocab)}
                                    className={`flex items-center gap-2 px-3 py-1.5 rounded-lg border transition-all shadow-sm ${showVocab ? 'bg-gray-100 border-gray-300' : 'bg-white border-gray-300 hover:bg-gray-50'}`}
                                >
                                    <OpenBookSolidIcon className="w-4 h-4 text-gray-600" />
                                    <span className="text-sm font-bold text-gray-700 whitespace-nowrap">Vocabulary</span>
                                </button>
                            </div>
                        </div>

                        <div className="flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50">
                            {SCRIPT_DATA.map(line => {
                                const isActive = activeLine === line.id;
                                return (
                                    <div key={line.id} ref={el => scriptRefs.current[line.id] = el} className="flex flex-col">
                                        <div className="flex items-center gap-2 mb-1 ml-1">
                                            <span className="text-xs font-bold text-gray-600">{line.speaker}</span>
                                            <button onClick={(e) => { e.stopPropagation(); handleLineClick(line.time[0]); }} className="text-[10px] text-blue-500 hover:underline flex items-center gap-0.5">
                                                <PlayIconLine className="w-3 h-3 fill-current" /> ì¬ìƒ (Play)
                                            </button>
                                        </div>
                                        <div 
                                            onClick={() => handleLineClick(line.time[0])}
                                            className={`p-5 rounded-2xl border transition-all duration-300 cursor-pointer relative group ${
                                                isActive 
                                                ? 'bg-yellow-100 border-yellow-400 shadow-md ring-1 ring-yellow-200 scale-[1.01]' 
                                                : 'bg-white border-gray-200 hover:border-gray-300'
                                            }`}
                                        >
                                            <p className="text-lg text-gray-800 leading-relaxed font-medium">
                                                {renderTextWithVocab(line.kor)}
                                            </p>
                                            
                                            <div className="my-3 border-t border-dashed border-gray-200"></div>
                                            {translations[line.id] ? (
                                                <p className="text-sm text-gray-500 animate-fade-in">{line.eng}</p>
                                            ) : (
                                                <button 
                                                    onClick={(e) => { e.stopPropagation(); toggleTranslation(line.id); }}
                                                    className="text-xs text-gray-400 hover:text-gray-600 flex items-center gap-1"
                                                >
                                                    <TranslateIcon className="w-3 h-3" /> ë²ˆì—­ (Translation)
                                                </button>
                                            )}
                                            {translations[line.id] && (
                                                <button 
                                                    onClick={(e) => { e.stopPropagation(); toggleTranslation(line.id); }}
                                                    className="absolute bottom-4 right-4 text-[10px] text-gray-300 hover:text-gray-500"
                                                >
                                                    ì ‘ê¸°
                                                </button>
                                            )}
                                        </div>
                                    </div>
                                );
                            })}
                            <div className="h-32"></div>
                        </div>
                    </div>

                    {showVocab && (
                        <div className="w-3/12 flex flex-col bg-white rounded-xl border border-gray-200 shadow-sm animate-fade-in">
                            <div className="p-4 border-b border-gray-100 flex items-center gap-2 bg-white rounded-t-xl">
                                <VocabIcon className="w-5 h-5 text-green-600" />
                                <div className="flex flex-col leading-none">
                                    <h2 className="font-bold text-gray-900 text-sm font-jua">í•µì‹¬ ì–´íœ˜</h2>
                                    <span className="text-[10px] text-gray-400 font-medium">Key Vocabulary</span>
                                </div>
                            </div>
                            <div className="flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50">
                                {VOCAB_DATA.map((word, idx) => (
                                    <div 
                                        key={idx} 
                                        ref={el => sidebarVocabRefs.current[word.term] = el}
                                        className={`p-4 rounded-xl border transition-all duration-500 ${
                                            activeVocabTerm === word.term 
                                            ? 'border-green-500 bg-green-50 ring-2 ring-green-200 shadow-md scale-105' 
                                            : 'bg-white border-gray-200 shadow-sm'
                                        }`}
                                    >
                                        <div className="flex justify-between items-start mb-2">
                                            <h3 className="text-lg font-extrabold text-gray-900">{word.term}</h3>
                                        </div>
                                        <p className="text-sm text-gray-600 mb-3 font-medium">{word.mainDef}</p>
                                        
                                        {/* ì˜ˆë¬¸ ëŒ€ì‹  ê´€ë ¨ í‘œí˜„(subDefs) í‘œì‹œë¡œ ë³€ê²½ */}
                                        {word.subDefs && word.subDefs.length > 0 && (
                                            <div className="space-y-2 bg-blue-50 p-2.5 rounded-lg border border-blue-100">
                                                {word.subDefs.map((sub, i) => (
                                                    <div key={i}>
                                                        <p className="text-xs text-blue-900 font-bold leading-snug">{sub.subTerm}</p>
                                                        <p className="text-[10px] text-blue-700">{sub.subDef}</p>
                                                    </div>
                                                ))}
                                            </div>
                                        )}
                                    </div>
                                ))}
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        // ìƒˆë¡œ ì¶”ê°€ëœ VocabCard ì»´í¬ë„ŒíŠ¸
        const VocabCard = ({ word }) => {
            const [isOpen, setIsOpen] = useState(false);

            return (
                <div className="bg-white p-6 rounded-2xl border border-gray-200 shadow-sm hover:shadow-md transition-all h-full flex flex-col">
                    <div className="flex justify-between mb-4">
                        <h3 className="text-2xl font-extrabold text-gray-900">{word.term}</h3>
                    </div>
                    <div className="pl-4 border-l-4 border-green-500 mb-6">
                        <p className="text-lg text-gray-600 font-medium">{word.mainDef}</p>
                    </div>
                    
                    <div className="flex-1 flex flex-col">
                        {word.examples && word.examples.length > 0 && (
                            <>
                                <button 
                                    onClick={() => setIsOpen(!isOpen)}
                                    className="w-full flex items-center justify-between p-4 bg-gray-50 hover:bg-gray-100 rounded-xl transition-all group border border-transparent hover:border-gray-200"
                                >
                                    <div className="flex items-center gap-2">
                                        <span className={`w-1.5 h-1.5 rounded-full transition-colors duration-300 ${isOpen ? 'bg-green-500' : 'bg-gray-400'}`}></span>
                                        <span className={`text-xs font-bold uppercase tracking-wider transition-colors duration-300 ${isOpen ? 'text-green-700' : 'text-gray-500'}`}>
                                            Examples (ì˜ˆë¬¸)
                                        </span>
                                    </div>
                                    <ChevronRight className={`w-4 h-4 text-gray-400 transition-transform duration-300 ${isOpen ? 'rotate-90' : ''}`} />
                                </button>

                                <div 
                                    className={`overflow-hidden transition-all duration-300 ease-in-out ${isOpen ? 'max-h-96 opacity-100 mt-2' : 'max-h-0 opacity-0'}`}
                                >
                                    <div className="bg-gray-50 rounded-xl p-4 space-y-3 border border-gray-100">
                                        {word.examples.map((ex, i) => (
                                            <div key={i}>
                                                <p className="font-bold text-gray-800 text-sm leading-relaxed">{ex.kor}</p>
                                                <p className="text-gray-500 text-xs mt-0.5">{ex.eng}</p>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            </>
                        )}

                        {word.subDefs && word.subDefs.length > 0 && (
                            <div className="bg-blue-50 rounded-xl p-5 space-y-2 border border-blue-100 mt-4">
                                <h4 className="font-bold text-blue-800 text-xs mb-2 flex items-center gap-2 uppercase tracking-wider">
                                    <span className="w-1.5 h-1.5 rounded-full bg-blue-400"></span>
                                    Related & Grammar
                                </h4>
                                {word.subDefs.map((sub, i) => (
                                    <div key={i} className="flex flex-col">
                                        <span className="font-bold text-blue-900 text-sm">{sub.subTerm}</span>
                                        <span className="text-xs text-blue-600">{sub.subDef}</span>
                                    </div>
                                ))}
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        const VocabView = ({ updateProgress }) => {
            useEffect(() => {
                updateProgress('vocab');
            }, []);

            return (
            <div className="max-w-5xl animate-fade-in mx-auto">
                <div className="flex items-center gap-4 mb-8">
                    <div className="w-16 h-16 bg-[#DCFCE7] rounded-2xl flex items-center justify-center shrink-0">
                        <VocabHeaderIcon className="w-10 h-10" />
                    </div>
                    <div className="flex flex-col">
                        <h2 className="text-3xl font-black text-gray-900 font-jua">í•µì‹¬ ì–´íœ˜</h2>
                        <span className="text-base text-gray-500 font-medium">Key Vocabulary</span>
                    </div>
                </div>
                
                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                    {VOCAB_DATA.map((word, idx) => (
                        <VocabCard key={idx} word={word} />
                    ))}
                </div>
            </div>
            );
        };

        const QuizView = ({ updateProgress }) => {
            const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);
            const [answers, setAnswers] = useState({});
            const [firstAttempts, setFirstAttempts] = useState({}); 
            const [showHint, setShowHint] = useState(false);
            const [showTranslation, setShowTranslation] = useState(false);
            const [isFinished, setIsFinished] = useState(false);

            const currentQuestion = QUIZ_LIST[currentQuestionIndex];

            // ì„ íƒì§€ ëœë¤ ì„ê¸°: ë¬¸ì œê°€ ë°”ë€” ë•Œë§Œ(currentQuestion ë³€ê²½ ì‹œ) ì„ì´ê³ , ë¦¬ë Œë”ë§ ì‹œì—ëŠ” ìˆœì„œ ìœ ì§€
            const shuffledOptions = useMemo(() => {
                return [...currentQuestion.options].sort(() => Math.random() - 0.5);
            }, [currentQuestion]);

            const selectedOption = answers[currentQuestionIndex] || null;
            const isCorrect = selectedOption?.isCorrect;

            const handleOptionClick = (option) => {
                // ì´ë¯¸ ì •ë‹µì„ ë§ì·„ë‹¤ë©´ ë” ì´ìƒ ì„ íƒ ë¶ˆê°€
                if (selectedOption?.isCorrect) return; 

                // ì²« ì‹œë„ ê¸°ë¡ (ìµœì´ˆ í´ë¦­ ì‹œì—ë§Œ ê¸°ë¡)
                if (firstAttempts[currentQuestionIndex] === undefined) {
                    setFirstAttempts(prev => ({
                        ...prev,
                        [currentQuestionIndex]: option.isCorrect
                    }));
                }

                // í˜„ì¬ ì„ íƒí•œ ë‹µë³€ ì—…ë°ì´íŠ¸ (ì˜¤ë‹µì´ì–´ë„ ê³„ì† ì„ íƒ ê°€ëŠ¥)
                setAnswers(prev => ({
                    ...prev,
                    [currentQuestionIndex]: option
                }));
                
                setShowHint(false); 
            };

            const handlePrev = () => {
                if (currentQuestionIndex > 0) {
                    setCurrentQuestionIndex(prev => prev - 1);
                    setShowHint(false);
                    setShowTranslation(false);
                }
            };

            const handleNext = () => {
                if (currentQuestionIndex < QUIZ_LIST.length - 1) {
                    setCurrentQuestionIndex(prev => prev + 1);
                    setShowHint(false);
                    setShowTranslation(false);
                } else {
                    finishQuiz();
                }
            };

            const finishQuiz = () => {
                setIsFinished(true);
                const totalQuestions = QUIZ_LIST.length;
                const correctCount = Object.values(firstAttempts).filter(isCorrect => isCorrect === true).length;
                const finalScore = Math.round((correctCount / totalQuestions) * 100);
                updateProgress('quiz', finalScore);
            };

            const handleRetry = () => {
                setCurrentQuestionIndex(0);
                setAnswers({});
                setFirstAttempts({});
                setIsFinished(false);
                updateProgress('quiz', 0); 
            };

            if (isFinished) {
                const correctCount = Object.values(firstAttempts).filter(isCorrect => isCorrect === true).length;
                return (
                    <div className="max-w-4xl animate-fade-in mx-auto text-center py-10">
                        <div className="bg-white rounded-3xl border border-gray-200 shadow-sm p-10">
                            <div className="w-20 h-20 bg-purple-100 text-purple-600 rounded-full flex items-center justify-center mx-auto mb-6">
                                <QuizIcon className="w-10 h-10" />
                            </div>
                            <h2 className="text-3xl font-black text-gray-900 mb-2">í€´ì¦ˆ ì™„ë£Œ!</h2>
                            <p className="text-gray-500 mb-8">
                                ì´ {QUIZ_LIST.length}ë¬¸ì œ ì¤‘ {correctCount}ë¬¸ì œë¥¼ í•œ ë²ˆì— ë§í˜”ìŠµë‹ˆë‹¤.
                            </p>
                            <div className="text-5xl font-black text-purple-600 mb-10">
                                {Math.round((correctCount / QUIZ_LIST.length) * 100)}%
                            </div>
                            <button 
                                onClick={handleRetry}
                                className="px-8 py-3 rounded-xl bg-purple-600 text-white font-bold hover:bg-purple-700 transition-colors"
                            >
                                ë‹¤ì‹œ í’€ê¸° (Try Again)
                            </button>
                        </div>
                    </div>
                );
            }

            return (
                <div className="max-w-4xl animate-fade-in mx-auto">
                    <div className="flex items-center gap-4 mb-6">
                        <div className="w-16 h-16 bg-purple-100 rounded-2xl flex items-center justify-center shrink-0">
                            <QuizHeaderIcon className="w-10 h-10" />
                        </div>
                        <div className="flex flex-col">
                            <h2 className="text-3xl font-black text-gray-900 font-jua">ë‚´ìš© í™•ì¸ í€´ì¦ˆ</h2>
                            <span className="text-base text-gray-500 font-medium">Comprehension Quiz ({currentQuestionIndex + 1}/{QUIZ_LIST.length})</span>
                        </div>
                    </div>

                    <div className="mb-6 p-4 bg-gray-50 rounded-xl border border-gray-200">
                        <p className="font-bold text-gray-800">ë‹¤ìŒ ë¹ˆì¹¸ì— ì•Œë§ì€ ë§ì„ ê³ ë¥´ì„¸ìš”.</p>
                        <p className="text-gray-500 text-sm">Choose the correct word for the blank.</p>
                    </div>

                    <div className="bg-white rounded-2xl border border-gray-200 shadow-sm p-2">
                        <div className="flex items-start gap-3 p-4">
                            <span className="bg-purple-100 text-purple-700 font-black rounded-lg px-2 py-1 text-sm shrink-0">Q{currentQuestion.id}</span>
                            <div className="flex flex-col">
                                <h3 className="font-bold text-gray-900 text-lg leading-snug">{currentQuestion.questionKor}</h3>
                                <p className="text-gray-500 font-medium text-sm mt-1">{currentQuestion.questionEng}</p>
                            </div>
                        </div>

                        <div className="bg-gray-50 rounded-xl p-4 mb-4 mx-1">
                            <div>
                                <div className="flex items-center flex-wrap gap-2 leading-relaxed">
                                    <span className="text-xl font-bold text-gray-900">{currentQuestion.sentence_pre}</span>
                                    
                                    <div className={`px-4 py-1 rounded-md font-bold text-xl transition-all duration-300 min-w-[80px] text-center border-b-2 
                                        ${selectedOption 
                                            ? (isCorrect 
                                                ? 'bg-[#dcfce7] text-green-700 border-green-500' 
                                                : 'bg-[#fee2e2] text-red-700 border-red-500')
                                            : (showHint ? 'bg-[#fef08a] text-yellow-800 border-yellow-400' : 'bg-[#fef08a] text-transparent border-yellow-400 select-none')
                                        }`}
                                    >
                                        {selectedOption 
                                            ? selectedOption.text 
                                            : (showHint ? `[ ${currentQuestion.hint} ]` : "___")
                                        }
                                    </div>
                                    
                                    <span className="text-xl font-bold text-gray-900">
                                        {currentQuestion.sentence_post}
                                        {selectedOption && (
                                            <span className={`ml-2 text-lg ${isCorrect ? 'text-green-600' : 'text-red-600'}`}>
                                                {isCorrect ? 'âœ“' : 'âœ—'}
                                            </span>
                                        )}
                                    </span>
                                </div>

                                {showTranslation && (
                                    <div className="mt-4 pt-4 border-t border-gray-200 text-gray-500 italic text-sm animate-fade-in font-medium">
                                        {currentQuestion.translation}
                                    </div>
                                )}
                            </div>
                        </div>

                        <div className="flex gap-2 mb-4 px-2">
                            <button 
                                onClick={() => { setShowHint(!showHint); }}
                                disabled={selectedOption?.isCorrect}
                                className={`px-3 py-1.5 rounded-lg text-xs font-bold transition-colors ${selectedOption?.isCorrect ? 'opacity-50 cursor-not-allowed bg-gray-100 text-gray-400' : (showHint ? 'bg-yellow-200 text-yellow-800 ring-2 ring-yellow-400' : 'bg-[#fef08a] text-yellow-800 hover:bg-yellow-200')}`}
                            >
                                íŒíŠ¸ (Hint)
                            </button>
                            <button 
                                onClick={() => setShowTranslation(!showTranslation)}
                                className={`px-3 py-1.5 rounded-lg text-xs font-bold transition-colors ${showTranslation ? 'bg-gray-300 text-gray-800 ring-2 ring-gray-400' : 'bg-gray-200 text-gray-600 hover:bg-gray-300'}`}
                            >
                                ë²ˆì—­ (Translation)
                            </button>
                        </div>

                        <div className="grid grid-cols-2 md:grid-cols-4 gap-3 mb-4 px-2">
                            {shuffledOptions.map((option, idx) => {
                                const isSelected = selectedOption === option;
                                let btnClass = "bg-white border-gray-200 text-gray-700 hover:bg-gray-50 hover:border-gray-300";
                                
                                if (isSelected) {
                                    if (option.isCorrect) {
                                        btnClass = "bg-green-500 border-green-600 text-white shadow-md ring-2 ring-green-200";
                                    } else {
                                        btnClass = "bg-red-500 border-red-600 text-white shadow-md ring-2 ring-red-200";
                                    }
                                } else if (selectedOption?.isCorrect) {
                                    // ì •ë‹µì„ ë§ì·„ì„ ë•Œë§Œ ë‚˜ë¨¸ì§€ ë²„íŠ¼ ë¹„í™œì„±í™” ìŠ¤íƒ€ì¼ ì ìš©
                                    btnClass = "bg-gray-50 border-gray-200 text-gray-400 cursor-not-allowed";
                                }

                                return (
                                    <button
                                        key={idx}
                                        onClick={() => handleOptionClick(option)}
                                        disabled={selectedOption?.isCorrect}
                                        className={`py-3 px-4 rounded-xl border font-bold text-base transition-all duration-200 ${btnClass}`}
                                    >
                                        {option.text}
                                    </button>
                                );
                            })}
                        </div>

                        {selectedOption && (
                            <div className="p-4 rounded-xl border-l-4 mb-4 mx-2 animate-fade-in transition-all bg-[#f8fafc] border-gray-300">
                                <div className={`${isCorrect ? 'bg-[#f0fdf4] border-green-500' : 'bg-[#fef2f2] border-red-500'} p-4 rounded-lg border-l-4`}>
                                    <h4 className={`font-bold text-sm mb-1 ${isCorrect ? 'text-green-800' : 'text-red-800'}`}>
                                        {isCorrect ? 'Correct!' : 'Try again.'}
                                    </h4>
                                    <p className={`text-sm italic ${isCorrect ? 'text-green-700' : 'text-red-700'}`}>
                                        {selectedOption.feedback}
                                    </p>
                                </div>
                            </div>
                        )}

                        <div className="flex justify-between items-center mt-4 border-t border-gray-100 pt-4 px-2 pb-2">
                            <button
                                onClick={handlePrev}
                                disabled={currentQuestionIndex === 0}
                                className={`px-6 py-1 rounded-xl font-bold flex items-center gap-2 transition-colors ${
                                    currentQuestionIndex === 0 
                                    ? 'text-gray-300 cursor-not-allowed' 
                                    : 'text-gray-600 hover:bg-gray-100'
                                }`}
                            >
                                <span className="text-lg">â†</span>
                                <span className="text-xs">ì´ì „ ë¬¸ì œ (Prev)</span>
                            </button>

                            <button 
                                onClick={handleNext}
                                disabled={!isCorrect} 
                                className={`px-6 py-1 rounded-xl font-bold flex items-center gap-2 shadow-md transition-colors ${
                                    !isCorrect
                                    ? 'bg-gray-300 text-gray-500 cursor-not-allowed'
                                    : 'bg-gray-900 text-white hover:bg-black'
                                }`}
                            >
                                <span className="text-xs">{currentQuestionIndex < QUIZ_LIST.length - 1 ? 'ë‹¤ìŒ ë¬¸ì œ (Next)' : 'ê²°ê³¼ ë³´ê¸° (Finish)'}</span>
                                <span className="text-lg">â†’</span>
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        const callGeminiWithBackoff = async (payload) => {
            const apiKey = ""; // Runtime provided
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
            const delays = [1000, 2000, 4000, 8000, 16000];
            
            for (let i = 0; i <= delays.length; i++) {
                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });
                    if (!response.ok) {
                        if (response.status === 429 || response.status >= 500) {
                            throw new Error(`Server error: ${response.status}`);
                        }
                        throw new Error(`API error: ${response.statusText}`);
                    }
                    return await response.json();
                } catch (error) {
                    if (i === delays.length) throw error;
                    await new Promise(resolve => setTimeout(resolve, delays[i]));
                }
            }
        };

        const FeedbackSection = ({ value, onChange, placeholder, question, keyPhrases }) => {
            const [feedback, setFeedback] = useState(null);
            const [isLoading, setIsLoading] = useState(false);
            const [error, setError] = useState(null);

            const checkSentence = async () => {
                if (!value || value.trim() === '') {
                    setError("ë¬¸ì¥ì„ ì…ë ¥í•´ì•¼ í”¼ë“œë°±ì„ ë°›ì„ ìˆ˜ ìˆì–´ìš”.");
                    setFeedback(null);
                    return;
                }
                setIsLoading(true);
                setError(null);
                setFeedback(null);

                const systemPrompt = `You are an advanced Korean language tutor AI for A2 level learners. Analyze the user's sentence in response to a specific question.
The user's answer is in Korean.
Your goal is to provide feedback in ENGLISH to help the learner understand.

Instructions:
1. "feedback_message_eng": Write the feedback status or brief comment in English.
2. "explanation_eng": Explain the grammar or vocabulary mistake in English. You can quote Korean words but the explanation must be in English.
3. "corrected_sentence": Provide the natural and correct Korean sentence.
4. "relevance_feedback_eng": If the answer is irrelevant, explain why in English.

Question: "${question}"
User's Answer: "${value}"

Your response MUST be a JSON object with the specified schema.`;
                const payload = {
                    contents: [{ role: "user", parts: [{ text: systemPrompt }, { text: `Please provide feedback on my answer.\n\nQuestion: "${question}"\nUser's Answer: "${value}"` }] }],
                    generationConfig: {
                        responseMimeType: "application/json",
                        responseSchema: { type: "OBJECT", properties: { "is_relevant": { "type": "BOOLEAN" }, "relevance_feedback_eng": { "type": "STRING", "nullable": true }, "is_correct": { "type": "BOOLEAN", "nullable": true }, "feedback_message_eng": { "type": "STRING", "nullable": true }, "corrected_sentence": { "type": "STRING", "nullable": true }, "explanation_eng": { "type": "STRING", "nullable": true }, "alternative_expressions": { "type": "ARRAY", "items": { "type": "OBJECT", "properties": { "expression_kor": { "type": "STRING" }, "expression_eng": { "type": "STRING" } }, "required": ["expression_kor", "expression_eng"] } } }, "required": ["is_relevant"] }
                    }
                };

                try {
                    const result = await callGeminiWithBackoff(payload);
                    if (result.candidates?.[0]?.content?.parts?.[0]?.text) {
                        const parsedJson = JSON.parse(result.candidates[0].content.parts[0].text);
                        setFeedback(parsedJson);
                    } else {
                        setError("AIì˜ ì‘ë‹µì„ ì²˜ë¦¬í•˜ëŠ” ë° ë¬¸ì œê°€ ë°œìƒí–ˆì–´ìš”.");
                    }
                } catch (err) {
                    console.error("Error checking sentence:", err);
                    setError("ë¬¸ì¥ ê²€ì‚¬ì— ì‹¤íŒ¨í–ˆì–´ìš”. ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.");
                } finally {
                    setIsLoading(false);
                }
            };

            return (
                <div>
                    {keyPhrases}
                    <div>
                        <h4 className="font-bold text-gray-900 mb-3 text-base">í•µì‹¬ í‘œí˜„ì„ ì‚¬ìš©í•´ì„œ ì§ˆë¬¸ì— ëŒ€ë‹µí•´ ë³´ì„¸ìš”.</h4>
                        <textarea 
                            value={value} 
                            onChange={onChange} 
                            placeholder={placeholder}
                            className="w-full p-4 rounded-xl border border-gray-200 focus:border-green-500 focus:ring-1 focus:ring-green-500 outline-none min-h-[120px] resize-none text-base text-gray-800 placeholder-gray-400 mb-3"
                        ></textarea>
                        
                        <button
                            onClick={checkSentence}
                            disabled={!value.trim() || isLoading}
                            className={`flex items-center gap-2 px-5 py-[6px] text-[12px] leading-[12px] rounded-xl font-bold transition-all shadow-sm ${
                                !value.trim() || isLoading
                                ? 'bg-gray-100 text-gray-400 cursor-not-allowed'
                                : 'bg-indigo-600 text-white hover:bg-indigo-700 hover:shadow-md'
                            }`}
                        >
                            {isLoading ? (
                                <>
                                    <div className="w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"></div>
                                    <span>ë¶„ì„ ì¤‘... (Analyzing)</span>
                                </>
                            ) : (
                                <>
                                    <SparklesIcon className="w-5 h-5" />
                                    <span>AI Feedback (í”¼ë“œë°± ë°›ê¸°)</span>
                                </>
                            )}
                        </button>

                        {error && (
                            <div className="mt-4 p-4 bg-red-50 text-red-600 rounded-xl border border-red-200 text-sm font-medium animate-fade-in">
                                {error}
                            </div>
                        )}

                        {feedback && (
                            <div className={`mt-6 rounded-2xl p-6 border animate-fade-in ${feedback.is_correct ? 'bg-green-50 border-green-200' : 'bg-yellow-50 border-yellow-200'}`}>
                                <div className="flex items-center gap-2 mb-4">
                                    <span className="text-2xl">ğŸ¤–</span>
                                    <h4 className="font-extrabold text-gray-900 text-lg">AI Tutor Feedback</h4>
                                </div>
                                
                                <div className="mb-4">
                                    <span className={`font-black text-sm px-3 py-1 rounded-full bg-white border shadow-sm ${feedback.is_correct ? 'text-green-600 border-green-200' : 'text-yellow-600 border-yellow-200'}`}>
                                        {feedback.is_correct ? 'ğŸ‰ Great Job!' : 'âš ï¸ Needs Improvement'}
                                    </span>
                                </div>

                                <div className="space-y-4">
                                    {feedback.feedback_message_eng && (
                                        <div className="flex flex-col sm:flex-row gap-1 sm:gap-4">
                                            <span className="font-bold text-gray-500 text-sm sm:w-24 shrink-0">Feedback</span>
                                            <p className="text-gray-800 text-sm font-medium leading-relaxed">{feedback.feedback_message_eng}</p>
                                        </div>
                                    )}
                                    {feedback.explanation_eng && (
                                        <div className="flex flex-col sm:flex-row gap-1 sm:gap-4">
                                            <span className="font-bold text-gray-500 text-sm sm:w-24 shrink-0">Explanation</span>
                                            <p className="text-gray-800 text-sm font-medium leading-relaxed">{feedback.explanation_eng}</p>
                                        </div>
                                    )}
                                    {feedback.corrected_sentence && (
                                        <div className="flex flex-col sm:flex-row gap-1 sm:gap-4">
                                            <span className="font-bold text-gray-500 text-sm sm:w-24 shrink-0">Correction</span>
                                            <p className="text-gray-900 text-lg font-black leading-relaxed">{feedback.corrected_sentence}</p>
                                        </div>
                                    )}
                                    {!feedback.is_relevant && (
                                        <div className="flex flex-col sm:flex-row gap-1 sm:gap-4">
                                            <span className="font-bold text-gray-500 text-sm sm:w-24 shrink-0">Relevance</span>
                                            <p className="text-gray-800 text-sm font-medium leading-relaxed">{feedback.relevance_feedback_eng || "This answer doesn't seem relevant to the question."}</p>
                                        </div>
                                    )}
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        const DiscussCard = ({ item }) => {
            const [answer, setAnswer] = useState('');
            const [showTrans, setShowTrans] = useState(false);

            const keyPhrasesNode = (
                <div className="mb-10 space-y-4">
                    <div className="flex items-center gap-2">
                        <span className="text-red-500 text-lg">ğŸ“</span>
                        <h4 className="font-bold text-gray-900 text-lg">í•µì‹¬ í‘œí˜„ (Essential phrases)</h4>
                    </div>
                    <div className="space-y-4 pl-1">
                        {item.vocab.map((v, idx) => (
                            <div key={idx} className="pl-4 border-l-4 border-green-500">
                                <p className="text-gray-700">
                                    <span className="text-green-600 font-bold text-lg mr-2">{v.term}:</span>
                                    <span>{v.meaning}</span>
                                </p>
                                {v.context && <p className="text-sm text-gray-500 mt-1 italic">"{v.context}"</p>}
                                {v.context_eng && <p className="text-xs text-gray-400">({v.context_eng})</p>}
                            </div>
                        ))}
                    </div>
                </div>
            );

            return (
                <div className="mb-12 border-b border-gray-100 pb-12 last:border-0 last:pb-0">
                    <div className="mb-8">
                        <h3 className="text-xl font-bold text-gray-900 mb-2">{item.num}. {item.kor}</h3>
                        {showTrans && (
                            <p className="text-gray-500 text-sm mb-3 animate-fade-in font-medium">
                                {item.eng}
                            </p>
                        )}
                        <button 
                            onClick={() => setShowTrans(!showTrans)}
                            className={`px-3 py-1.5 rounded-lg text-xs font-bold transition-colors inline-flex items-center gap-1 ${showTrans ? 'bg-gray-200 text-gray-700' : 'bg-gray-100 text-gray-600 hover:bg-gray-200'}`}
                        >
                            <TranslateIcon className="w-3 h-3" />
                            <span>{showTrans ? 'ë²ˆì—­ ìˆ¨ê¸°ê¸° (Hide)' : 'ë²ˆì—­ (Translation)'}</span>
                        </button>
                    </div>

                    <FeedbackSection 
                        question={item.kor}
                        value={answer}
                        onChange={(e) => setAnswer(e.target.value)}
                        placeholder="ì—¬ê¸°ì— ë‹µë³€ì„ ì…ë ¥í•˜ì„¸ìš” (Type your response here)"
                        keyPhrases={keyPhrasesNode}
                    />
                </div>
            );
        };

        const DiscussView = ({ updateProgress }) => {
            return (
                <div className="max-w-4xl mx-auto animate-fade-in">
                    <div className="flex items-center gap-4 mb-8">
                        <div className="w-16 h-16 bg-[#EFF6FF] rounded-2xl flex items-center justify-center shrink-0">
                            <DiscussHeaderIcon className="w-10 h-10" />
                        </div>
                        <div className="flex flex-col">
                            <h2 className="text-3xl font-black text-gray-900 font-jua">ìƒê°í•´ ë³´ê¸°</h2>
                            <span className="text-base text-gray-500 font-medium">Food For Thought</span>
                        </div>
                    </div>
                    
                    <div className="bg-white rounded-3xl border border-gray-200 shadow-sm p-8 md:p-10">
                        {DISCUSS_DATA.map(item => <DiscussCard key={item.num} item={item} />)}
                    </div>
                </div>
            );
        };

        const App = () => {
            const [activeTab, setActiveTab] = useState('home');
            const [isSidebarCollapsed, setIsSidebarCollapsed] = useState(false);
            const [userLevel, setUserLevel] = useState("A2+"); // Default level fixed to A2+ (Upper Beginner)
            
            const [progress, setProgress] = useState({
                learn: false,
                vocab: false,
                quiz: 0,
                discuss: false
            });

            const updateProgress = (key, value = true) => {
                setProgress(prev => {
                    if (prev[key] === value) return prev;
                    return { ...prev, [key]: value };
                });
            };

            useEffect(() => {
                const handleResize = () => {
                    if (window.innerWidth < 1024) {
                        setIsSidebarCollapsed(true);
                    } else {
                        setIsSidebarCollapsed(false);
                    }
                };
                window.addEventListener('resize', handleResize);
                handleResize(); 
                return () => window.removeEventListener('resize', handleResize);
            }, []);

            const toggleSidebar = () => {
                setIsSidebarCollapsed(!isSidebarCollapsed);
            };

            const renderContent = () => {
                switch(activeTab) {
                    case 'home': return <HomeView setActiveTab={setActiveTab} progress={progress} userLevel={userLevel} />;
                    case 'learn': return <LearnView updateProgress={updateProgress} />;
                    case 'vocab': return <VocabView updateProgress={updateProgress} />;
                    case 'quiz': return <QuizView updateProgress={updateProgress} />;
                    case 'discuss': return <DiscussView updateProgress={updateProgress} />;
                    default: return <HomeView setActiveTab={setActiveTab} progress={progress} userLevel={userLevel} />;
                }
            };

            return (
                <div className="flex min-h-screen bg-[#f9fafb]">
                    <Sidebar 
                        activeTab={activeTab} 
                        setActiveTab={setActiveTab} 
                        isCollapsed={isSidebarCollapsed} 
                        toggleSidebar={toggleSidebar}
                        userLevel={userLevel}
                        // setUserLevel removed as level is fixed for this content
                    />
                    <div className={`flex-1 flex flex-col transition-all duration-300 ease-in-out ${isSidebarCollapsed ? 'md:ml-[88px]' : 'md:ml-64'}`}>
                        <header className={`h-16 bg-white sticky top-0 z-40 transition-all duration-300 ${isSidebarCollapsed ? 'md:left-[88px]' : 'md:left-64'}`}></header>
                        <main className="flex-1 p-4 overflow-hidden flex flex-col">{renderContent()}</main>
                    </div>
                    <nav className="md:hidden fixed bottom-0 w-full bg-white border-t border-gray-200 flex justify-around p-3 z-50">
                        {['home','learn','vocab','quiz','discuss'].map(t=><button key={t} onClick={()=>setActiveTab(t)} className={`p-2 rounded-lg ${activeTab===t?'text-green-600 bg-green-50':'text-gray-400'}`}>{t==='home'?<HomeIcon className="w-6 h-6"/>:t==='learn'?<LearnIcon className="w-6 h-6"/>:t==='vocab'?<VocabIcon className="w-6 h-6"/>:t==='quiz'?<QuizIcon className="w-6 h-6"/>:<DiscussIcon className="w-6 h-6"/>}</button>)}
                    </nav>
                </div>
            );
        };
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
